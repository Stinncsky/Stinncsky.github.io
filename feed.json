{
    "version": "https://jsonfeed.org/version/1",
    "title": "æ¼ æºŸç»½çµçš„å°ç«™",
    "subtitle": "è°çŸ¥é“é‡Œé¢æœ‰ä»€ä¹ˆ",
    "icon": "https://stinncsky.github.io/images/favicon.ico",
    "description": "å˜¿å˜¿å˜¿~~",
    "home_page_url": "https://stinncsky.github.io",
    "items": [
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2683-%E7%9B%B8%E9%82%BB%E5%80%BC%E7%9A%84%E6%8C%89%E4%BD%8D%E5%BC%82%E6%88%96/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2683-%E7%9B%B8%E9%82%BB%E5%80%BC%E7%9A%84%E6%8C%89%E4%BD%8D%E5%BC%82%E6%88%96/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š2683. ç›¸é‚»å€¼çš„æŒ‰ä½å¼‚æˆ–",
            "date_published": "2025-07-31T07:19:34.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9uZWlnaGJvcmluZy1iaXR3aXNlLXhvcj9lbnZUeXBlPWRhaWx5LXF1ZXN0aW9uJmFtcDtlbnZJZD0yMDI1LTA3LTMx\">LeetCode 2683</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ä¸‹æ ‡ä»  <code>0</code>  å¼€å§‹ã€é•¿åº¦ä¸º  <code>n</code>  çš„æ•°ç»„  <code>derived</code>  æ˜¯ç”±åŒæ ·é•¿åº¦ä¸º  <code>n</code>  çš„åŸå§‹ äºŒè¿›åˆ¶æ•°ç»„  <code>original</code>  é€šè¿‡è®¡ç®—ç›¸é‚»å€¼çš„ æŒ‰ä½å¼‚æˆ–ï¼ˆâŠ•ï¼‰æ´¾ç”Ÿè€Œæ¥ã€‚</p>\n<p>ç‰¹åˆ«åœ°ï¼Œå¯¹äºèŒƒå›´  <code>[0, n - 1]</code>  å†…çš„æ¯ä¸ªä¸‹æ ‡  <code>i</code>  ï¼š</p>\n<ul>\n<li>å¦‚æœ  <code>i = n - 1</code>  ï¼Œé‚£ä¹ˆ  <code>derived[i] = original[i] âŠ• original[0]</code></li>\n<li>å¦åˆ™  <code>derived[i] = original[i] âŠ• original[i + 1]</code></li>\n</ul>\n<p>ç»™ä½ ä¸€ä¸ªæ•°ç»„  <code>derived</code>  ï¼Œè¯·åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªèƒ½å¤Ÿæ´¾ç”Ÿå¾—åˆ°  <code>derived</code>  çš„ æœ‰æ•ˆåŸå§‹äºŒè¿›åˆ¶æ•°ç»„  <code>original</code>  ã€‚</p>\n<p>å¦‚æœå­˜åœ¨æ»¡è¶³è¦æ±‚çš„åŸå§‹äºŒè¿›åˆ¶æ•°ç»„ï¼Œè¿”å›  <code>true</code>  ï¼›å¦åˆ™ï¼Œè¿”å›  <code>false</code>  ã€‚</p>\n<ul>\n<li>äºŒè¿›åˆ¶æ•°ç»„æ˜¯ä»…ç”± 0 å’Œ 1 ç»„æˆçš„æ•°ç»„ã€‚</li>\n</ul>\n<div class=\"note info no-icon\">\n<ul>\n<li>n == derived.length</li>\n<li>1 &lt;= n &lt;= 10^5</li>\n<li>derived ä¸­çš„å€¼ä¸æ˜¯ 0 å°±æ˜¯ 1 ã€‚</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<p>ç”±é¢˜æ„å¯çŸ¥ï¼Œ <code>derived</code>  æ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ç”±  <code>original</code>  æ•°ç»„çš„ç›¸é‚»å…ƒç´ é€šè¿‡æŒ‰ä½å¼‚æˆ–å¾—åˆ°çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹  <code>derived</code>  æ•°ç»„è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œæ¥æ¨å¯¼å‡º  <code>original</code>  æ•°ç»„çš„å¯èƒ½æ€§ã€‚</p>\n<p>ç”±  <code>derived[i] = original[i] âŠ• original[i + 1]</code>  å¯å¾—ï¼š</p>\n<ul>\n<li><code>original[i] = derived[i] âŠ• original[i + 1]</code></li>\n<li><code>original[i + 1] = derived[i + 1] âŠ• original[i + 2]</code></li>\n<li><code>original[n - 1] = derived[n - 1] âŠ• original[0]</code></li>\n<li><code>original[0] = derived[0] âŠ• original[1]</code> <br />\n å› æ­¤ï¼Œ <code>original[i] = derived[i] âŠ• derived[i + 1] âŠ• ... âŠ• derived[n - 1] âŠ• derived[0] âŠ• ... âŠ• derived[i - 1] âŠ• original[i]</code> <br />\n ä¹Ÿå°±æ˜¯ï¼Œ <code>0 = derived[0] âŠ• derived[1] âŠ• ... âŠ• derived[n - 1]</code> ã€‚<br />\nå› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ¤æ–­  <code>derived</code>  æ•°ç»„çš„æ‰€æœ‰å…ƒç´ çš„å¼‚æˆ–ç»“æœæ˜¯å¦ä¸º 0 å³å¯ã€‚<br />\nä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå˜é‡  <code>num</code>  æ¥è®°å½•å¼‚æˆ–ç»“æœï¼Œéå†  <code>derived</code>  æ•°ç»„ï¼Œé€ä¸ªå°†å…ƒç´ ä¸  <code>num</code>  è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œæœ€ååˆ¤æ–­  <code>num</code>  æ˜¯å¦ä¸º 0ã€‚</li>\n</ul>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">doesValidArrayExist</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; derived)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> num = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;x:derived)&#123;</span><br><span class=\"line\">            num ^= x;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> num == <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "æ•°ç»„",
                "ä½è¿ç®—",
                "å¼‚æˆ–"
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2419-%E6%8C%89%E4%BD%8D%E4%B8%8E%E6%9C%80%E5%A4%A7%E7%9A%84%E6%9C%80%E9%95%BF%E5%AD%90%E6%95%B0%E7%BB%84/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2419-%E6%8C%89%E4%BD%8D%E4%B8%8E%E6%9C%80%E5%A4%A7%E7%9A%84%E6%9C%80%E9%95%BF%E5%AD%90%E6%95%B0%E7%BB%84/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š2419. æŒ‰ä½ä¸æœ€å¤§çš„æœ€é•¿å­æ•°ç»„",
            "date_published": "2025-07-30T02:20:06.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9sb25nZXN0LXN1YmFycmF5LXdpdGgtbWF4aW11bS1iaXR3aXNlLWFuZD9lbnZUeXBlPWRhaWx5LXF1ZXN0aW9uJmFtcDtlbnZJZD0yMDI1LTA3LTI5\">LeetCode 2419</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º  <code>n</code>  çš„æ•´æ•°æ•°ç»„  <code>nums</code>  ã€‚</p>\n<p>è€ƒè™‘  <code>nums</code>  ä¸­è¿›è¡Œ æŒ‰ä½ä¸ï¼ˆbitwise ANDï¼‰è¿ç®—å¾—åˆ°çš„å€¼ æœ€å¤§ çš„ éç©º å­æ•°ç»„ã€‚</p>\n<pre><code>æ¢å¥è¯è¯´ï¼Œä»¤ `k` æ˜¯ `nums` ä»»æ„ å­æ•°ç»„æ‰§è¡ŒæŒ‰ä½ä¸è¿ç®—æ‰€èƒ½å¾—åˆ°çš„æœ€å¤§å€¼ã€‚é‚£ä¹ˆï¼Œåªéœ€è¦è€ƒè™‘é‚£äº›æ‰§è¡Œä¸€æ¬¡æŒ‰ä½ä¸è¿ç®—åç­‰äº `k` çš„å­æ•°ç»„ã€‚\n</code></pre>\n<p>è¿”å›æ»¡è¶³è¦æ±‚çš„ æœ€é•¿ å­æ•°ç»„çš„é•¿åº¦ã€‚</p>\n<p>æ•°ç»„çš„æŒ‰ä½ä¸å°±æ˜¯å¯¹æ•°ç»„ä¸­çš„æ‰€æœ‰æ•°å­—è¿›è¡ŒæŒ‰ä½ä¸è¿ç®—ã€‚</p>\n<p>å­æ•°ç»„ æ˜¯æ•°ç»„ä¸­çš„ä¸€ä¸ªè¿ç»­å…ƒç´ åºåˆ—ã€‚</p>\n<div class=\"note info no-icon\">\n<ul>\n<li>1 &lt;= nums.length &lt;= 10^5</li>\n<li>1 &lt;= nums[i] &lt;= 10^6</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<p>ç”±äºæ˜¯æŒ‰ä½ä¸è¿ç®—ï¼Œæ‰€ä»¥ä¸€ä¸ªæ•°å­—ç»è¿‡è¿ç®—åªä¼šå˜å°æˆ–ä¿æŒä¸å˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°æ‰€æœ‰ä¸æœ€å¤§å€¼ç›¸ç­‰çš„å­æ•°ç»„ï¼Œå¹¶è¿”å›å…¶ä¸­çš„æœ€é•¿å­æ•°ç»„çš„é•¿åº¦ã€‚<br />\né‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬éœ€è¦æ‰¾åˆ°æ•°ç»„ä¸­çš„æœ€å¤§å€¼ï¼Œç„¶åéå†æ•°ç»„ï¼Œè®°å½•æ¯æ¬¡é‡åˆ°æœ€å¤§å€¼æ—¶çš„è¿ç»­é•¿åº¦ï¼Œæ›´æ–°æœ€é•¿é•¿åº¦ã€‚</p>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">longestSubarray</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> mx = ranges::<span class=\"built_in\">max</span>(nums);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"number\">1</span>, cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> x:nums)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x == mx)&#123;</span><br><span class=\"line\">                cnt++;</span><br><span class=\"line\">                ans = <span class=\"built_in\">max</span>(ans, cnt);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "æŒ‰ä½ä¸",
                "å­æ•°ç»„"
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2411-%E6%8C%89%E4%BD%8D%E6%88%96%E6%9C%80%E5%A4%A7%E7%9A%84%E6%9C%80%E5%B0%8F%E5%AD%90%E6%95%B0%E7%BB%84%E9%95%BF%E5%BA%A6/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2411-%E6%8C%89%E4%BD%8D%E6%88%96%E6%9C%80%E5%A4%A7%E7%9A%84%E6%9C%80%E5%B0%8F%E5%AD%90%E6%95%B0%E7%BB%84%E9%95%BF%E5%BA%A6/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š2411. æŒ‰ä½æˆ–æœ€å¤§çš„æœ€å°å­æ•°ç»„é•¿åº¦",
            "date_published": "2025-07-29T15:49:32.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9zbWFsbGVzdC1zdWJhcnJheXMtd2l0aC1tYXhpbXVtLWJpdHdpc2Utb3I/ZW52VHlwZT1kYWlseS1xdWVzdGlvbiZhbXA7ZW52SWQ9MjAyNS0wNy0yOQ==\">LeetCode 2411</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º  <code>n</code>  ä¸‹æ ‡ä»  <code>0</code>  å¼€å§‹çš„æ•°ç»„  <code>nums</code>  ï¼Œæ•°ç»„ä¸­æ‰€æœ‰æ•°å­—å‡ä¸ºéè´Ÿæ•´æ•°ã€‚å¯¹äº  <code>0</code>  åˆ°  <code>n - 1</code>  ä¹‹é—´çš„æ¯ä¸€ä¸ªä¸‹æ ‡  <code>i</code>  ï¼Œä½ éœ€è¦æ‰¾å‡º  <code>nums</code>  ä¸­ä¸€ä¸ª æœ€å° éç©ºå­æ•°ç»„ï¼Œå®ƒçš„èµ·å§‹ä½ç½®ä¸º  <code>i</code>  ï¼ˆåŒ…å«è¿™ä¸ªä½ç½®ï¼‰ï¼ŒåŒæ—¶æœ‰ æœ€å¤§ çš„ æŒ‰ä½æˆ–è¿ç®—å€¼ ã€‚</p>\n<pre><code>æ¢è¨€ä¹‹ï¼Œä»¤ `B[i][j]` è¡¨ç¤ºå­æ•°ç»„ `nums[i...j]` çš„æŒ‰ä½æˆ–è¿ç®—çš„ç»“æœï¼Œä½ éœ€è¦æ‰¾åˆ°ä¸€ä¸ªèµ·å§‹ä½ç½®ä¸º `i` çš„æœ€å°å­æ•°ç»„ï¼Œè¿™ä¸ªå­æ•°ç»„çš„æŒ‰ä½æˆ–è¿ç®—çš„ç»“æœç­‰äº `max([i][k])` ï¼Œå…¶ä¸­ `i &lt;= k &lt;= n - 1` ã€‚\n</code></pre>\n<p>ä¸€ä¸ªæ•°ç»„çš„æŒ‰ä½æˆ–è¿ç®—å€¼æ˜¯è¿™ä¸ªæ•°ç»„é‡Œæ‰€æœ‰æ•°å­—æŒ‰ä½æˆ–è¿ç®—çš„ç»“æœã€‚</p>\n<p>è¯·ä½ è¿”å›ä¸€ä¸ªå¤§å°ä¸º  <code>n</code>  çš„æ•´æ•°æ•°ç»„  <code>answer</code> ï¼Œå…¶ä¸­  <code>answer[i]</code>  æ˜¯å¼€å§‹ä½ç½®ä¸º  <code>i</code> ï¼ŒæŒ‰ä½æˆ–è¿ç®—ç»“æœæœ€å¤§ï¼Œä¸”æœ€çŸ­å­æ•°ç»„çš„é•¿åº¦ã€‚</p>\n<p>å­æ•°ç»„æ˜¯æ•°ç»„é‡Œä¸€æ®µè¿ç»­éç©ºå…ƒç´ ç»„æˆçš„åºåˆ—ã€‚</p>\n<div class=\"note info no-icon\">\n<ul>\n<li>n == nums.length</li>\n<li>1 &lt;= n &lt;= 10^5</li>\n<li>0 &lt;= nums[i] &lt;= 10^9</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<p>æ€è·¯ 1ï¼šä½¿ç”¨å‰ç¼€å’Œ + äºŒåˆ†æŸ¥æ‰¾<br />\nå¯¹äºæŒ‰ä½æˆ–è¿ç®—ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨å‰ç¼€å’Œæ¥è®¡ç®—åŒºé—´çš„æŒ‰ä½æˆ–å€¼ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨å…¶ä»–æ–¹æ³•æ¥ç»´æŠ¤æ¯ä¸ªä½ç½®çš„æŒ‰ä½æˆ–å€¼ã€‚æ¯”å¦‚å¯ä»¥é€šè¿‡è®¡ç®—æ¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½çš„å‡ºç°æ¬¡æ•°æ¥å®ç°ã€‚<br />\nå¯¹äºæ¯ä¸€ä¸ªä½ç½® iï¼Œæˆ‘ä»¬å¯ä»¥ç»´æŠ¤ä¸€ä¸ªé•¿åº¦ä¸º 30 çš„æ•°ç»„ cntï¼Œcnt [j] è¡¨ç¤ºåœ¨ nums [0...i] ä¸­ï¼ŒäºŒè¿›åˆ¶ä½ j å‡ºç°çš„æ¬¡æ•°ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ cnt æ•°ç»„å¿«é€Ÿè®¡ç®—å‡ºä»»æ„åŒºé—´çš„æŒ‰ä½æˆ–å€¼ã€‚<br />\nå¯¹äºæ¯ä¸€ä¸ªä½ç½® iï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„æœ€å°å­æ•°ç»„é•¿åº¦ï¼Œå¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥å®ç°ã€‚å…·ä½“åœ°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ [i, n-1] çš„èŒƒå›´å†…è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œæ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„æœ€å° jï¼Œä½¿å¾— nums [i...j] çš„æŒ‰ä½æˆ–å€¼ç­‰äº nums [i] | nums [i+1] | ... | nums<a href=\"%E6%8C%89%E4%BD%8D%E6%88%96%E8%BF%90%E7%AE%97%E5%8F%AA%E4%BC%9A%E8%AE%A9%E6%95%B0%E5%AD%97%E5%8F%98%E5%A4%A7%E6%88%96%E4%BF%9D%E6%8C%81%E4%B8%8D%E5%8F%98%EF%BC%8C%E5%9B%A0%E6%AD%A4%E8%83%BD%E9%80%89%E5%88%B0%E7%9A%84%E6%89%80%E6%9C%89%E6%95%B0%E5%AD%97%E7%9A%84%E6%8C%89%E4%BD%8D%E6%88%96%E5%80%BC%E4%B8%80%E5%AE%9A%E6%98%AF%E6%9C%80%E5%A4%A7%E5%80%BC\">n-1</a>ã€‚</p>\n<p>æ€è·¯ 2ï¼šLogTrick<br />\n ç”±äºæˆ‘ä»¬è¦è®¡ç®—çš„æ¯ä¸ªä½ç½® i å¼€å§‹çš„æœ€å°å­æ•°ç»„é•¿åº¦ï¼Œå› æ­¤æ¯ä¸€ä¸ª nums [i] åªèƒ½å¯¹å‰é¢ i-1 ä¸ªä½ç½®çš„å­æ•°ç»„äº§ç”Ÿå½±å“ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥éå† nums æ•°ç»„ï¼Œå¯¹äºæ¯ä¸€ä¸ªä½ç½® iï¼Œæˆ‘ä»¬å¯ä»¥ä» i-1 å¼€å§‹å‘å‰éå†ï¼Œåˆ°ä¸€ä¸ªä½ç½®å‘ç° nums [j] | nums [i] != nums [i]ï¼Œè¯´æ˜ nums [i] å¯ä»¥å½±å“åˆ° nums [j]ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥æ›´æ–° ans [j] çš„å€¼ï¼ŒåŒæ—¶æ›´æ–° nums [j] çš„å€¼ä¸ºå½“å‰çš„æœ€å¤§å€¼ã€‚ç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªä½ç½® jï¼Œä½¿å¾— nums [j] | nums [i] == nums [i]ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥åœæ­¢å‘å‰éå†äº†ï¼Œå› ä¸º nums [i] å¯¹å‰é¢æ‰€æœ‰ä½ç½®çš„å­æ•°ç»„éƒ½æ²¡æœ‰å½±å“äº†ã€‚</p>\n<h2 id=\"æ€è·¯3æ»‘åŠ¨çª—å£è¯¥æ–¹æ³•å¯ä»¥è®©æ—¶é—´å¤æ‚åº¦å˜ä¸º-on-è¯¦æƒ…è¯·çœ‹åŠ›æ‰£é¢˜è§£ä»-onlogu-åˆ°-onlogtrick-æ»‘åŠ¨çª—å£-æ ˆpythonjavaccgojsrust\"><a class=\"anchor\" href=\"#æ€è·¯3æ»‘åŠ¨çª—å£è¯¥æ–¹æ³•å¯ä»¥è®©æ—¶é—´å¤æ‚åº¦å˜ä¸º-on-è¯¦æƒ…è¯·çœ‹åŠ›æ‰£é¢˜è§£ä»-onlogu-åˆ°-onlogtrick-æ»‘åŠ¨çª—å£-æ ˆpythonjavaccgojsrust\">#</a> æ€è·¯ 3ï¼šæ»‘åŠ¨çª—å£<br />\nè¯¥æ–¹æ³•å¯ä»¥è®©æ—¶é—´å¤æ‚åº¦å˜ä¸º O (n)ã€‚è¯¦æƒ…è¯·çœ‹åŠ›æ‰£é¢˜è§£ï¼š<span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9zbWFsbGVzdC1zdWJhcnJheXMtd2l0aC1tYXhpbXVtLWJpdHdpc2Utb3Ivc29sdXRpb25zLzE4MzA5MTEvYnktZW5kbGVzc2NoZW5nLXphaTE=\">ä» O (nlogU) åˆ° O (n)ï¼šLogTrick / æ»‘åŠ¨çª—å£ + æ ˆï¼ˆPython/Java/C++/C/Go/JS/Rustï¼‰</span></h2>\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•1</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">smallestSubarrays</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> st = <span class=\"number\">0</span>, ed = nums.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>;</span><br><span class=\"line\">        vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">cnt</span>(ed<span class=\"number\">+2</span>, <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(<span class=\"number\">30</span>,<span class=\"number\">0</span>));</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> add = [&amp;](<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">30</span>; i++)&#123;</span><br><span class=\"line\">                cnt[x][i] += cnt[y][i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> get = [&amp;](<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">29</span>; i &gt;= <span class=\"number\">0</span>; i--)&#123;</span><br><span class=\"line\">                res &lt;&lt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (cnt[x][i] - cnt[y][i]) res += <span class=\"number\">1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= ed; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> j = <span class=\"number\">0</span>, tmp = nums[i];</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (tmp) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (tmp &amp; <span class=\"number\">1</span>) cnt[i<span class=\"number\">+1</span>][j]++;</span><br><span class=\"line\">                tmp &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">                j++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(i<span class=\"number\">+1</span>,i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ans</span><span class=\"params\">(ed<span class=\"number\">+1</span>,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= ed; i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> mx = <span class=\"built_in\">get</span>(ed<span class=\"number\">+1</span>, i), l = i,r = ed;</span><br><span class=\"line\">            ans[i] = ed;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (l &lt;= r)&#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> mid= (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"built_in\">get</span>(mid<span class=\"number\">+1</span>, i) &lt; mx)&#123;</span><br><span class=\"line\">                    l = mid + <span class=\"number\">1</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    r = mid - <span class=\"number\">1</span>;</span><br><span class=\"line\">                    ans[i] = mid;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            ans[i] = (ans[i] - i + <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•2</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">smallestSubarrays</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n = nums.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ans</span><span class=\"params\">(n,<span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> x = nums[i];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = i - <span class=\"number\">1</span>; j &gt;= <span class=\"number\">0</span>; j--)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((nums[i] | nums[j]) != nums[j]) &#123;</span><br><span class=\"line\">                    ans[j] = i-j<span class=\"number\">+1</span>;</span><br><span class=\"line\">                    nums[j] |= nums[i];</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "å‰ç¼€å’Œ",
                "åŒæŒ‡é’ˆ",
                "æ»‘åŠ¨çª—å£",
                "LogTrick",
                "äºŒåˆ†"
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2044-%E7%BB%9F%E8%AE%A1%E6%8C%89%E4%BD%8D%E6%88%96%E8%83%BD%E5%BE%97%E5%88%B0%E6%9C%80%E5%A4%A7%E5%80%BC%E7%9A%84%E5%AD%90%E9%9B%86%E6%95%B0%E7%9B%AE/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2044-%E7%BB%9F%E8%AE%A1%E6%8C%89%E4%BD%8D%E6%88%96%E8%83%BD%E5%BE%97%E5%88%B0%E6%9C%80%E5%A4%A7%E5%80%BC%E7%9A%84%E5%AD%90%E9%9B%86%E6%95%B0%E7%9B%AE/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š2044. ç»Ÿè®¡æŒ‰ä½æˆ–èƒ½å¾—åˆ°æœ€å¤§å€¼çš„å­é›†æ•°ç›®",
            "date_published": "2025-07-29T15:48:06.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9jb3VudC1udW1iZXItb2YtbWF4aW11bS1iaXR3aXNlLW9yLXN1YnNldHM/ZW52VHlwZT1kYWlseS1xdWVzdGlvbiZhbXA7ZW52SWQ9MjAyNS0wNy0yOQ==\">LeetCode 2044</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ï¼Œè¯·ä½ æ‰¾å‡º nums å­é›† æŒ‰ä½æˆ– å¯èƒ½å¾—åˆ°çš„ æœ€å¤§å€¼ ï¼Œå¹¶è¿”å›æŒ‰ä½æˆ–èƒ½å¾—åˆ°æœ€å¤§å€¼çš„ ä¸åŒéç©ºå­é›†çš„æ•°ç›® ã€‚</p>\n<p>å¦‚æœæ•°ç»„ a å¯ä»¥ç”±æ•°ç»„ b åˆ é™¤ä¸€äº›å…ƒç´ ï¼ˆæˆ–ä¸åˆ é™¤ï¼‰å¾—åˆ°ï¼Œåˆ™è®¤ä¸ºæ•°ç»„ a æ˜¯æ•°ç»„ b çš„ä¸€ä¸ª å­é›† ã€‚å¦‚æœé€‰ä¸­çš„å…ƒç´ ä¸‹æ ‡ä½ç½®ä¸ä¸€æ ·ï¼Œåˆ™è®¤ä¸ºä¸¤ä¸ªå­é›† ä¸åŒ ã€‚</p>\n<p>å¯¹æ•°ç»„ a æ‰§è¡Œ æŒ‰ä½æˆ– ï¼Œç»“æœç­‰äº a [0] OR a [1] OR ... OR a [a.length - 1]ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ã€‚</p>\n<div class=\"note info no-icon\">\n<ul>\n<li>1 &lt;= nums.length &lt;= 16</li>\n<li>1 &lt;= nums[i] &lt;= 10^5</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<p>å¯¹äºæŒ‰ä½æˆ–çš„æœ€å¤§å€¼ï¼Œå°†æ‰€æœ‰å…ƒç´ è¿›è¡ŒæŒ‰ä½æˆ–æ“ä½œå¾—åˆ°çš„ä¸€å®šæ˜¯æœ€å¤§å€¼ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ç»Ÿè®¡æœ‰å¤šå°‘ä¸ªå­é›†èƒ½å¤Ÿå¾—åˆ°è¿™ä¸ªæœ€å¤§å€¼ã€‚<br />\nç”±äºæœ€å¤šæœ‰ 16 ä¸ªå…ƒç´ ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æš´åŠ›æšä¸¾çš„æ–¹å¼æ¥ç»Ÿè®¡æ‰€æœ‰å­é›†çš„æŒ‰ä½æˆ–å€¼ã€‚<br />\næ¯ä¸€ä¸ªå…ƒç´ éƒ½æœ‰ä¸¤ç§é€‰æ‹©ï¼šé€‰æ‹©æˆ–è€…ä¸é€‰æ‹©ï¼Œå› æ­¤æ€»å…±æœ‰ 2^n ç§å­é›†ã€‚<br />\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨é€’å½’çš„æ–¹å¼æ¥æšä¸¾æ‰€æœ‰å­é›†ï¼Œå¹¶ç»Ÿè®¡æŒ‰ä½æˆ–å€¼ç­‰äºæœ€å¤§å€¼çš„å­é›†æ•°é‡ã€‚</p>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">countMaxOrSubsets</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> _:nums) sum |= _;</span><br><span class=\"line\">        <span class=\"type\">int</span> n = nums.<span class=\"built_in\">size</span>(), ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> dfs = [&amp;](<span class=\"keyword\">auto</span> &amp;&amp; self,<span class=\"type\">int</span> i, <span class=\"type\">int</span> val)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i == n) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (val == sum) ans++;</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"built_in\">self</span>(self,i<span class=\"number\">+1</span>,val);</span><br><span class=\"line\">            <span class=\"built_in\">self</span>(self,i<span class=\"number\">+1</span>,val|nums[i]);</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(dfs,<span class=\"number\">0</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "æšä¸¾",
                "æ•°ç»„",
                "ä½è¿ç®—"
            ]
        },
        {
            "id": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/cs231n%E7%9A%84assignment1%EF%BC%9A%E5%A4%9A%E5%B1%82%E5%85%A8%E8%BF%9E%E6%8E%A5%E7%BD%91%E7%BB%9C/",
            "url": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/cs231n%E7%9A%84assignment1%EF%BC%9A%E5%A4%9A%E5%B1%82%E5%85%A8%E8%BF%9E%E6%8E%A5%E7%BD%91%E7%BB%9C/",
            "title": "cs231nçš„assignment1ï¼šå¤šå±‚å…¨è¿æ¥ç½‘ç»œ",
            "date_published": "2025-07-27T11:48:32.000Z",
            "content_html": "<h1 id=\"å¤šå±‚å…¨è¿æ¥ç½‘ç»œåŸºç¡€\"><a class=\"anchor\" href=\"#å¤šå±‚å…¨è¿æ¥ç½‘ç»œåŸºç¡€\">#</a> å¤šå±‚å…¨è¿æ¥ç½‘ç»œåŸºç¡€</h1>\n<p>å…¨è¿æ¥ç½‘ç»œï¼ˆFully Connected Networkï¼‰æ˜¯æ·±åº¦å­¦ä¹ ä¸­æœ€åŸºç¡€çš„ç½‘ç»œç»“æ„ï¼Œæ¯ä¸€å±‚çš„æ‰€æœ‰ç¥ç»å…ƒéƒ½ä¸ä¸Šä¸€å±‚çš„æ‰€æœ‰ç¥ç»å…ƒç›¸è¿æ¥ã€‚åœ¨ CS231n çš„ Assignment1 ä¸­ï¼Œéœ€è¦å®ç°ä¸€ä¸ªæ”¯æŒä»»æ„å±‚æ•°çš„å…¨è¿æ¥ç½‘ç»œç±»ï¼ŒåŒ…å«å‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­ä»¥åŠå¤šç§ä¼˜åŒ–ç®—æ³•ã€‚</p>\n<details class=\"info\"><summary>å…¨è¿æ¥å±‚åŸç†</summary><div>\n<p>å…¨è¿æ¥å±‚æ‰§è¡Œçº¿æ€§å˜æ¢ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>W</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">y = Wx + b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>ï¼Œå…¶ä¸­ W æ˜¯æƒé‡çŸ©é˜µï¼Œx æ˜¯è¾“å…¥å‘é‡ï¼Œb æ˜¯åç½®å‘é‡ã€‚å¤šå±‚å…¨è¿æ¥ç½‘ç»œé€šè¿‡å †å å¤šä¸ªè¿™æ ·çš„å±‚ï¼Œå¹¶åœ¨å±‚é—´æ·»åŠ éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ ReLUï¼‰ï¼Œæ¥å­¦ä¹ å¤æ‚çš„éçº¿æ€§æ˜ å°„å…³ç³»ã€‚</p>\n</div></details>\n<div class=\"note info no-icon\">\n<p>å…¨è¿æ¥ç½‘ç»œçš„æ ‡å‡†ç»“æ„ä¸ºï¼š{affine - [batch/layer norm] - relu - [dropout]} x (L-1) - affine - softmaxï¼Œå…¶ä¸­å½’ä¸€åŒ–å’Œ dropout æ˜¯å¯é€‰çš„ã€‚</p>\n</div>\n<h1 id=\"æ ¸å¿ƒç½‘ç»œç±»å®ç°\"><a class=\"anchor\" href=\"#æ ¸å¿ƒç½‘ç»œç±»å®ç°\">#</a> æ ¸å¿ƒç½‘ç»œç±»å®ç°</h1>\n<p><code>FullyConnectedNet</code>  ç±»æ˜¯æ•´ä¸ªç½‘ç»œçš„æ ¸å¿ƒå®ç°ï¼Œæ”¯æŒä»»æ„éšè—å±‚æ•°ã€æ‰¹å½’ä¸€åŒ–ã€å±‚å½’ä¸€åŒ–å’Œ dropout ç­‰åŠŸèƒ½ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>å…¨è¿æ¥ç½‘ç»œæ ¸å¿ƒç±»</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">FullyConnectedNet</span>(<span class=\"title class_ inherited__\">object</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;å¤šå±‚å…¨è¿æ¥ç¥ç»ç½‘ç»œç±»</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    ç½‘ç»œåŒ…å«ä»»æ„æ•°é‡çš„éšè—å±‚ã€ReLUæ¿€æ´»å‡½æ•°å’ŒsoftmaxæŸå¤±å‡½æ•°ã€‚</span></span><br><span class=\"line\"><span class=\"string\">    æ”¯æŒdropoutå’Œæ‰¹å½’ä¸€åŒ–/å±‚å½’ä¸€åŒ–é€‰é¡¹ã€‚</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\">        self,</span></span><br><span class=\"line\"><span class=\"params\">        hidden_dims,</span></span><br><span class=\"line\"><span class=\"params\">        input_dim=<span class=\"number\">3</span> * <span class=\"number\">32</span> * <span class=\"number\">32</span>,</span></span><br><span class=\"line\"><span class=\"params\">        num_classes=<span class=\"number\">10</span>,</span></span><br><span class=\"line\"><span class=\"params\">        dropout_keep_ratio=<span class=\"number\">1</span>,</span></span><br><span class=\"line\"><span class=\"params\">        normalization=<span class=\"literal\">None</span>,</span></span><br><span class=\"line\"><span class=\"params\">        reg=<span class=\"number\">0.0</span>,</span></span><br><span class=\"line\"><span class=\"params\">        weight_scale=<span class=\"number\">1e-2</span>,</span></span><br><span class=\"line\"><span class=\"params\">        dtype=np.float32,</span></span><br><span class=\"line\"><span class=\"params\">        seed=<span class=\"literal\">None</span>,</span></span><br><span class=\"line\"><span class=\"params\">    </span>):</span><br><span class=\"line\">        <span class=\"comment\"># åˆå§‹åŒ–ç½‘ç»œå‚æ•°</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.normalization = normalization</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.use_dropout = dropout_keep_ratio != <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.reg = reg</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.num_layers = <span class=\"number\">1</span> + <span class=\"built_in\">len</span>(hidden_dims)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.dtype = dtype</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.params = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># åˆå§‹åŒ–æƒé‡å’Œåç½®å‚æ•°</span></span><br><span class=\"line\">        layer_dims = [input_dim] + hidden_dims + [num_classes]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"variable language_\">self</span>.num_layers):</span><br><span class=\"line\">            W_key = <span class=\"string\">f&quot;W<span class=\"subst\">&#123;i + <span class=\"number\">1</span>&#125;</span>&quot;</span></span><br><span class=\"line\">            b_key = <span class=\"string\">f&quot;b<span class=\"subst\">&#123;i + <span class=\"number\">1</span>&#125;</span>&quot;</span></span><br><span class=\"line\">            <span class=\"comment\"># æƒé‡ä½¿ç”¨æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–ï¼Œåç½®åˆå§‹åŒ–ä¸ºé›¶</span></span><br><span class=\"line\">            <span class=\"variable language_\">self</span>.params[W_key] = np.random.normal(</span><br><span class=\"line\">                <span class=\"number\">0</span>, weight_scale, (layer_dims[i], layer_dims[i + <span class=\"number\">1</span>])</span><br><span class=\"line\">            )</span><br><span class=\"line\">            <span class=\"variable language_\">self</span>.params[b_key] = np.zeros(layer_dims[i + <span class=\"number\">1</span>])</span><br></pre></td></tr></table></figure>\n<details class=\"info\"><summary>å‚æ•°åˆå§‹åŒ–ç­–ç•¥</summary><div>\n<p>æƒé‡çŸ©é˜µä½¿ç”¨å‡å€¼ä¸º 0ã€æ ‡å‡†å·®ä¸º weight_scale çš„æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–ï¼Œè¿™ç§æ–¹æ³•ç§°ä¸º Xavier åˆå§‹åŒ–çš„ç®€åŒ–ç‰ˆæœ¬ã€‚åç½®å‘é‡åˆå§‹åŒ–ä¸ºé›¶æ˜¯æ ‡å‡†åšæ³•ï¼Œé¿å…å¼•å…¥é¢å¤–çš„åå·®ã€‚</p>\n</div></details>\n<h2 id=\"å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­\"><a class=\"anchor\" href=\"#å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­\">#</a> å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­</h2>\n<p>ç½‘ç»œçš„ <code>loss</code>  æ–¹æ³•å®ç°äº†å®Œæ•´çš„å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­è¿‡ç¨‹ï¼š</p>\n<figure class=\"highlight python\"><figcaption><span>å‰å‘ä¼ æ’­å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">loss</span>(<span class=\"params\">self, X, y=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;è®¡ç®—æŸå¤±å’Œæ¢¯åº¦&quot;&quot;&quot;</span></span><br><span class=\"line\">    X = X.astype(<span class=\"variable language_\">self</span>.dtype)</span><br><span class=\"line\">    mode = <span class=\"string\">&quot;test&quot;</span> <span class=\"keyword\">if</span> y <span class=\"keyword\">is</span> <span class=\"literal\">None</span> <span class=\"keyword\">else</span> <span class=\"string\">&quot;train&quot;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># å‰å‘ä¼ æ’­ï¼šé€å±‚è®¡ç®—</span></span><br><span class=\"line\">    caches = []</span><br><span class=\"line\">    out = X</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"variable language_\">self</span>.num_layers - <span class=\"number\">1</span>):</span><br><span class=\"line\">        W_key = <span class=\"string\">f&quot;W<span class=\"subst\">&#123;i + <span class=\"number\">1</span>&#125;</span>&quot;</span></span><br><span class=\"line\">        b_key = <span class=\"string\">f&quot;b<span class=\"subst\">&#123;i + <span class=\"number\">1</span>&#125;</span>&quot;</span></span><br><span class=\"line\">        <span class=\"comment\"># ä»¿å°„å˜æ¢</span></span><br><span class=\"line\">        out, cache = affine_forward(out, <span class=\"variable language_\">self</span>.params[W_key], <span class=\"variable language_\">self</span>.params[b_key])</span><br><span class=\"line\">        caches.append(cache)</span><br><span class=\"line\">        <span class=\"comment\"># ReLUæ¿€æ´»</span></span><br><span class=\"line\">        out, relu_cache = relu_forward(out)</span><br><span class=\"line\">        caches.append(relu_cache)</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"comment\"># æœ€åä¸€å±‚ï¼ˆè¾“å‡ºå±‚ï¼‰</span></span><br><span class=\"line\">    W_key = <span class=\"string\">f&quot;W<span class=\"subst\">&#123;self.num_layers&#125;</span>&quot;</span></span><br><span class=\"line\">    b_key = <span class=\"string\">f&quot;b<span class=\"subst\">&#123;self.num_layers&#125;</span>&quot;</span></span><br><span class=\"line\">    scores, final_cache = affine_forward(out, <span class=\"variable language_\">self</span>.params[W_key], <span class=\"variable language_\">self</span>.params[b_key])</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">if</span> mode == <span class=\"string\">&quot;test&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> scores</span><br></pre></td></tr></table></figure>\n<div class=\"note warning no-icon\">\n<p>å‰å‘ä¼ æ’­è¿‡ç¨‹ä¸­éœ€è¦ä¿å­˜æ¯å±‚çš„ cacheï¼Œè¿™äº›ä¿¡æ¯åœ¨åå‘ä¼ æ’­æ—¶è®¡ç®—æ¢¯åº¦å¿…éœ€çš„ã€‚</p>\n</div>\n<p>åå‘ä¼ æ’­å®ç°æŸå¤±è®¡ç®—å’Œæ¢¯åº¦æ›´æ–°ï¼š</p>\n<figure class=\"highlight python\"><figcaption><span>åå‘ä¼ æ’­å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># è®¡ç®—softmaxæŸå¤±</span></span><br><span class=\"line\">loss, dscores = softmax_loss(scores, y)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ·»åŠ L2æ­£åˆ™åŒ–é¡¹</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"variable language_\">self</span>.num_layers):</span><br><span class=\"line\">    W_key = <span class=\"string\">f&quot;W<span class=\"subst\">&#123;i + <span class=\"number\">1</span>&#125;</span>&quot;</span></span><br><span class=\"line\">    loss += <span class=\"number\">0.5</span> * <span class=\"variable language_\">self</span>.reg * np.<span class=\"built_in\">sum</span>(<span class=\"variable language_\">self</span>.params[W_key] ** <span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦</span></span><br><span class=\"line\">dout, dW, db = affine_backward(dscores, final_cache)</span><br><span class=\"line\">grads[<span class=\"string\">f&quot;W<span class=\"subst\">&#123;self.num_layers&#125;</span>&quot;</span>] = dW + <span class=\"variable language_\">self</span>.reg * <span class=\"variable language_\">self</span>.params[<span class=\"string\">f&quot;W<span class=\"subst\">&#123;self.num_layers&#125;</span>&quot;</span>]</span><br><span class=\"line\">grads[<span class=\"string\">f&quot;b<span class=\"subst\">&#123;self.num_layers&#125;</span>&quot;</span>] = db</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é€å±‚åå‘ä¼ æ’­</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"variable language_\">self</span>.num_layers - <span class=\"number\">1</span>, <span class=\"number\">0</span>, -<span class=\"number\">1</span>):</span><br><span class=\"line\">    dout = relu_backward(dout, caches.pop())</span><br><span class=\"line\">    dout, dW, db = affine_backward(dout, caches.pop())</span><br><span class=\"line\">    grads[<span class=\"string\">f&quot;W<span class=\"subst\">&#123;i&#125;</span>&quot;</span>] = dW + <span class=\"variable language_\">self</span>.reg * <span class=\"variable language_\">self</span>.params[<span class=\"string\">f&quot;W<span class=\"subst\">&#123;i&#125;</span>&quot;</span>]</span><br><span class=\"line\">    grads[<span class=\"string\">f&quot;b<span class=\"subst\">&#123;i&#125;</span>&quot;</span>] = db</span><br></pre></td></tr></table></figure>\n<p>L2 æ­£åˆ™åŒ–æŸå¤±å‡½æ•°çš„å®Œæ•´å½¢å¼ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>L</mi><mi>i</mi></msub><mo>+</mo><mfrac><mi>Î»</mi><mn>2</mn></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></munderover><mi mathvariant=\"normal\">âˆ¥</mi><msup><mi>W</mi><mrow><mo stretchy=\"false\">(</mo><mi>l</mi><mo stretchy=\"false\">)</mo></mrow></msup><msubsup><mi mathvariant=\"normal\">âˆ¥</mi><mi>F</mi><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">L = \\frac{1}{N}\\sum_{i=1}^{N} L_i + \\frac{\\lambda}{2}\\sum_{l=1}^{L}\\|W^{(l)}\\|_F^2\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106005em;vertical-align:-1.277669em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.1304490000000005em;vertical-align:-1.302113em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Î»</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.302113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">âˆ¥</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">âˆ¥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">F</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>å…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">L_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> æ˜¯ç¬¬ i ä¸ªæ ·æœ¬çš„ softmax æŸå¤±ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î»</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">Î»</span></span></span></span> æ˜¯æ­£åˆ™åŒ–å¼ºåº¦ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ¥</mi><msup><mi>W</mi><mrow><mo stretchy=\"false\">(</mo><mi>l</mi><mo stretchy=\"false\">)</mo></mrow></msup><msubsup><mi mathvariant=\"normal\">âˆ¥</mi><mi>F</mi><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\|W^{(l)}\\|_F^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.163331em;vertical-align:-0.275331em;\"></span><span class=\"mord\">âˆ¥</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">âˆ¥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-2.424669em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">F</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.275331em;\"><span></span></span></span></span></span></span></span></span></span> æ˜¯ç¬¬ l å±‚æƒé‡çŸ©é˜µçš„ Frobenius èŒƒæ•°å¹³æ–¹ã€‚</p>\n<h1 id=\"ä¼˜åŒ–ç®—æ³•å®ç°\"><a class=\"anchor\" href=\"#ä¼˜åŒ–ç®—æ³•å®ç°\">#</a> ä¼˜åŒ–ç®—æ³•å®ç°</h1>\n<p>æ·±åº¦å­¦ä¹ ä¸­ä½¿ç”¨å¤šç§ä¼˜åŒ–ç®—æ³•æ¥æ›´æ–°ç½‘ç»œå‚æ•°ï¼Œæ¯ç§ç®—æ³•éƒ½æœ‰å…¶ç‰¹å®šçš„ä¼˜åŠ¿ã€‚</p>\n<h2 id=\"sgd-with-momentum\"><a class=\"anchor\" href=\"#sgd-with-momentum\">#</a> SGD with Momentum</h2>\n<p>åŠ¨é‡ SGD é€šè¿‡ç´¯ç§¯å†å²æ¢¯åº¦ä¿¡æ¯æ¥åŠ é€Ÿæ”¶æ•›ï¼š</p>\n<figure class=\"highlight python\"><figcaption><span>SGDåŠ¨é‡ä¼˜åŒ–å™¨</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sgd_momentum</span>(<span class=\"params\">w, dw, config=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;å¸¦åŠ¨é‡çš„éšæœºæ¢¯åº¦ä¸‹é™</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    configå‚æ•°ï¼š</span></span><br><span class=\"line\"><span class=\"string\">    - learning_rate: å­¦ä¹ ç‡</span></span><br><span class=\"line\"><span class=\"string\">    - momentum: åŠ¨é‡ç³»æ•°ï¼Œé€šå¸¸è®¾ä¸º0.9</span></span><br><span class=\"line\"><span class=\"string\">    - velocity: é€Ÿåº¦å‘é‡ï¼Œå­˜å‚¨æ¢¯åº¦çš„ç§»åŠ¨å¹³å‡</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> config <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">        config = &#123;&#125;</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;learning_rate&quot;</span>, <span class=\"number\">1e-2</span>)</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;momentum&quot;</span>, <span class=\"number\">0.9</span>)</span><br><span class=\"line\">    v = config.get(<span class=\"string\">&quot;velocity&quot;</span>, np.zeros_like(w))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># åŠ¨é‡æ›´æ–°å…¬å¼</span></span><br><span class=\"line\">    v = config[<span class=\"string\">&quot;momentum&quot;</span>] * v - config[<span class=\"string\">&quot;learning_rate&quot;</span>] * dw</span><br><span class=\"line\">    next_w = w + v</span><br><span class=\"line\">    </span><br><span class=\"line\">    config[<span class=\"string\">&quot;velocity&quot;</span>] = v</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next_w, config</span><br></pre></td></tr></table></figure>\n<p>åŠ¨é‡æ›´æ–°çš„æ•°å­¦è¡¨è¾¾å¼ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>v</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>Î¼</mi><msub><mi>v</mi><mi>t</mi></msub><mo>âˆ’</mo><mi>Î±</mi><mi mathvariant=\"normal\">âˆ‡</mi><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">v_{t+1} = \\mu v_t - \\alpha \\nabla f(w_t)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.638891em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7777700000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">Î¼</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span><span class=\"mord\">âˆ‡</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>w</mi><mi>t</mi></msub><mo>+</mo><msub><mi>v</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">w_{t+1} = w_t + v_{t+1}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.638891em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.638891em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>å…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î¼</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">Î¼</span></span></span></span> æ˜¯åŠ¨é‡ç³»æ•°ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span></span></span></span> æ˜¯å­¦ä¹ ç‡ã€‚</p>\n<details class=\"info\"><summary>åŠ¨é‡ç®—æ³•åŸç†</summary><div>\n<p>åŠ¨é‡æ–¹æ³•æ¨¡æ‹Ÿç‰©ç†ä¸­çš„åŠ¨é‡æ¦‚å¿µï¼Œåœ¨ç›¸åŒæ–¹å‘çš„æ¢¯åº¦ä¼šç´¯ç§¯åŠ é€Ÿï¼Œåœ¨éœ‡è¡æ–¹å‘ä¼šç›¸äº’æŠµæ¶ˆã€‚è¿™æœ‰åŠ©äºè·³å‡ºå±€éƒ¨æœ€ä¼˜è§£å¹¶åŠ é€Ÿæ”¶æ•›ã€‚</p>\n</div></details>\n<h2 id=\"rmspropç®—æ³•\"><a class=\"anchor\" href=\"#rmspropç®—æ³•\">#</a> RMSprop ç®—æ³•</h2>\n<p>RMSprop ä½¿ç”¨æ¢¯åº¦å¹³æ–¹çš„ç§»åŠ¨å¹³å‡æ¥è‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡ï¼š</p>\n<figure class=\"highlight python\"><figcaption><span>RMSpropä¼˜åŒ–å™¨</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">rmsprop</span>(<span class=\"params\">w, dw, config=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;RMSpropæ›´æ–°è§„åˆ™</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    ä½¿ç”¨æ¢¯åº¦å¹³æ–¹å€¼çš„ç§»åŠ¨å¹³å‡æ¥è®¾ç½®è‡ªé€‚åº”çš„å­¦ä¹ ç‡</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> config <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">        config = &#123;&#125;</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;learning_rate&quot;</span>, <span class=\"number\">1e-2</span>)</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;decay_rate&quot;</span>, <span class=\"number\">0.99</span>)</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;epsilon&quot;</span>, <span class=\"number\">1e-8</span>)</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;cache&quot;</span>, np.zeros_like(w))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># RMSpropæ›´æ–°å…¬å¼</span></span><br><span class=\"line\">    cache = config[<span class=\"string\">&quot;cache&quot;</span>]</span><br><span class=\"line\">    cache = config[<span class=\"string\">&quot;decay_rate&quot;</span>] * cache + (<span class=\"number\">1</span> - config[<span class=\"string\">&quot;decay_rate&quot;</span>]) * dw ** <span class=\"number\">2</span></span><br><span class=\"line\">    next_w = w - config[<span class=\"string\">&quot;learning_rate&quot;</span>] * dw / (np.sqrt(cache) + config[<span class=\"string\">&quot;epsilon&quot;</span>])</span><br><span class=\"line\">    </span><br><span class=\"line\">    config[<span class=\"string\">&quot;cache&quot;</span>] = cache</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next_w, config</span><br></pre></td></tr></table></figure>\n<p>RMSprop çš„æ›´æ–°å…¬å¼ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>E</mi><mo stretchy=\"false\">[</mo><msup><mi>g</mi><mn>2</mn></msup><msub><mo stretchy=\"false\">]</mo><mi>t</mi></msub><mo>=</mo><mi>Î³</mi><mi>E</mi><mo stretchy=\"false\">[</mo><msup><mi>g</mi><mn>2</mn></msup><msub><mo stretchy=\"false\">]</mo><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>âˆ’</mo><mi>Î³</mi><mo stretchy=\"false\">)</mo><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">E[g^2]_t = \\gamma E[g^2]_{t-1} + (1-\\gamma) g_t^2\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">Î³</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">Î³</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>w</mi><mi>t</mi></msub><mo>âˆ’</mo><mfrac><mi>Î±</mi><msqrt><mrow><mi>E</mi><mo stretchy=\"false\">[</mo><msup><mi>g</mi><mn>2</mn></msup><msub><mo stretchy=\"false\">]</mo><mi>t</mi></msub><mo>+</mo><mi>Ïµ</mi></mrow></msqrt></mfrac><msub><mi>g</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_{t+1} = w_t - \\frac{\\alpha}{\\sqrt{E[g^2]_t + \\epsilon}} g_t\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.638891em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.23756em;vertical-align:-1.13em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.175em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.935em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">Ïµ</span></span></span><span style=\"top:-2.8950000000000005em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30499999999999994em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.13em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>å…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î³</mi></mrow><annotation encoding=\"application/x-tex\">\\gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">Î³</span></span></span></span> æ˜¯è¡°å‡ç‡ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ïµ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">Ïµ</span></span></span></span> æ˜¯æ•°å€¼ç¨³å®šé¡¹ã€‚</p>\n<h2 id=\"adamä¼˜åŒ–å™¨\"><a class=\"anchor\" href=\"#adamä¼˜åŒ–å™¨\">#</a> Adam ä¼˜åŒ–å™¨</h2>\n<p>Adam ç»“åˆäº†åŠ¨é‡å’Œ RMSprop çš„ä¼˜ç‚¹ï¼Œæ˜¯ç›®å‰æœ€å¸¸ç”¨çš„ä¼˜åŒ–ç®—æ³•ä¹‹ä¸€ï¼š</p>\n<figure class=\"highlight python\"><figcaption><span>Adamä¼˜åŒ–å™¨</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">adam</span>(<span class=\"params\">w, dw, config=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;Adamæ›´æ–°è§„åˆ™</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    ç»“åˆäº†æ¢¯åº¦çš„ä¸€é˜¶çŸ©ä¼°è®¡å’ŒäºŒé˜¶çŸ©ä¼°è®¡ï¼Œå¹¶åŒ…å«åå·®ä¿®æ­£é¡¹</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> config <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">        config = &#123;&#125;</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;learning_rate&quot;</span>, <span class=\"number\">1e-3</span>)</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;beta1&quot;</span>, <span class=\"number\">0.9</span>)</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;beta2&quot;</span>, <span class=\"number\">0.999</span>)</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;epsilon&quot;</span>, <span class=\"number\">1e-8</span>)</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;m&quot;</span>, np.zeros_like(w))</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;v&quot;</span>, np.zeros_like(w))</span><br><span class=\"line\">    config.setdefault(<span class=\"string\">&quot;t&quot;</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># æ›´æ–°è¿­ä»£è®¡æ•°</span></span><br><span class=\"line\">    config[<span class=\"string\">&quot;t&quot;</span>] += <span class=\"number\">1</span></span><br><span class=\"line\">    m = config[<span class=\"string\">&quot;m&quot;</span>]</span><br><span class=\"line\">    v = config[<span class=\"string\">&quot;v&quot;</span>]</span><br><span class=\"line\">    beta1 = config[<span class=\"string\">&quot;beta1&quot;</span>]</span><br><span class=\"line\">    beta2 = config[<span class=\"string\">&quot;beta2&quot;</span>]</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># è®¡ç®—åŠ¨é‡å’ŒäºŒé˜¶çŸ©ä¼°è®¡</span></span><br><span class=\"line\">    m = beta1 * m + (<span class=\"number\">1</span> - beta1) * dw</span><br><span class=\"line\">    v = beta2 * v + (<span class=\"number\">1</span> - beta2) * (dw ** <span class=\"number\">2</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># åå·®ä¿®æ­£</span></span><br><span class=\"line\">    m_hat = m / (<span class=\"number\">1</span> - beta1 ** config[<span class=\"string\">&quot;t&quot;</span>])</span><br><span class=\"line\">    v_hat = v / (<span class=\"number\">1</span> - beta2 ** config[<span class=\"string\">&quot;t&quot;</span>])</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># å‚æ•°æ›´æ–°</span></span><br><span class=\"line\">    next_w = w - config[<span class=\"string\">&quot;learning_rate&quot;</span>] * m_hat / (np.sqrt(v_hat) + config[<span class=\"string\">&quot;epsilon&quot;</span>])</span><br><span class=\"line\">    </span><br><span class=\"line\">    config[<span class=\"string\">&quot;m&quot;</span>] = m</span><br><span class=\"line\">    config[<span class=\"string\">&quot;v&quot;</span>] = v</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next_w, config</span><br></pre></td></tr></table></figure>\n<p>Adam ç®—æ³•çš„å®Œæ•´æ›´æ–°å…¬å¼ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>m</mi><mi>t</mi></msub><mo>=</mo><msub><mi>Î²</mi><mn>1</mn></msub><msub><mi>m</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>Î²</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><msub><mi>g</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">m_t = \\beta_1 m_{t-1} + (1-\\beta_1) g_t\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.902771em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">Î²</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">Î²</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>v</mi><mi>t</mi></msub><mo>=</mo><msub><mi>Î²</mi><mn>2</mn></msub><msub><mi>v</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>Î²</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">v_t = \\beta_2 v_{t-1} + (1-\\beta_2) g_t^2\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.902771em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">Î²</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">Î²</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi>m</mi><mo>^</mo></mover><mi>t</mi></msub><mo>=</mo><mfrac><msub><mi>m</mi><mi>t</mi></msub><mrow><mn>1</mn><mo>âˆ’</mo><msubsup><mi>Î²</mi><mn>1</mn><mi>t</mi></msubsup></mrow></mfrac><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msub><mover accent=\"true\"><mi>v</mi><mo>^</mo></mover><mi>t</mi></msub><mo>=</mo><mfrac><msub><mi>v</mi><mi>t</mi></msub><mrow><mn>1</mn><mo>âˆ’</mo><msubsup><mi>Î²</mi><mn>2</mn><mi>t</mi></msubsup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\hat{m}_t = \\frac{m_t}{1-\\beta_1^t}, \\quad \\hat{v}_t = \\frac{v_t}{1-\\beta_2^t}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.059868em;vertical-align:-0.9523079999999999em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1075599999999999em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">Î²</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7753559999999999em;\"><span style=\"top:-2.433692em;margin-left:-0.05278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.0448000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.26630799999999993em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9523079999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.22222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.059868em;vertical-align:-0.9523079999999999em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1075599999999999em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">Î²</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7753559999999999em;\"><span style=\"top:-2.433692em;margin-left:-0.05278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.0448000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.26630799999999993em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9523079999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>w</mi><mi>t</mi></msub><mo>âˆ’</mo><mfrac><mi>Î±</mi><mrow><msqrt><msub><mover accent=\"true\"><mi>v</mi><mo>^</mo></mover><mi>t</mi></msub></msqrt><mo>+</mo><mi>Ïµ</mi></mrow></mfrac><msub><mover accent=\"true\"><mi>m</mi><mo>^</mo></mover><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_{t+1} = w_t - \\frac{\\alpha}{\\sqrt{\\hat{v}_t} + \\epsilon} \\hat{m}_t\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.638891em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.03756em;vertical-align:-0.93em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.25278em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85722em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.22222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.81722em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.18278000000000005em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">Ïµ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>å…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Î²</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\beta_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">Î²</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Î²</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\beta_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">Î²</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> åˆ†åˆ«æ˜¯ä¸€é˜¶å’ŒäºŒé˜¶çŸ©çš„è¡°å‡ç‡ã€‚</p>\n<details class=\"info\"><summary>åå·®ä¿®æ­£çš„å¿…è¦æ€§</summary><div>\n<p>åœ¨è®­ç»ƒåˆæœŸï¼Œç”±äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">m_0 = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">v_0 = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span>ï¼Œç§»åŠ¨å¹³å‡ä¼°è®¡ä¼šåå‘é›¶ã€‚åå·®ä¿®æ­£é¡¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>1</mn><mrow><mn>1</mn><mo>âˆ’</mo><msup><mi>Î²</mi><mi>t</mi></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{1-\\beta^t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.326216em;vertical-align:-0.481108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">Î²</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7253428571428571em;\"><span style=\"top:-2.786em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.481108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> å¯ä»¥æ¶ˆé™¤è¿™ç§åˆå§‹åå·®ï¼Œç¡®ä¿ç®—æ³•åœ¨è®­ç»ƒå¼€å§‹æ—¶çš„ç¨³å®šæ€§ã€‚</p>\n</div></details>\n<h1 id=\"è¶…å‚æ•°è°ƒä¼˜å®è·µ\"><a class=\"anchor\" href=\"#è¶…å‚æ•°è°ƒä¼˜å®è·µ\">#</a> è¶…å‚æ•°è°ƒä¼˜å®è·µ</h1>\n<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œéœ€è¦é€šè¿‡ç½‘æ ¼æœç´¢æˆ–å…¶ä»–æ–¹æ³•æ¥å¯»æ‰¾æœ€ä¼˜çš„è¶…å‚æ•°ç»„åˆï¼š</p>\n<figure class=\"highlight python\"><figcaption><span>è¶…å‚æ•°æœç´¢</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">best_model = <span class=\"literal\">None</span></span><br><span class=\"line\">learning_rate = [<span class=\"number\">1e-3</span>, <span class=\"number\">1e-4</span>, <span class=\"number\">1e-5</span>]</span><br><span class=\"line\">weight_scale = [<span class=\"number\">5e-2</span>, <span class=\"number\">1e-2</span>, <span class=\"number\">1e-1</span>]</span><br><span class=\"line\">update_rule = <span class=\"string\">&quot;adam&quot;</span>  </span><br><span class=\"line\">best_val_acc = <span class=\"number\">0.0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> lr <span class=\"keyword\">in</span> learning_rate:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> ws <span class=\"keyword\">in</span> weight_scale:</span><br><span class=\"line\">        <span class=\"comment\"># æ„å»º5å±‚éšè—å±‚ç½‘ç»œ</span></span><br><span class=\"line\">        model = FullyConnectedNet(</span><br><span class=\"line\">            [<span class=\"number\">100</span>, <span class=\"number\">100</span>, <span class=\"number\">100</span>, <span class=\"number\">100</span>, <span class=\"number\">100</span>],</span><br><span class=\"line\">            weight_scale=ws,</span><br><span class=\"line\">            dtype=np.float64</span><br><span class=\"line\">        )</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># ä½¿ç”¨Solverè¿›è¡Œè®­ç»ƒ</span></span><br><span class=\"line\">        solver = Solver(</span><br><span class=\"line\">            model,</span><br><span class=\"line\">            data,</span><br><span class=\"line\">            print_every=<span class=\"number\">100</span>,</span><br><span class=\"line\">            num_epochs=<span class=\"number\">20</span>,</span><br><span class=\"line\">            batch_size=<span class=\"number\">100</span>,</span><br><span class=\"line\">            update_rule=update_rule,</span><br><span class=\"line\">            optim_config=&#123;<span class=\"string\">&quot;learning_rate&quot;</span>: lr&#125;,</span><br><span class=\"line\">        )</span><br><span class=\"line\">        solver.train()</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># ä¿å­˜æœ€ä½³æ¨¡å‹</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> best_model <span class=\"keyword\">is</span> <span class=\"literal\">None</span> <span class=\"keyword\">or</span> solver.best_val_acc &gt; best_val_acc:</span><br><span class=\"line\">            best_model = solver.model</span><br><span class=\"line\">            best_val_acc = solver.best_val_acc</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;New best model found with learning_rate=<span class=\"subst\">&#123;lr&#125;</span>, weight_scale=<span class=\"subst\">&#123;ws&#125;</span>, val_acc=<span class=\"subst\">&#123;solver.best_val_acc:<span class=\"number\">.4</span>f&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>\n<div class=\"note success no-icon\">\n<p>ç½‘æ ¼æœç´¢è™½ç„¶è®¡ç®—æˆæœ¬è¾ƒé«˜ï¼Œä½†èƒ½å¤Ÿç³»ç»Ÿæ€§åœ°æ¢ç´¢è¶…å‚æ•°ç©ºé—´ï¼Œæ‰¾åˆ°ç›¸å¯¹æœ€ä¼˜çš„ç»„åˆã€‚åœ¨å®è·µä¸­å»ºè®®ä¼˜å…ˆè°ƒæ•´å­¦ä¹ ç‡å’Œæƒé‡åˆå§‹åŒ–å°ºåº¦ã€‚</p>\n</div>\n<div class=\"tab\" data-id=\"experiment\" data-title=\"è¶…å‚æ•°é€‰æ‹©å»ºè®®\">\n<p>å­¦ä¹ ç‡ï¼šAdam ä¼˜åŒ–å™¨é€šå¸¸ä½¿ç”¨ 1e-3 ä½œä¸ºèµ·ç‚¹ï¼Œå¯åœ¨ 1e-4 åˆ° 1e-2 èŒƒå›´å†…è°ƒæ•´<br />\næƒé‡åˆå§‹åŒ–ï¼šå¯¹äº ReLU æ¿€æ´»å‡½æ•°ï¼Œæ¨èä½¿ç”¨ sqrt (2/fan_in) æˆ–ç®€åŒ–çš„ 1e-2 åˆ° 1e-1 èŒƒå›´<br />\næ‰¹å¤§å°ï¼šé€šå¸¸é€‰æ‹© 32ã€64ã€128 ç­‰ 2 çš„å¹‚æ¬¡ï¼Œéœ€è¦å¹³è¡¡å†…å­˜ä½¿ç”¨å’Œæ¢¯åº¦ä¼°è®¡è´¨é‡</p>\n</div>\n<div class=\"tab\" data-id=\"experiment\" data-title=\"è®­ç»ƒæŠ€å·§\">\n<p>ç½‘ç»œæ·±åº¦ï¼šä»è¾ƒæµ…çš„ç½‘ç»œå¼€å§‹ï¼Œé€æ­¥å¢åŠ å±‚æ•°è§‚å¯Ÿæ€§èƒ½å˜åŒ–<br />\næ­£åˆ™åŒ–ï¼šL2 æ­£åˆ™åŒ–ç³»æ•°é€šå¸¸åœ¨ 1e-4 åˆ° 1e-1 èŒƒå›´å†…é€‰æ‹©<br />\næ—©åœç­–ç•¥ï¼šç›‘æ§éªŒè¯é›†å‡†ç¡®ç‡ï¼Œè¿ç»­å‡ ä¸ª epoch æ— æ”¹å–„æ—¶åœæ­¢è®­ç»ƒ</p>\n</div>\n",
            "tags": [
                "å­¦ä¹ ç¬”è®°",
                "æœºå™¨å­¦ä¹ ",
                "ä»£ç å®ç°",
                "cs231n",
                "assignment1",
                "ç¥ç»ç½‘ç»œ",
                "SGD",
                "æ·±åº¦å­¦ä¹ ",
                "ä¼˜åŒ–ç®—æ³•",
                "Adam",
                "cs231n",
                "å…¨è¿æ¥ç½‘ç»œ",
                "RMSprop",
                "åå‘ä¼ æ’­",
                "è¶…å‚æ•°è°ƒä¼˜"
            ]
        },
        {
            "id": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/cs231n%E7%9A%84assignment1%EF%BC%9AImage-Features/",
            "url": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/cs231n%E7%9A%84assignment1%EF%BC%9AImage-Features/",
            "title": "cs231nçš„assignment1ï¼šImage Features",
            "date_published": "2025-07-27T11:27:44.000Z",
            "content_html": "<h1 id=\"åŸºäºç‰¹å¾çš„å›¾åƒåˆ†ç±»\"><a class=\"anchor\" href=\"#åŸºäºç‰¹å¾çš„å›¾åƒåˆ†ç±»\">#</a> åŸºäºç‰¹å¾çš„å›¾åƒåˆ†ç±»</h1>\n<p>ä¼ ç»Ÿçš„å›¾åƒåˆ†ç±»æ–¹æ³•ç›´æ¥ä½¿ç”¨åŸå§‹åƒç´ ä½œä¸ºè¾“å…¥ï¼Œè¿™ç§æ–¹å¼å­˜åœ¨è®¡ç®—å¤æ‚åº¦é«˜ã€ç‰¹å¾è¡¨è¾¾èƒ½åŠ›æœ‰é™çš„é—®é¢˜ã€‚é€šè¿‡æå–å›¾åƒçš„æ‰‹å·¥ç‰¹å¾ï¼Œå¯ä»¥æœ‰æ•ˆæå‡åˆ†ç±»å™¨çš„æ€§èƒ½ã€‚åŸºäºç‰¹å¾çš„å­¦ä¹ æ–¹æ³•èƒ½å¤Ÿå°†é«˜ç»´çš„å›¾åƒæ•°æ®è½¬æ¢ä¸ºæ›´å…·åˆ¤åˆ«æ€§çš„ä½ç»´ç‰¹å¾å‘é‡ï¼Œä»è€Œæ”¹å–„åˆ†ç±»æ•ˆæœã€‚</p>\n<details class=\"info\"><summary>HOGç‰¹å¾è¯¦è§£</summary><div>\n<p>HOGï¼ˆHistogram of Oriented Gradientsï¼‰æ˜¯ä¸€ç§ç”¨äºç›®æ ‡æ£€æµ‹çš„ç‰¹å¾æè¿°å­ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡è®¡ç®—å›¾åƒå±€éƒ¨åŒºåŸŸçš„æ¢¯åº¦æ–¹å‘ç›´æ–¹å›¾æ¥æè¿°å›¾åƒçš„å±€éƒ¨å½¢çŠ¶å’Œçº¹ç†ä¿¡æ¯ã€‚</p>\n<p><strong>è®¡ç®—æ­¥éª¤ï¼š</strong></p>\n<ol>\n<li><strong>æ¢¯åº¦è®¡ç®—</strong>ï¼šå¯¹å›¾åƒè¿›è¡Œç°åº¦åŒ–ï¼Œè®¡ç®—æ¯ä¸ªåƒç´ ç‚¹çš„æ¢¯åº¦å¹…å€¼å’Œæ–¹å‘</li>\n<li><strong>ç»†èƒåˆ’åˆ†</strong>ï¼šå°†å›¾åƒåˆ’åˆ†ä¸ºå°çš„ç»†èƒå•å…ƒï¼ˆé€šå¸¸ä¸º 8Ã—8 åƒç´ ï¼‰</li>\n<li><strong>æ¢¯åº¦ç»Ÿè®¡</strong>ï¼šåœ¨æ¯ä¸ªç»†èƒå†…ç»Ÿè®¡æ¢¯åº¦æ–¹å‘çš„ç›´æ–¹å›¾</li>\n<li><strong>å—å½’ä¸€åŒ–</strong>ï¼šå°†ç›¸é‚»çš„ç»†èƒç»„æˆå—ï¼Œè¿›è¡Œå½’ä¸€åŒ–å¤„ç†ä»¥å‡å°‘å…‰ç…§å˜åŒ–çš„å½±å“</li>\n<li><strong>ç‰¹å¾è¿æ¥</strong>ï¼šå°†æ‰€æœ‰å—çš„ HOG ç‰¹å¾ä¸²è”å½¢æˆæœ€ç»ˆçš„ç‰¹å¾å‘é‡</li>\n</ol>\n<p>HOG ç‰¹å¾å¯¹å…‰ç…§å˜åŒ–å’Œå°çš„å½¢å˜å…·æœ‰è¾ƒå¥½çš„é²æ£’æ€§ï¼Œå¹¿æ³›åº”ç”¨äºè¡Œäººæ£€æµ‹ã€ç‰©ä½“è¯†åˆ«ç­‰ä»»åŠ¡ã€‚</p>\n</div></details>\n<details class=\"info\"><summary>Color Histogramç‰¹å¾è¯¦è§£</summary><div>\n<p>Color Histogramï¼ˆé¢œè‰²ç›´æ–¹å›¾ï¼‰æ˜¯ä¸€ç§æè¿°å›¾åƒé¢œè‰²åˆ†å¸ƒçš„ç»Ÿè®¡ç‰¹å¾ã€‚å®ƒé€šè¿‡ç»Ÿè®¡å›¾åƒä¸­ä¸åŒé¢œè‰²å‡ºç°çš„é¢‘ç‡æ¥è¡¨å¾å›¾åƒçš„é¢œè‰²ä¿¡æ¯ã€‚</p>\n<p><strong>åŸºæœ¬åŸç†ï¼š</strong></p>\n<ul>\n<li>å°†é¢œè‰²ç©ºé—´é‡åŒ–ä¸ºæœ‰é™ä¸ªé¢œè‰²ç®±ï¼ˆbinï¼‰</li>\n<li>ç»Ÿè®¡æ¯ä¸ªé¢œè‰²ç®±ä¸­åƒç´ çš„æ•°é‡æˆ–æ¯”ä¾‹</li>\n<li>å½¢æˆæè¿°å›¾åƒæ•´ä½“é¢œè‰²åˆ†å¸ƒçš„ç›´æ–¹å›¾</li>\n</ul>\n<p><strong>ä¼˜åŠ¿ï¼š</strong></p>\n<ul>\n<li>å¯¹å›¾åƒçš„æ—‹è½¬ã€å¹³ç§»ã€ç¼©æ”¾å…·æœ‰ä¸å˜æ€§</li>\n<li>è®¡ç®—ç®€å•ï¼Œé€‚åˆå®æ—¶å¤„ç†</li>\n<li>èƒ½å¤Ÿæœ‰æ•ˆåŒºåˆ†å…·æœ‰ä¸åŒé¢œè‰²åˆ†å¸ƒçš„å›¾åƒ</li>\n</ul>\n<p><strong>å±€é™æ€§ï¼š</strong></p>\n<ul>\n<li>ä¸¢å¤±äº†é¢œè‰²çš„ç©ºé—´åˆ†å¸ƒä¿¡æ¯</li>\n<li>å¯¹äºé¢œè‰²ç›¸ä¼¼ä½†å†…å®¹ä¸åŒçš„å›¾åƒåŒºåˆ†èƒ½åŠ›æœ‰é™</li>\n</ul>\n</div></details>\n<details class=\"info\"><summary>HSVé¢œè‰²ç©ºé—´è¯¦è§£</summary><div>\n<p>HSVï¼ˆHue, Saturation, Valueï¼‰æ˜¯ä¸€ç§æ›´æ¥è¿‘äººç±»è§†è§‰æ„ŸçŸ¥çš„é¢œè‰²è¡¨ç¤ºæ–¹æ³•ï¼Œç”±è‰²è°ƒã€é¥±å’Œåº¦å’Œæ˜åº¦ä¸‰ä¸ªåˆ†é‡ç»„æˆã€‚</p>\n<p><strong>ä¸‰ä¸ªåˆ†é‡ï¼š</strong></p>\n<ul>\n<li><strong>Hueï¼ˆè‰²è°ƒï¼‰</strong>ï¼šè¡¨ç¤ºé¢œè‰²çš„ç§ç±»ï¼ŒèŒƒå›´é€šå¸¸ä¸º 0-360 åº¦ï¼Œå¯¹åº”å½©è™¹ä¸­çš„ä¸åŒé¢œè‰²</li>\n<li><strong>Saturationï¼ˆé¥±å’Œåº¦ï¼‰</strong>ï¼šè¡¨ç¤ºé¢œè‰²çš„çº¯åº¦ï¼ŒèŒƒå›´ä¸º 0-100%ï¼Œå€¼è¶Šé«˜é¢œè‰²è¶Šé²œè‰³</li>\n<li><strong>Valueï¼ˆæ˜åº¦ï¼‰</strong>ï¼šè¡¨ç¤ºé¢œè‰²çš„äº®åº¦ï¼ŒèŒƒå›´ä¸º 0-100%ï¼Œå€¼è¶Šé«˜é¢œè‰²è¶Šæ˜äº®</li>\n</ul>\n<p><strong>ç›¸æ¯” RGB çš„ä¼˜åŠ¿ï¼š</strong></p>\n<ul>\n<li>æ›´ç¬¦åˆäººç±»å¯¹é¢œè‰²çš„ç›´è§‚è®¤çŸ¥</li>\n<li>è‰²è°ƒåˆ†é‡å¯¹å…‰ç…§å˜åŒ–å…·æœ‰è¾ƒå¥½çš„é²æ£’æ€§</li>\n<li>ä¾¿äºè¿›è¡ŒåŸºäºé¢œè‰²çš„å›¾åƒåˆ†å‰²å’Œç›®æ ‡è¯†åˆ«</li>\n</ul>\n<p>åœ¨è®¡ç®—æœºè§†è§‰ä»»åŠ¡ä¸­ï¼ŒHSV é¢œè‰²ç©ºé—´å¸¸ç”¨äºé¢œè‰²ç‰¹å¾æå–å’ŒåŸºäºé¢œè‰²çš„ç›®æ ‡è·Ÿè¸ªã€‚</p>\n</div></details>\n<h1 id=\"ç‰¹å¾æå–çš„åˆ†ç±»å™¨è®­ç»ƒ\"><a class=\"anchor\" href=\"#ç‰¹å¾æå–çš„åˆ†ç±»å™¨è®­ç»ƒ\">#</a> ç‰¹å¾æå–çš„åˆ†ç±»å™¨è®­ç»ƒ</h1>\n<h2 id=\"softmaxåˆ†ç±»å™¨è¶…å‚æ•°è°ƒä¼˜\"><a class=\"anchor\" href=\"#softmaxåˆ†ç±»å™¨è¶…å‚æ•°è°ƒä¼˜\">#</a> Softmax åˆ†ç±»å™¨è¶…å‚æ•°è°ƒä¼˜</h2>\n<p>ä½¿ç”¨æå–çš„å›¾åƒç‰¹å¾è®­ç»ƒ Softmax åˆ†ç±»å™¨æ—¶ï¼Œéœ€è¦é€šè¿‡éªŒè¯é›†æ¥è°ƒä¼˜å­¦ä¹ ç‡å’Œæ­£åˆ™åŒ–å¼ºåº¦ç­‰è¶…å‚æ•°ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>Softmaxåˆ†ç±»å™¨è¶…å‚æ•°è°ƒä¼˜</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Use the validation set to tune the learning rate and regularization strength</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> cs231n.classifiers.linear_classifier <span class=\"keyword\">import</span> Softmax</span><br><span class=\"line\"></span><br><span class=\"line\">learning_rates = [<span class=\"number\">1e-7</span>, <span class=\"number\">1e-6</span>]</span><br><span class=\"line\">regularization_strengths = [<span class=\"number\">5e5</span>, <span class=\"number\">5e6</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">results = &#123;&#125;</span><br><span class=\"line\">best_val = -<span class=\"number\">1</span></span><br><span class=\"line\">best_softmax = <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨ç½‘æ ¼æœç´¢è°ƒä¼˜è¶…å‚æ•°</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> lr <span class=\"keyword\">in</span> learning_rates:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> reg <span class=\"keyword\">in</span> regularization_strengths:</span><br><span class=\"line\">        <span class=\"comment\"># åˆ›å»ºæ–°çš„Softmaxåˆ†ç±»å™¨</span></span><br><span class=\"line\">        softmax = Softmax()</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># åœ¨è®­ç»ƒæ•°æ®ä¸Šè®­ç»ƒåˆ†ç±»å™¨</span></span><br><span class=\"line\">        softmax.train(X_train, y_train, learning_rate=lr, reg=reg,</span><br><span class=\"line\">                      num_iters=<span class=\"number\">1500</span>, verbose=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># è®¡ç®—è®­ç»ƒå’ŒéªŒè¯å‡†ç¡®ç‡</span></span><br><span class=\"line\">        train_accuracy = (softmax.predict(X_train) == y_train).mean()</span><br><span class=\"line\">        val_accuracy = (softmax.predict(X_val) == y_val).mean()</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># å­˜å‚¨ç»“æœ</span></span><br><span class=\"line\">        results[(lr, reg)] = (train_accuracy, val_accuracy)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># æ›´æ–°æœ€ä½³æ¨¡å‹</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> val_accuracy &gt; best_val:</span><br><span class=\"line\">            best_val = val_accuracy</span><br><span class=\"line\">            best_softmax = softmax</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¾“å‡ºç»“æœ</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> lr, reg <span class=\"keyword\">in</span> <span class=\"built_in\">sorted</span>(results):</span><br><span class=\"line\">    train_accuracy, val_accuracy = results[(lr, reg)]</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;lr %e reg %e train accuracy: %f val accuracy: %f&#x27;</span> % (</span><br><span class=\"line\">                lr, reg, train_accuracy, val_accuracy))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;best validation accuracy achieved: %f&#x27;</span> % best_val)</span><br></pre></td></tr></table></figure>\n<div class=\"note info no-icon\">\n<p>é€šè¿‡ç½‘æ ¼æœç´¢æ–¹æ³•ç³»ç»Ÿæ€§åœ°æµ‹è¯•ä¸åŒè¶…å‚æ•°ç»„åˆï¼Œå¯ä»¥æ‰¾åˆ°åœ¨éªŒè¯é›†ä¸Šè¡¨ç°æœ€ä½³çš„æ¨¡å‹é…ç½®ã€‚åˆé€‚çš„å­¦ä¹ ç‡èƒ½ä¿è¯æ¨¡å‹æ”¶æ•›ï¼Œè€Œé€‚å½“çš„æ­£åˆ™åŒ–å¼ºåº¦å¯ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p>\n</div>\n<h2 id=\"ç¥ç»ç½‘ç»œç‰¹å¾åˆ†ç±»\"><a class=\"anchor\" href=\"#ç¥ç»ç½‘ç»œç‰¹å¾åˆ†ç±»\">#</a> ç¥ç»ç½‘ç»œç‰¹å¾åˆ†ç±»</h2>\n<p>ä½¿ç”¨ä¸¤å±‚ç¥ç»ç½‘ç»œå¯¹æå–çš„å›¾åƒç‰¹å¾è¿›è¡Œåˆ†ç±»ï¼Œå¯ä»¥è¿›ä¸€æ­¥æå‡åˆ†ç±»æ€§èƒ½ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>ä¸¤å±‚ç¥ç»ç½‘ç»œè®­ç»ƒ</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> cs231n.classifiers.fc_net <span class=\"keyword\">import</span> TwoLayerNet</span><br><span class=\"line\"><span class=\"keyword\">from</span> cs231n.solver <span class=\"keyword\">import</span> Solver</span><br><span class=\"line\"></span><br><span class=\"line\">input_dim = X_train_feats.shape[<span class=\"number\">1</span>]</span><br><span class=\"line\">hidden_dim = <span class=\"number\">500</span></span><br><span class=\"line\">num_classes = <span class=\"number\">10</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å‡†å¤‡æ•°æ®å­—å…¸</span></span><br><span class=\"line\">data = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;X_train&#x27;</span>: X_train_feats,</span><br><span class=\"line\">    <span class=\"string\">&#x27;y_train&#x27;</span>: y_train,</span><br><span class=\"line\">    <span class=\"string\">&#x27;X_val&#x27;</span>: X_val_feats,</span><br><span class=\"line\">    <span class=\"string\">&#x27;y_val&#x27;</span>: y_val,</span><br><span class=\"line\">    <span class=\"string\">&#x27;X_test&#x27;</span>: X_test_feats,</span><br><span class=\"line\">    <span class=\"string\">&#x27;y_test&#x27;</span>: y_test,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">net = TwoLayerNet(input_dim, hidden_dim, num_classes)</span><br><span class=\"line\">best_net = <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># äº¤å‰éªŒè¯è°ƒä¼˜è¶…å‚æ•°</span></span><br><span class=\"line\">learning_rates = [<span class=\"number\">1e-4</span>, <span class=\"number\">5e-4</span>, <span class=\"number\">1e-3</span>]</span><br><span class=\"line\">regularization_strengths = [<span class=\"number\">1e-5</span>, <span class=\"number\">1e-4</span>, <span class=\"number\">1e-3</span>]</span><br><span class=\"line\">results = &#123;&#125;</span><br><span class=\"line\">best_val = -<span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> lr <span class=\"keyword\">in</span> learning_rates:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> reg <span class=\"keyword\">in</span> regularization_strengths:</span><br><span class=\"line\">        <span class=\"comment\"># åˆ›å»ºæ–°çš„ä¸¤å±‚ç¥ç»ç½‘ç»œ</span></span><br><span class=\"line\">        net = TwoLayerNet(input_dim, hidden_dim, num_classes, reg=reg)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># åˆ›å»ºæ±‚è§£å™¨</span></span><br><span class=\"line\">        solver = Solver(net, data,</span><br><span class=\"line\">                        num_epochs=<span class=\"number\">15</span>,</span><br><span class=\"line\">                        optim_config=&#123;</span><br><span class=\"line\">                            <span class=\"string\">&#x27;learning_rate&#x27;</span>: lr,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                        verbose=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># è®­ç»ƒç½‘ç»œ</span></span><br><span class=\"line\">        solver.train()</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># è®¡ç®—éªŒè¯å‡†ç¡®ç‡</span></span><br><span class=\"line\">        val_accuracy = (solver.model.predict(data[<span class=\"string\">&#x27;X_val&#x27;</span>]) == data[<span class=\"string\">&#x27;y_val&#x27;</span>]).mean()</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># å­˜å‚¨ç»“æœ</span></span><br><span class=\"line\">        results[(lr, reg)] = val_accuracy</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># æ›´æ–°æœ€ä½³æ¨¡å‹</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> val_accuracy &gt; best_val:</span><br><span class=\"line\">            best_val = val_accuracy</span><br><span class=\"line\">            best_net = solver.model</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¾“å‡ºç»“æœ</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> lr, reg <span class=\"keyword\">in</span> <span class=\"built_in\">sorted</span>(results):</span><br><span class=\"line\">    val_accuracy = results[(lr, reg)]</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;lr %e reg %e val accuracy: %f&#x27;</span> % (lr, reg, val_accuracy))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;best validation accuracy achieved: %f&#x27;</span> % best_val)</span><br></pre></td></tr></table></figure>\n<div class=\"note info no-icon\">\n<p>ä¸¤å±‚ç¥ç»ç½‘ç»œé€šè¿‡å¼•å…¥éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œèƒ½å¤Ÿå­¦ä¹ ç‰¹å¾ä¹‹é—´çš„å¤æ‚å…³ç³»ï¼Œç›¸æ¯”çº¿æ€§åˆ†ç±»å™¨å…·æœ‰æ›´å¼ºçš„è¡¨è¾¾èƒ½åŠ›ã€‚åˆç†è®¾ç½®éšè—å±‚ç»´åº¦å’Œæ­£åˆ™åŒ–å‚æ•°ï¼Œå¯ä»¥åœ¨æå‡æ¨¡å‹å®¹é‡çš„åŒæ—¶é¿å…è¿‡æ‹Ÿåˆã€‚</p>\n</div>\n<h1 id=\"ç‰¹å¾å·¥ç¨‹çš„ä¼˜åŠ¿\"><a class=\"anchor\" href=\"#ç‰¹å¾å·¥ç¨‹çš„ä¼˜åŠ¿\">#</a> ç‰¹å¾å·¥ç¨‹çš„ä¼˜åŠ¿</h1>\n<p>åŸºäºæ‰‹å·¥ç‰¹å¾çš„å›¾åƒåˆ†ç±»æ–¹æ³•å…·æœ‰ä»¥ä¸‹æ˜¾è‘—ä¼˜åŠ¿ï¼š</p>\n<ul>\n<li><strong>é™ç»´æ•ˆæœ</strong>ï¼šå°†é«˜ç»´åŸå§‹åƒç´ æ•°æ®è½¬æ¢ä¸ºä½ç»´ç‰¹å¾å‘é‡ï¼Œå‡å°‘è®¡ç®—å¤æ‚åº¦</li>\n<li><strong>è¯­ä¹‰è¡¨è¾¾</strong>ï¼šæ‰‹å·¥è®¾è®¡çš„ç‰¹å¾èƒ½å¤Ÿæ•è·å›¾åƒçš„å…³é”®è¯­ä¹‰ä¿¡æ¯</li>\n<li><strong>é²æ£’æ€§</strong>ï¼šå¯¹å…‰ç…§å˜åŒ–ã€å‡ ä½•å˜æ¢ç­‰å¹²æ‰°å› ç´ å…·æœ‰æ›´å¥½çš„é²æ£’æ€§</li>\n<li><strong>å¯è§£é‡Šæ€§</strong>ï¼šç‰¹å¾çš„ç‰©ç†å«ä¹‰æ˜ç¡®ï¼Œä¾¿äºç†è§£å’Œè°ƒè¯•</li>\n</ul>\n<p>ç›¸æ¯”ç›´æ¥ä½¿ç”¨åŸå§‹åƒç´ è®­ç»ƒï¼ŒåŸºäºç‰¹å¾çš„å­¦ä¹ æ–¹æ³•åœ¨è®¡ç®—æ•ˆç‡å’Œåˆ†ç±»æ€§èƒ½ä¸Šéƒ½æœ‰æ˜æ˜¾æå‡ã€‚</p>\n",
            "tags": [
                "å­¦ä¹ ç¬”è®°",
                "æœºå™¨å­¦ä¹ ",
                "ä»£ç å®ç°",
                "cs231n",
                "assignment1",
                "ç¥ç»ç½‘ç»œ",
                "cs231n",
                "å›¾åƒç‰¹å¾",
                "HOG",
                "Color Histogram",
                "HSV",
                "Softmax",
                "ç‰¹å¾å·¥ç¨‹"
            ]
        },
        {
            "id": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/cs231n%E7%9A%84assignment1%EF%BC%9A%E4%BA%8C%E5%B1%82%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/",
            "url": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/cs231n%E7%9A%84assignment1%EF%BC%9A%E4%BA%8C%E5%B1%82%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/",
            "title": "cs231nçš„assignment1ï¼šäºŒå±‚ç¥ç»ç½‘ç»œ",
            "date_published": "2025-07-27T04:12:34.000Z",
            "content_html": "<h1 id=\"å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­åŸºç¡€\"><a class=\"anchor\" href=\"#å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­åŸºç¡€\">#</a> å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­åŸºç¡€</h1>\n<h2 id=\"å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­çš„æ ¸å¿ƒæ¦‚å¿µ\"><a class=\"anchor\" href=\"#å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­çš„æ ¸å¿ƒæ¦‚å¿µ\">#</a> å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­çš„æ ¸å¿ƒæ¦‚å¿µ</h2>\n<p><strong>å‰å‘ä¼ æ’­</strong>å’Œ<strong>åå‘ä¼ æ’­</strong>æ˜¯ç¥ç»ç½‘ç»œè®­ç»ƒçš„ä¸¤ä¸ªæ ¸å¿ƒè¿‡ç¨‹ï¼Œå®ƒä»¬æ„æˆäº†æ¢¯åº¦ä¸‹é™ä¼˜åŒ–çš„å®Œæ•´å¾ªç¯ã€‚</p>\n<h3 id=\"å‰å‘ä¼ æ’­forward-propagation\"><a class=\"anchor\" href=\"#å‰å‘ä¼ æ’­forward-propagation\">#</a> å‰å‘ä¼ æ’­ï¼ˆForward Propagationï¼‰</h3>\n<ul>\n<li><strong>ç›®çš„</strong>ï¼šæ ¹æ®å½“å‰å‚æ•°è®¡ç®—æ¨¡å‹çš„é¢„æµ‹è¾“å‡º</li>\n<li><strong>æ–¹å‘</strong>ï¼šä»è¾“å…¥å±‚åˆ°è¾“å‡ºå±‚</li>\n<li><strong>è¾“å‡º</strong>ï¼šæŸå¤±å€¼å’Œä¸­é—´æ¿€æ´»å€¼</li>\n</ul>\n<p>å‰å‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œè¾“å…¥æ•°æ®æŒ‰å±‚ä¾æ¬¡ä¼ é€’ï¼Œæ¯å±‚æ‰§è¡Œçº¿æ€§å˜æ¢å’Œæ¿€æ´»å‡½æ•°æ“ä½œï¼Œæœ€ç»ˆå¾—åˆ°é¢„æµ‹ç»“æœã€‚</p>\n<h3 id=\"åå‘ä¼ æ’­backward-propagation\"><a class=\"anchor\" href=\"#åå‘ä¼ æ’­backward-propagation\">#</a> åå‘ä¼ æ’­ï¼ˆBackward Propagationï¼‰</h3>\n<ul>\n<li><strong>ç›®çš„</strong>ï¼šè®¡ç®—æŸå¤±å‡½æ•°å¯¹å„å‚æ•°çš„æ¢¯åº¦</li>\n<li><strong>æ–¹å‘</strong>ï¼šä»è¾“å‡ºå±‚åˆ°è¾“å…¥å±‚</li>\n<li><strong>è¾“å‡º</strong>ï¼šå„å±‚å‚æ•°çš„æ¢¯åº¦</li>\n</ul>\n<p>åå‘ä¼ æ’­åˆ©ç”¨é“¾å¼æ³•åˆ™ï¼Œä»è¾“å‡ºå±‚å¼€å§‹é€å±‚è®¡ç®—æ¢¯åº¦ï¼Œä¸ºå‚æ•°æ›´æ–°æä¾›æ–¹å‘ä¿¡æ¯ã€‚</p>\n<details class=\"info\"><summary>å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­çš„æ•°å­¦åŸºç¡€</summary><div>\n<p>å‰å‘ä¼ æ’­å®è´¨æ˜¯å¤åˆå‡½æ•°çš„è®¡ç®—è¿‡ç¨‹ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>f</mi><mi>n</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y = f_n(f_{n-1}(...f_1(x)))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span></span>ï¼Œå…¶ä¸­æ¯ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä»£è¡¨ä¸€å±‚çš„å˜æ¢ã€‚</p>\n<p>åå‘ä¼ æ’­åˆ™æ˜¯å¤åˆå‡½æ•°æ±‚å¯¼çš„é“¾å¼æ³•åˆ™åº”ç”¨ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>Î¸</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>y</mi></mrow></mfrac><mo>â‹…</mo><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>y</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>f</mi><mi>n</mi></msub></mrow></mfrac><mo>â‹…</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo>â‹…</mo><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>f</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>Î¸</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L}{\\partial \\theta_i} = \\frac{\\partial L}{\\partial y} \\cdot \\frac{\\partial y}{\\partial f_n} \\cdot ... \\cdot \\frac{\\partial f_i}{\\partial \\theta_i}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.20744em;vertical-align:-0.8360000000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.3139999999999996em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Î¸</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.25188em;vertical-align:-0.8804400000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804400000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.25188em;vertical-align:-0.8804400000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714399999999998em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804400000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.44445em;vertical-align:0em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.20744em;vertical-align:-0.8360000000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714399999999998em;\"><span style=\"top:-2.3139999999999996em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Î¸</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>è¿™ç§è®¾è®¡ä½¿å¾—æ·±åº¦ç½‘ç»œèƒ½å¤Ÿé«˜æ•ˆåœ°è®¡ç®—é«˜ç»´å‚æ•°ç©ºé—´ä¸­çš„æ¢¯åº¦ä¿¡æ¯ã€‚</p>\n</div></details>\n<h1 id=\"ä»¿å°„å˜æ¢çš„æ•°å­¦åŸç†ä¸å®ç°\"><a class=\"anchor\" href=\"#ä»¿å°„å˜æ¢çš„æ•°å­¦åŸç†ä¸å®ç°\">#</a> ä»¿å°„å˜æ¢çš„æ•°å­¦åŸç†ä¸å®ç°</h1>\n<h2 id=\"ä»¿å°„å˜æ¢çš„æ•°å­¦è¡¨ç¤º\"><a class=\"anchor\" href=\"#ä»¿å°„å˜æ¢çš„æ•°å­¦è¡¨ç¤º\">#</a> ä»¿å°„å˜æ¢çš„æ•°å­¦è¡¨ç¤º</h2>\n<p>ä»¿å°„å˜æ¢æ˜¯ç¥ç»ç½‘ç»œä¸­æœ€åŸºç¡€çš„çº¿æ€§å˜æ¢æ“ä½œï¼Œå…¶æ•°å­¦å½¢å¼ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>out</mtext><mo>=</mo><mi>X</mi><mo>â‹…</mo><mi>W</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">\\text{out} = X \\cdot W + b\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.61508em;vertical-align:0em;\"></span><span class=\"mord text\"><span class=\"mord\">out</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span></p>\n<p>å…¶ä¸­ï¼š</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo>âˆˆ</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>N</mi><mo>Ã—</mo><mi>D</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">X \\in \\mathbb{R}^{N \\times D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72243em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">Ã—</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span></span></span></span></span></span></span></span></span></span></span></span>ï¼šè¾“å…¥çŸ©é˜µï¼ˆN ä¸ªæ ·æœ¬ï¼ŒD ä¸ªç‰¹å¾ï¼‰</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo>âˆˆ</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>D</mi><mo>Ã—</mo><mi>M</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">W \\in \\mathbb{R}^{D \\times M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72243em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mbin mtight\">Ã—</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span></span></span></span></span></span></span></span>ï¼šæƒé‡çŸ©é˜µ</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>âˆˆ</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>M</mi></msup></mrow><annotation encoding=\"application/x-tex\">b \\in \\mathbb{R}^{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span></span></span></span></span></span></span></span>ï¼šåç½®å‘é‡</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>out</mtext><mo>âˆˆ</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>N</mi><mo>Ã—</mo><mi>M</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\text{out} \\in \\mathbb{R}^{N \\times M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65418em;vertical-align:-0.0391em;\"></span><span class=\"mord text\"><span class=\"mord\">out</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">Ã—</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span></span></span></span></span></span></span></span>ï¼šè¾“å‡ºçŸ©é˜µ</li>\n</ul>\n<details class=\"info\"><summary>ä»¿å°„å˜æ¢çš„å‡ ä½•æ„ä¹‰</summary><div>\n<p>ä»¿å°„å˜æ¢ç»“åˆäº†çº¿æ€§å˜æ¢å’Œå¹³ç§»æ“ä½œï¼š</p>\n<ul>\n<li><strong>çº¿æ€§å˜æ¢éƒ¨åˆ†</strong> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo>â‹…</mo><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">X \\cdot W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span>ï¼šå®ç°ç©ºé—´çš„æ—‹è½¬ã€ç¼©æ”¾å’Œå‰ªåˆ‡</li>\n<li><strong>å¹³ç§»éƒ¨åˆ†</strong> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">+b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">+</span><span class=\"mord mathnormal\">b</span></span></span></span>ï¼šå°†å˜æ¢åçš„ç»“æœåœ¨å„ç»´åº¦ä¸Šè¿›è¡Œåç§»</li>\n</ul>\n<p>åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œä»¿å°„å˜æ¢è´Ÿè´£å°†è¾“å…¥ç‰¹å¾æ˜ å°„åˆ°æ–°çš„ç‰¹å¾ç©ºé—´ï¼Œä¸ºåç»­çš„éçº¿æ€§æ¿€æ´»å‡½æ•°æä¾›è¾“å…¥ã€‚æ¯ä¸€å±‚çš„ä»¿å°„å˜æ¢éƒ½åœ¨å­¦ä¹ å¦‚ä½•æœ€ä¼˜åœ°ç»„åˆè¾“å…¥ç‰¹å¾ã€‚</p>\n</div></details>\n<figure class=\"highlight python\"><figcaption><span>ä»¿å°„å˜æ¢å‰å‘ä¼ æ’­å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">affine_forward</span>(<span class=\"params\">x, w, b</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    Computes the forward pass for an affine (fully-connected) layer.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    The input x has shape (N, d_1, ..., d_k) and contains a minibatch of N</span></span><br><span class=\"line\"><span class=\"string\">    examples, where each example x[i] has shape (d_1, ..., d_k). We will</span></span><br><span class=\"line\"><span class=\"string\">    reshape each input into a vector of dimension D = d_1 * ... * d_k, and</span></span><br><span class=\"line\"><span class=\"string\">    then transform it to an output vector of dimension M.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Inputs:</span></span><br><span class=\"line\"><span class=\"string\">    - x: A numpy array containing input data, of shape (N, d_1, ..., d_k)</span></span><br><span class=\"line\"><span class=\"string\">    - w: A numpy array of weights, of shape (D, M)</span></span><br><span class=\"line\"><span class=\"string\">    - b: A numpy array of biases, of shape (M,)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Returns a tuple of:</span></span><br><span class=\"line\"><span class=\"string\">    - out: output, of shape (N, M)</span></span><br><span class=\"line\"><span class=\"string\">    - cache: (x, w, b)</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    out = <span class=\"literal\">None</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"comment\"># <span class=\"doctag\">TODO:</span> Implement the affine forward pass. Store the result in out. You   #</span></span><br><span class=\"line\">    <span class=\"comment\"># will need to reshape the input into rows.                               #</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    N = x.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">    D = np.prod(x.shape[<span class=\"number\">1</span>:])  <span class=\"comment\"># å±•å¹³è¾“å…¥ç»´åº¦</span></span><br><span class=\"line\">    x_reshaped = x.reshape(N, D)  <span class=\"comment\"># é‡å¡‘è¾“å…¥ä¸º (N, D)</span></span><br><span class=\"line\">    out = x_reshaped.dot(w) + b  <span class=\"comment\"># è®¡ç®—ä»¿å°„å˜æ¢</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"comment\">#                             END OF YOUR CODE                            #</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    cache = (x, w, b)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> out, cache</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ¢¯åº¦è®¡ç®—åŸç†\"><a class=\"anchor\" href=\"#æ¢¯åº¦è®¡ç®—åŸç†\">#</a> æ¢¯åº¦è®¡ç®—åŸç†</h2>\n<p>å‡è®¾ä¸Šæ¸¸æ¢¯åº¦æ˜¯  <code>dout</code> ï¼ˆå½¢çŠ¶  <code>(N, M)</code> ï¼‰ï¼Œéœ€è¦è®¡ç®—æŸå¤±å‡½æ•°å¯¹å„å‚æ•°çš„æ¢¯åº¦ï¼š</p>\n<ul>\n<li><code>dx</code> ï¼šæŸå¤±å¯¹è¾“å…¥ x çš„æ¢¯åº¦</li>\n<li><code>dw</code> ï¼šæŸå¤±å¯¹æƒé‡ w çš„æ¢¯åº¦</li>\n<li><code>db</code> ï¼šæŸå¤±å¯¹åç½® b çš„æ¢¯åº¦</li>\n</ul>\n<h3 id=\"å¯¹åç½®-b-çš„æ¢¯åº¦æ¨å¯¼\"><a class=\"anchor\" href=\"#å¯¹åç½®-b-çš„æ¢¯åº¦æ¨å¯¼\">#</a> å¯¹åç½® b çš„æ¢¯åº¦æ¨å¯¼</h3>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>b</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mtext>out</mtext><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mtext>dout</mtext><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L}{\\partial b_j} = \\sum_{i=1}^{N} \\frac{\\partial L}{\\partial \\text{out}_{i,j}} = \\sum_{i=1}^{N} \\text{dout}_{i,j}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106005em;vertical-align:-1.277669em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">out</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106005em;vertical-align:-1.277669em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">dout</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>ç”±äºåç½® <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> è¢«å¹¿æ’­åˆ°æ¯ä¸ªæ ·æœ¬ï¼Œæ‰€ä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">db</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">b</span></span></span></span> æ˜¯æ‰€æœ‰æ ·æœ¬æ¢¯åº¦çš„ç´¯åŠ ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db = np.<span class=\"built_in\">sum</span>(dout, axis=<span class=\"number\">0</span>)  <span class=\"comment\"># å½¢çŠ¶ï¼š(M,)</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"å¯¹æƒé‡-w-çš„æ¢¯åº¦æ¨å¯¼\"><a class=\"anchor\" href=\"#å¯¹æƒé‡-w-çš„æ¢¯åº¦æ¨å¯¼\">#</a> å¯¹æƒé‡ w çš„æ¢¯åº¦æ¨å¯¼</h3>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>w</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mtext>out</mtext><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow></mfrac><mo>â‹…</mo><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mtext>out</mtext><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>w</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mtext>dout</mtext><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>â‹…</mo><msub><mi>x</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L}{\\partial w_{k,j}} = \\sum_{i=1}^{N} \\frac{\\partial L}{\\partial \\text{out}_{i,j}} \\cdot \\frac{\\partial \\text{out}_{i,j}}{\\partial w_{k,j}} = \\sum_{i=1}^{N} \\text{dout}_{i,j} \\cdot x_{i,k}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106005em;vertical-align:-1.277669em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">out</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">out</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106005em;vertical-align:-1.277669em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">dout</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>çŸ©é˜µå½¢å¼è¡¨ç¤ºä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>W</mi></mrow></mfrac><mo>=</mo><msup><mi>X</mi><mi>T</mi></msup><mo>â‹…</mo><mtext>dout</mtext></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L}{\\partial W} = X^T \\cdot \\text{dout}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.05744em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8913309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord text\"><span class=\"mord\">dout</span></span></span></span></span></span></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dw = x_reshaped.T.dot(dout)  <span class=\"comment\"># å½¢çŠ¶ï¼š(D, M)</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"å¯¹è¾“å…¥-x-çš„æ¢¯åº¦æ¨å¯¼\"><a class=\"anchor\" href=\"#å¯¹è¾“å…¥-x-çš„æ¢¯åº¦æ¨å¯¼\">#</a> å¯¹è¾“å…¥ x çš„æ¢¯åº¦æ¨å¯¼</h3>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>x</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub></mrow></mfrac><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mtext>out</mtext><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow></mfrac><mo>â‹…</mo><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mtext>out</mtext><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>x</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub></mrow></mfrac><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><msub><mtext>dout</mtext><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>â‹…</mo><msub><mi>w</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L}{\\partial x_{i,k}} = \\sum_{j=1}^{M} \\frac{\\partial L}{\\partial \\text{out}_{i,j}} \\cdot \\frac{\\partial \\text{out}_{i,j}}{\\partial x_{i,k}} = \\sum_{j=1}^{M} \\text{dout}_{i,j} \\cdot w_{k,j}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.2421130000000007em;vertical-align:-1.4137769999999998em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">out</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">out</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.2421130000000007em;vertical-align:-1.4137769999999998em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">dout</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>çŸ©é˜µå½¢å¼è¡¨ç¤ºä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>X</mi></mrow></mfrac><mo>=</mo><mtext>dout</mtext><mo>â‹…</mo><msup><mi>W</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L}{\\partial X} = \\text{dout} \\cdot W^T\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.05744em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord text\"><span class=\"mord\">dout</span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8913309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span></span></p>\n<figure class=\"highlight python\"><figcaption><span>ä»¿å°„å˜æ¢åå‘ä¼ æ’­å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">affine_backward</span>(<span class=\"params\">dout, cache</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    Computes the backward pass for an affine layer.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Inputs:</span></span><br><span class=\"line\"><span class=\"string\">    - dout: Upstream derivative, of shape (N, M)</span></span><br><span class=\"line\"><span class=\"string\">    - cache: Tuple of:</span></span><br><span class=\"line\"><span class=\"string\">      - x: Input data, of shape (N, d_1, ... d_k)</span></span><br><span class=\"line\"><span class=\"string\">      - w: Weights, of shape (D, M)</span></span><br><span class=\"line\"><span class=\"string\">      - b: Biases, of shape (M,)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Returns a tuple of:</span></span><br><span class=\"line\"><span class=\"string\">    - dx: Gradient with respect to x, of shape (N, d1, ..., d_k)</span></span><br><span class=\"line\"><span class=\"string\">    - dw: Gradient with respect to w, of shape (D, M)</span></span><br><span class=\"line\"><span class=\"string\">    - db: Gradient with respect to b, of shape (M,)</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    x, w, b = cache</span><br><span class=\"line\">    dx, dw, db = <span class=\"literal\">None</span>, <span class=\"literal\">None</span>, <span class=\"literal\">None</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"comment\"># <span class=\"doctag\">TODO:</span> Implement the affine backward pass.                               #</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    N = x.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">    D = np.prod(x.shape[<span class=\"number\">1</span>:])  <span class=\"comment\"># å±•å¹³è¾“å…¥ç»´åº¦</span></span><br><span class=\"line\">    x_reshaped = x.reshape(N, D)  <span class=\"comment\"># é‡å¡‘è¾“å…¥ä¸º (N, D)</span></span><br><span class=\"line\">    <span class=\"comment\"># è®¡ç®—å„å‚æ•°çš„æ¢¯åº¦</span></span><br><span class=\"line\">    dx_reshaped = dout.dot(w.T)  <span class=\"comment\"># å½¢çŠ¶ (N, D)</span></span><br><span class=\"line\">    dx = dx_reshaped.reshape(x.shape)  </span><br><span class=\"line\">    dw = x_reshaped.T.dot(dout) </span><br><span class=\"line\">    db = np.<span class=\"built_in\">sum</span>(dout, axis=<span class=\"number\">0</span>) </span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"comment\">#                             END OF YOUR CODE                            #</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> dx, dw, db</span><br></pre></td></tr></table></figure>\n<h1 id=\"æ¿€æ´»å‡½æ•°ä¸æ¢¯åº¦æ¶ˆå¤±é—®é¢˜\"><a class=\"anchor\" href=\"#æ¿€æ´»å‡½æ•°ä¸æ¢¯åº¦æ¶ˆå¤±é—®é¢˜\">#</a> æ¿€æ´»å‡½æ•°ä¸æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</h1>\n<h2 id=\"reluæ¿€æ´»å‡½æ•°å®ç°\"><a class=\"anchor\" href=\"#reluæ¿€æ´»å‡½æ•°å®ç°\">#</a> ReLU æ¿€æ´»å‡½æ•°å®ç°</h2>\n<p>ReLUï¼ˆRectified Linear Unitï¼‰æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°ï¼Œå…¶æ•°å­¦å®šä¹‰ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>ReLU</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{ReLU}(x) = \\max(0, x)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">ReLU</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<figure class=\"highlight python\"><figcaption><span>ReLUå‰å‘ä¼ æ’­å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">relu_forward</span>(<span class=\"params\">x</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    Computes the forward pass for a layer of rectified linear units (ReLUs).</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Input:</span></span><br><span class=\"line\"><span class=\"string\">    - x: Inputs, of any shape</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Returns a tuple of:</span></span><br><span class=\"line\"><span class=\"string\">    - out: Output, of the same shape as x</span></span><br><span class=\"line\"><span class=\"string\">    - cache: x</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    out = <span class=\"literal\">None</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"comment\"># <span class=\"doctag\">TODO:</span> Implement the ReLU forward pass.                                  #</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    out = np.maximum(<span class=\"number\">0</span>, x)  <span class=\"comment\"># é€å…ƒç´ å–æœ€å¤§å€¼</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"comment\">#                             END OF YOUR CODE                            #</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    cache = x</span><br><span class=\"line\">    <span class=\"keyword\">return</span> out, cache</span><br></pre></td></tr></table></figure>\n<p>ReLU çš„æ¢¯åº¦å‡½æ•°ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mtext>ReLU</mtext><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.3599999999999999em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>ifÂ </mtext><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>ifÂ </mtext><mi>x</mi><mo>â‰¤</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\text{ReLU}&#x27;(x) = \\begin{cases} \n1 &amp; \\text{if } x &gt; 0 \\\\\n0 &amp; \\text{if } x \\leq 0 \n\\end{cases}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.075122em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">ReLU</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.825122em;\"><span style=\"top:-3.1362300000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">ifÂ </span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">ifÂ </span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<figure class=\"highlight python\"><figcaption><span>ReLUåå‘ä¼ æ’­å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">relu_backward</span>(<span class=\"params\">dout, cache</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    Computes the backward pass for a layer of rectified linear units (ReLUs).</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Input:</span></span><br><span class=\"line\"><span class=\"string\">    - dout: Upstream derivatives, of any shape</span></span><br><span class=\"line\"><span class=\"string\">    - cache: Input x, of same shape as dout</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Returns:</span></span><br><span class=\"line\"><span class=\"string\">    - dx: Gradient with respect to x</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    dx, x = <span class=\"literal\">None</span>, cache</span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"comment\"># <span class=\"doctag\">TODO:</span> Implement the ReLU backward pass.                                 #</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    dx = dout.copy()  </span><br><span class=\"line\">    dx[x &lt;= <span class=\"number\">0</span>] = <span class=\"number\">0</span>  <span class=\"comment\"># è´Ÿå€¼ä½ç½®æ¢¯åº¦ç½®é›¶</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"comment\">#                             END OF YOUR CODE                            #</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> dx</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ¿€æ´»å‡½æ•°çš„æ¢¯åº¦æ¶ˆå¤±åˆ†æ\"><a class=\"anchor\" href=\"#æ¿€æ´»å‡½æ•°çš„æ¢¯åº¦æ¶ˆå¤±åˆ†æ\">#</a> æ¿€æ´»å‡½æ•°çš„æ¢¯åº¦æ¶ˆå¤±åˆ†æ</h2>\n<p>ä¸åŒæ¿€æ´»å‡½æ•°åœ¨æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ä¸Šè¡¨ç°ä¸åŒï¼š</p>\n<table>\n<thead>\n<tr>\n<th>æ¿€æ´»å‡½æ•°</th>\n<th>æ¢¯åº¦æ¶ˆå¤±æƒ…å†µ</th>\n<th>åŸå› åˆ†æ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Sigmoid</strong></td>\n<td>âœ… å­˜åœ¨</td>\n<td>å‡½æ•°ä¸¤ç«¯é¥±å’ŒåŒºæ¢¯åº¦è¶‹è¿‘äº 0</td>\n</tr>\n<tr>\n<td><strong>ReLU</strong></td>\n<td>âœ… å­˜åœ¨</td>\n<td>è´ŸåŒºé—´æ¢¯åº¦æ’ä¸º 0ï¼Œå¯¼è‡´ç¥ç»å…ƒ &quot;æ­»äº¡&quot;</td>\n</tr>\n<tr>\n<td><strong>Leaky ReLU</strong></td>\n<td>âŒ ä¸å­˜åœ¨</td>\n<td>è´ŸåŒºé—´å¼•å…¥å°æ–œç‡ï¼ˆå¦‚ 0.01ï¼‰é¿å…é›¶æ¢¯åº¦</td>\n</tr>\n</tbody>\n</table>\n<details class=\"info\"><summary>Leaky ReLUçš„è®¾è®¡ä¼˜åŠ¿</summary><div>\n<p>Leaky ReLU çš„æ•°å­¦å®šä¹‰ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>LeakyÂ ReLU</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.3599999999999999em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>x</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>ifÂ </mtext><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>Î±</mi><mi>x</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>ifÂ </mtext><mi>x</mi><mo>â‰¤</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\text{Leaky ReLU}(x) = \\begin{cases} \nx &amp; \\text{if } x &gt; 0 \\\\\n\\alpha x &amp; \\text{if } x \\leq 0 \n\\end{cases}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">LeakyÂ ReLU</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span><span class=\"mord mathnormal\">x</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">ifÂ </span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">ifÂ </span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>å…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span></span></span></span> æ˜¯ä¸€ä¸ªå°çš„æ­£å€¼ï¼ˆé€šå¸¸ä¸º 0.01ï¼‰ã€‚</p>\n<p>ç›¸åº”çš„æ¢¯åº¦å‡½æ•°ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mtext>LeakyÂ ReLU</mtext><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.3599999999999999em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>ifÂ </mtext><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>Î±</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>ifÂ </mtext><mi>x</mi><mo>â‰¤</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\text{Leaky ReLU}&#x27;(x) = \\begin{cases} \n1 &amp; \\text{if } x &gt; 0 \\\\\n\\alpha &amp; \\text{if } x \\leq 0 \n\\end{cases}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0862319999999999em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">LeakyÂ ReLU</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836232em;\"><span style=\"top:-3.1473400000000002em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">ifÂ </span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">ifÂ </span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>é€šè¿‡åœ¨è´ŸåŒºé—´ä¿ç•™ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span></span></span></span> æ¢¯åº¦ï¼ŒLeaky ReLU ä»æ ¹æœ¬ä¸Šè§£å†³äº† ReLU çš„ &quot;æ­»äº¡ç¥ç»å…ƒ&quot; é—®é¢˜ï¼Œä½¿å¾—è´Ÿè¾“å…¥çš„ç¥ç»å…ƒä»èƒ½å‚ä¸æ¢¯åº¦ä¼ æ’­å’Œå‚æ•°æ›´æ–°ã€‚</p>\n</div></details>\n<div class=\"note info no-icon\">\n<p><strong>å…³é”®ç»“è®º</strong>ï¼šSigmoid çš„é¥±å’Œæ€§å’Œ ReLU çš„è´Ÿå€¼ç¡¬æˆªæ–­æ˜¯æ¢¯åº¦æ¶ˆå¤±çš„ä¸»å› ï¼›Leaky ReLU é€šè¿‡è´ŸåŒºé—´å¼•å…¥å¾®å°çº¿æ€§æ¿€æ´»è§£å†³äº†æ­¤ç¼ºé™·ã€‚</p>\n</div>\n<h1 id=\"softmaxæŸå¤±å‡½æ•°ä¸åˆ†ç±»\"><a class=\"anchor\" href=\"#softmaxæŸå¤±å‡½æ•°ä¸åˆ†ç±»\">#</a> Softmax æŸå¤±å‡½æ•°ä¸åˆ†ç±»</h1>\n<h2 id=\"softmaxæŸå¤±å‡½æ•°çš„æ•°å­¦åŸç†\"><a class=\"anchor\" href=\"#softmaxæŸå¤±å‡½æ•°çš„æ•°å­¦åŸç†\">#</a> Softmax æŸå¤±å‡½æ•°çš„æ•°å­¦åŸç†</h2>\n<p>Softmax æŸå¤±å‡½æ•°ç»“åˆäº† softmax æ¿€æ´»å’Œäº¤å‰ç†µæŸå¤±ï¼Œå¸¸ç”¨äºå¤šåˆ†ç±»é—®é¢˜ã€‚å¯¹äºè¾“å…¥åˆ†æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>âˆˆ</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>N</mi><mo>Ã—</mo><mi>C</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">x \\in \\mathbb{R}^{N \\times C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">Ã—</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œsoftmax æ¦‚ç‡è®¡ç®—ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>âˆ’</mo><munder><mo><mi>max</mi><mo>â¡</mo></mo><mi>k</mi></munder><msub><mi>x</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mrow><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mi>exp</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo>âˆ’</mo><munder><mo><mi>max</mi><mo>â¡</mo></mo><mi>k</mi></munder><msub><mi>x</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">p_{i,j} = \\frac{\\exp(x_{i,j} - \\max_k x_{i,k})}{\\sum_{k=1}^{C} \\exp(x_{i,k} - \\max_k x_{i,k})}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.597941em;vertical-align:-1.170941em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.128769em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop\"><span class=\"mop\">max</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop\"><span class=\"mop\">max</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.170941em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>äº¤å‰ç†µæŸå¤±ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>L</mi><mo>=</mo><mo>âˆ’</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>log</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L = -\\frac{1}{N} \\sum_{i=1}^{N} \\log(p_{i,y_i})\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106005em;vertical-align:-1.277669em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<figure class=\"highlight python\"><figcaption><span>SoftmaxæŸå¤±å‡½æ•°å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">softmax_loss</span>(<span class=\"params\">x, y</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    Computes the loss and gradient for softmax classification.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Inputs:</span></span><br><span class=\"line\"><span class=\"string\">    - x: Input data, of shape (N, C) where x[i, j] is the score for the jth</span></span><br><span class=\"line\"><span class=\"string\">      class for the ith input.</span></span><br><span class=\"line\"><span class=\"string\">    - y: Vector of labels, of shape (N,) where y[i] is the label for x[i] and</span></span><br><span class=\"line\"><span class=\"string\">      0 &lt;= y[i] &lt; C</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Returns a tuple of:</span></span><br><span class=\"line\"><span class=\"string\">    - loss: Scalar giving the loss</span></span><br><span class=\"line\"><span class=\"string\">    - dx: Gradient of the loss with respect to x</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    loss, dx = <span class=\"literal\">None</span>, <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"comment\"># <span class=\"doctag\">TODO:</span> Copy over your solution from A1.</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    num_train = x.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"comment\"># æ•°å€¼ç¨³å®šçš„softmaxè®¡ç®—</span></span><br><span class=\"line\">    scores = np.exp(x - np.<span class=\"built_in\">max</span>(x, axis=<span class=\"number\">1</span>, keepdims=<span class=\"literal\">True</span>))</span><br><span class=\"line\">    p = scores / np.<span class=\"built_in\">sum</span>(scores, axis=<span class=\"number\">1</span>, keepdims=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    <span class=\"comment\"># è®¡ç®—äº¤å‰ç†µæŸå¤±</span></span><br><span class=\"line\">    loss = np.<span class=\"built_in\">sum</span>(-np.log(p[np.arange(x.shape[<span class=\"number\">0</span>]), y])) </span><br><span class=\"line\">    loss /= num_train </span><br><span class=\"line\">    <span class=\"comment\"># è®¡ç®—æ¢¯åº¦</span></span><br><span class=\"line\">    p[np.arange(num_train), y] -= <span class=\"number\">1</span></span><br><span class=\"line\">    dx = p / num_train </span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"comment\">#                             END OF YOUR CODE                            #</span></span><br><span class=\"line\">    <span class=\"comment\">###########################################################################</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> loss, dx</span><br></pre></td></tr></table></figure>\n<div class=\"note warning no-icon\">\n<p>åœ¨ softmax è®¡ç®—ä¸­ï¼Œå‡å»æœ€å¤§å€¼  <code>np.max(x, axis=1, keepdims=True)</code>  æ˜¯ä¸ºäº†æ•°å€¼ç¨³å®šæ€§ï¼Œé˜²æ­¢æŒ‡æ•°è¿ç®—å¯¼è‡´çš„æº¢å‡ºé—®é¢˜ã€‚</p>\n</div>\n<h1 id=\"äºŒå±‚ç¥ç»ç½‘ç»œæ¶æ„è®¾è®¡\"><a class=\"anchor\" href=\"#äºŒå±‚ç¥ç»ç½‘ç»œæ¶æ„è®¾è®¡\">#</a> äºŒå±‚ç¥ç»ç½‘ç»œæ¶æ„è®¾è®¡</h1>\n<h2 id=\"ç½‘ç»œæ¶æ„ä¸å‚æ•°åˆå§‹åŒ–\"><a class=\"anchor\" href=\"#ç½‘ç»œæ¶æ„ä¸å‚æ•°åˆå§‹åŒ–\">#</a> ç½‘ç»œæ¶æ„ä¸å‚æ•°åˆå§‹åŒ–</h2>\n<p>äºŒå±‚ç¥ç»ç½‘ç»œçš„æ¶æ„ä¸ºï¼š<strong>è¾“å…¥å±‚ â†’ ä»¿å°„å˜æ¢ â†’ ReLU æ¿€æ´» â†’ ä»¿å°„å˜æ¢ â†’ Softmax è¾“å‡º</strong></p>\n<figure class=\"highlight python\"><figcaption><span>äºŒå±‚ç¥ç»ç½‘ç»œç±»å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">TwoLayerNet</span>(<span class=\"title class_ inherited__\">object</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    A two-layer fully-connected neural network with ReLU nonlinearity and</span></span><br><span class=\"line\"><span class=\"string\">    softmax loss that uses a modular layer design. We assume an input dimension</span></span><br><span class=\"line\"><span class=\"string\">    of D, a hidden dimension of H, and perform classification over C classes.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    The architecure should be affine - relu - affine - softmax.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Note that this class does not implement gradient descent; instead, it</span></span><br><span class=\"line\"><span class=\"string\">    will interact with a separate Solver object that is responsible for running</span></span><br><span class=\"line\"><span class=\"string\">    optimization.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    The learnable parameters of the model are stored in the dictionary</span></span><br><span class=\"line\"><span class=\"string\">    self.params that maps parameter names to numpy arrays.</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\">        self,</span></span><br><span class=\"line\"><span class=\"params\">        input_dim=<span class=\"number\">3</span> * <span class=\"number\">32</span> * <span class=\"number\">32</span>,</span></span><br><span class=\"line\"><span class=\"params\">        hidden_dim=<span class=\"number\">100</span>,</span></span><br><span class=\"line\"><span class=\"params\">        num_classes=<span class=\"number\">10</span>,</span></span><br><span class=\"line\"><span class=\"params\">        weight_scale=<span class=\"number\">1e-3</span>,</span></span><br><span class=\"line\"><span class=\"params\">        reg=<span class=\"number\">0.0</span>,</span></span><br><span class=\"line\"><span class=\"params\">    </span>):</span><br><span class=\"line\">        <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">        Initialize a new network.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">        Inputs:</span></span><br><span class=\"line\"><span class=\"string\">        - input_dim: An integer giving the size of the input</span></span><br><span class=\"line\"><span class=\"string\">        - hidden_dim: An integer giving the size of the hidden layer</span></span><br><span class=\"line\"><span class=\"string\">        - num_classes: An integer giving the number of classes to classify</span></span><br><span class=\"line\"><span class=\"string\">        - weight_scale: Scalar giving the standard deviation for random</span></span><br><span class=\"line\"><span class=\"string\">          initialization of the weights.</span></span><br><span class=\"line\"><span class=\"string\">        - reg: Scalar giving L2 regularization strength.</span></span><br><span class=\"line\"><span class=\"string\">        &quot;&quot;&quot;</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.params = &#123;&#125;</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.reg = reg</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">############################################################################</span></span><br><span class=\"line\">        <span class=\"comment\"># <span class=\"doctag\">TODO:</span> Initialize the weights and biases of the two-layer net. Weights    #</span></span><br><span class=\"line\">        <span class=\"comment\"># should be initialized from a Gaussian centered at 0.0 with               #</span></span><br><span class=\"line\">        <span class=\"comment\"># standard deviation equal to weight_scale, and biases should be           #</span></span><br><span class=\"line\">        <span class=\"comment\"># initialized to zero. All weights and biases should be stored in the      #</span></span><br><span class=\"line\">        <span class=\"comment\"># dictionary self.params, with first layer weights                         #</span></span><br><span class=\"line\">        <span class=\"comment\"># and biases using the keys &#x27;W1&#x27; and &#x27;b1&#x27; and second layer                 #</span></span><br><span class=\"line\">        <span class=\"comment\"># weights and biases using the keys &#x27;W2&#x27; and &#x27;b2&#x27;.                         #</span></span><br><span class=\"line\">        <span class=\"comment\">############################################################################</span></span><br><span class=\"line\">        <span class=\"comment\"># ç¬¬ä¸€å±‚å‚æ•°åˆå§‹åŒ–</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;W1&#x27;</span>] = np.random.normal(<span class=\"number\">0</span>, weight_scale, (input_dim, hidden_dim))</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;b1&#x27;</span>] = np.zeros(hidden_dim)</span><br><span class=\"line\">        <span class=\"comment\"># ç¬¬äºŒå±‚å‚æ•°åˆå§‹åŒ–</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;W2&#x27;</span>] = np.random.normal(<span class=\"number\">0</span>, weight_scale, (hidden_dim, num_classes))</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;b2&#x27;</span>] = np.zeros(num_classes)</span><br><span class=\"line\">        <span class=\"comment\">############################################################################</span></span><br><span class=\"line\">        <span class=\"comment\">#                             END OF YOUR CODE                             #</span></span><br><span class=\"line\">        <span class=\"comment\">############################################################################</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­çš„å®Œæ•´å®ç°\"><a class=\"anchor\" href=\"#å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­çš„å®Œæ•´å®ç°\">#</a> å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­çš„å®Œæ•´å®ç°</h2>\n<figure class=\"highlight python\"><figcaption><span>æŸå¤±å‡½æ•°ä¸æ¢¯åº¦è®¡ç®—</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">loss</span>(<span class=\"params\">self, X, y=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    Compute loss and gradient for a minibatch of data.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Inputs:</span></span><br><span class=\"line\"><span class=\"string\">    - X: Array of input data of shape (N, d_1, ..., d_k)</span></span><br><span class=\"line\"><span class=\"string\">    - y: Array of labels, of shape (N,). y[i] gives the label for X[i].</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Returns:</span></span><br><span class=\"line\"><span class=\"string\">    If y is None, then run a test-time forward pass of the model and return:</span></span><br><span class=\"line\"><span class=\"string\">    - scores: Array of shape (N, C) giving classification scores, where</span></span><br><span class=\"line\"><span class=\"string\">      scores[i, c] is the classification score for X[i] and class c.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    If y is not None, then run a training-time forward and backward pass and</span></span><br><span class=\"line\"><span class=\"string\">    return a tuple of:</span></span><br><span class=\"line\"><span class=\"string\">    - loss: Scalar value giving the loss</span></span><br><span class=\"line\"><span class=\"string\">    - grads: Dictionary with the same keys as self.params, mapping parameter</span></span><br><span class=\"line\"><span class=\"string\">      names to gradients of the loss with respect to those parameters.</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    scores = <span class=\"literal\">None</span></span><br><span class=\"line\">    <span class=\"comment\">############################################################################</span></span><br><span class=\"line\">    <span class=\"comment\"># <span class=\"doctag\">TODO:</span> Implement the forward pass for the two-layer net, computing the    #</span></span><br><span class=\"line\">    <span class=\"comment\"># class scores for X and storing them in the scores variable.              #</span></span><br><span class=\"line\">    <span class=\"comment\">############################################################################</span></span><br><span class=\"line\">    <span class=\"comment\"># ç¬¬ä¸€å±‚å‰å‘ä¼ æ’­ï¼šä»¿å°„å˜æ¢ + ReLUæ¿€æ´»</span></span><br><span class=\"line\">    out1, cache1 = affine_relu_forward(X, <span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;W1&#x27;</span>], <span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;b1&#x27;</span>])</span><br><span class=\"line\">    <span class=\"comment\"># ç¬¬äºŒå±‚å‰å‘ä¼ æ’­ï¼šä»¿å°„å˜æ¢</span></span><br><span class=\"line\">    out2, cache2 = affine_forward(out1, <span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;W2&#x27;</span>], <span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;b2&#x27;</span>])</span><br><span class=\"line\">    <span class=\"comment\"># å¾—åˆ°åˆ†ç±»åˆ†æ•°</span></span><br><span class=\"line\">    scores = out2  </span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">############################################################################</span></span><br><span class=\"line\">    <span class=\"comment\">#                             END OF YOUR CODE                             #</span></span><br><span class=\"line\">    <span class=\"comment\">############################################################################</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># æµ‹è¯•æ¨¡å¼ç›´æ¥è¿”å›åˆ†æ•°</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> y <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> scores</span><br><span class=\"line\"></span><br><span class=\"line\">    loss, grads = <span class=\"number\">0</span>, &#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">############################################################################</span></span><br><span class=\"line\">    <span class=\"comment\"># <span class=\"doctag\">TODO:</span> Implement the backward pass for the two-layer net. Store the loss  #</span></span><br><span class=\"line\">    <span class=\"comment\"># in the loss variable and gradients in the grads dictionary. Compute data #</span></span><br><span class=\"line\">    <span class=\"comment\"># loss using softmax, and make sure that grads[k] holds the gradients for  #</span></span><br><span class=\"line\">    <span class=\"comment\"># self.params[k]. Don&#x27;t forget to add L2 regularization!                   #</span></span><br><span class=\"line\">    <span class=\"comment\">#                                                                          #</span></span><br><span class=\"line\">    <span class=\"comment\"># <span class=\"doctag\">NOTE:</span> To ensure that your implementation matches ours and you pass the   #</span></span><br><span class=\"line\">    <span class=\"comment\"># automated tests, make sure that your L2 regularization includes a factor #</span></span><br><span class=\"line\">    <span class=\"comment\"># of 0.5 to simplify the expression for the gradient.                      #</span></span><br><span class=\"line\">    <span class=\"comment\">############################################################################</span></span><br><span class=\"line\">    <span class=\"comment\"># è®¡ç®—softmaxæŸå¤±</span></span><br><span class=\"line\">    loss, dx = softmax_loss(scores, y)</span><br><span class=\"line\">    <span class=\"comment\"># æ·»åŠ L2æ­£åˆ™åŒ–æŸå¤±</span></span><br><span class=\"line\">    loss += <span class=\"number\">0.5</span> * <span class=\"variable language_\">self</span>.reg * (np.<span class=\"built_in\">sum</span>(<span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;W1&#x27;</span>] ** <span class=\"number\">2</span>) + np.<span class=\"built_in\">sum</span>(<span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;W2&#x27;</span>] ** <span class=\"number\">2</span>))</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># ç¬¬äºŒå±‚åå‘ä¼ æ’­</span></span><br><span class=\"line\">    dx2, grads[<span class=\"string\">&#x27;W2&#x27;</span>], grads[<span class=\"string\">&#x27;b2&#x27;</span>] = affine_backward(dx, cache2)</span><br><span class=\"line\">    <span class=\"comment\"># ç¬¬ä¸€å±‚åå‘ä¼ æ’­</span></span><br><span class=\"line\">    dx1, grads[<span class=\"string\">&#x27;W1&#x27;</span>], grads[<span class=\"string\">&#x27;b1&#x27;</span>] = affine_relu_backward(dx2, cache1)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># æ·»åŠ L2æ­£åˆ™åŒ–æ¢¯åº¦</span></span><br><span class=\"line\">    grads[<span class=\"string\">&#x27;W2&#x27;</span>] += <span class=\"variable language_\">self</span>.reg * <span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;W2&#x27;</span>]</span><br><span class=\"line\">    grads[<span class=\"string\">&#x27;W1&#x27;</span>] += <span class=\"variable language_\">self</span>.reg * <span class=\"variable language_\">self</span>.params[<span class=\"string\">&#x27;W1&#x27;</span>]</span><br><span class=\"line\">    <span class=\"comment\">############################################################################</span></span><br><span class=\"line\">    <span class=\"comment\">#                             END OF YOUR CODE                             #</span></span><br><span class=\"line\">    <span class=\"comment\">############################################################################</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> loss, grads</span><br></pre></td></tr></table></figure>\n<h1 id=\"è¿‡æ‹Ÿåˆé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ\"><a class=\"anchor\" href=\"#è¿‡æ‹Ÿåˆé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ\">#</a> è¿‡æ‹Ÿåˆé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h1>\n<p>å½“æµ‹è¯•å‡†ç¡®ç‡è¿œä½äºè®­ç»ƒå‡†ç¡®ç‡æ—¶ï¼Œè¡¨æ˜æ¨¡å‹å‡ºç°è¿‡æ‹Ÿåˆã€‚ä»¥ä¸‹æ˜¯å‡å°è®­ç»ƒ - æµ‹è¯•å·®è·çš„æœ‰æ•ˆæ–¹æ³•ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>æ–¹æ³•</th>\n<th>æœ‰æ•ˆæ€§</th>\n<th>åŸç†åˆ†æ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>ä½¿ç”¨æ›´å¤§çš„æ•°æ®é›†è®­ç»ƒ</strong></td>\n<td>âœ…</td>\n<td>æ‰©å¤§æ•°æ®é›†èƒ½æä¾›æ›´å¤šæ ·åŒ–çš„æ ·æœ¬ï¼Œé™ä½æ¨¡å‹å¯¹è®­ç»ƒé›†ç‰¹å®šå™ªå£°çš„è¿‡æ‹Ÿåˆï¼Œæå‡æ³›åŒ–èƒ½åŠ›</td>\n</tr>\n<tr>\n<td><strong>å¢åŠ éšè—å•å…ƒæ•°é‡</strong></td>\n<td>âŒ</td>\n<td>å¢åŠ ç½‘ç»œå¤æ‚åº¦ï¼ˆæ›´å¤šå‚æ•°ï¼‰ä¼šåŠ å‰§è¿‡æ‹Ÿåˆï¼Œä½¿è®­ç»ƒå‡†ç¡®ç‡æ›´é«˜ä½†æµ‹è¯•å·®è·æ›´å¤§</td>\n</tr>\n<tr>\n<td><strong>å¢å¼ºæ­£åˆ™åŒ–å¼ºåº¦</strong></td>\n<td>âœ…</td>\n<td>æ›´å¼ºçš„æ­£åˆ™åŒ–ï¼ˆå¦‚å¢å¤§ L2 æƒé‡è¡°å‡ / Dropout æ¯”ä¾‹ï¼‰èƒ½æŠ‘åˆ¶è¿‡æ‹Ÿåˆï¼Œå¼ºåˆ¶æ¨¡å‹å­¦ä¹ æ›´é²æ£’çš„ç‰¹å¾</td>\n</tr>\n</tbody>\n</table>\n<div class=\"note success no-icon\">\n<p><strong>å®è·µå»ºè®®</strong>ï¼šä¼˜å…ˆè€ƒè™‘æ•°æ®å¢å¼ºå’Œæ­£åˆ™åŒ–æŠ€æœ¯ï¼Œé¿å…ç›²ç›®å¢åŠ æ¨¡å‹å¤æ‚åº¦ã€‚</p>\n</div>\n",
            "tags": [
                "å­¦ä¹ ç¬”è®°",
                "æœºå™¨å­¦ä¹ ",
                "ä»£ç å®ç°",
                "cs231n",
                "assignment1",
                "ç¥ç»ç½‘ç»œ",
                "æ¢¯åº¦ä¸‹é™",
                "æ·±åº¦å­¦ä¹ ",
                "softmax",
                "ReLU",
                "cs231n",
                "åå‘ä¼ æ’­",
                "ä»¿å°„å˜æ¢",
                "Leaky ReLU"
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2210-%E7%BB%9F%E8%AE%A1%E6%95%B0%E7%BB%84%E4%B8%AD%E5%B3%B0%E5%92%8C%E8%B0%B7%E7%9A%84%E6%95%B0%E9%87%8F/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2210-%E7%BB%9F%E8%AE%A1%E6%95%B0%E7%BB%84%E4%B8%AD%E5%B3%B0%E5%92%8C%E8%B0%B7%E7%9A%84%E6%95%B0%E9%87%8F/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š2210. ç»Ÿè®¡æ•°ç»„ä¸­å³°å’Œè°·çš„æ•°é‡",
            "date_published": "2025-07-27T03:43:00.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9jb3VudC1oaWxscy1hbmQtdmFsbGV5cy1pbi1hbi1hcnJheT9lbnZUeXBlPWRhaWx5LXF1ZXN0aW9uJmFtcDtlbnZJZD0yMDI1LTA3LTI3\">LeetCode 2210</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä»  <code>0</code>  å¼€å§‹çš„æ•´æ•°æ•°ç»„  <code>nums</code>  ã€‚å¦‚æœä¸¤ä¾§è·  <code>i</code>  æœ€è¿‘çš„ä¸ç›¸ç­‰é‚»å±…çš„å€¼å‡å°äº  <code>nums[i]</code>  ï¼Œåˆ™ä¸‹æ ‡  <code>i</code>  æ˜¯ nums ä¸­ï¼ŒæŸä¸ªå³°çš„ä¸€éƒ¨åˆ†ã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœä¸¤ä¾§è·  <code>i</code>  æœ€è¿‘çš„ä¸ç›¸ç­‰é‚»å±…çš„å€¼å‡å¤§äº  <code>nums[i]</code>  ï¼Œåˆ™ä¸‹æ ‡  <code>i</code>  æ˜¯ nums ä¸­æŸä¸ªè°·çš„ä¸€éƒ¨åˆ†ã€‚å¯¹äºç›¸é‚»ä¸‹æ ‡  <code>i</code>  å’Œ  <code>j</code>  ï¼Œå¦‚æœ  <code>nums[i] == nums[j]</code>  ï¼Œ åˆ™è®¤ä¸ºè¿™ä¸¤ä¸‹æ ‡å±äº åŒä¸€ä¸ª å³°æˆ–è°·ã€‚</p>\n<p>æ³¨æ„ï¼Œè¦ä½¿æŸä¸ªä¸‹æ ‡æ‰€åšå³°æˆ–è°·çš„ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå®ƒå·¦å³ä¸¤ä¾§å¿…é¡» éƒ½ å­˜åœ¨ä¸ç›¸ç­‰é‚»å±…ã€‚</p>\n<p>è¿”å›  <code>nums</code>  ä¸­å³°å’Œè°·çš„æ•°é‡ã€‚</p>\n<div class=\"note info no-icon\">\n<ul>\n<li>3 &lt;= nums.length &lt;= 100</li>\n<li>1 &lt;= nums[i] &lt;= 100</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<p>é€šè¿‡éå†æ•°ç»„ï¼Œè®°å½•ä¸Šä¸€ä¸ªä¸åŒçš„å…ƒç´ å’Œå½“å‰å…ƒç´ çš„å…³ç³»ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºå³°æˆ–è°·ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰å½“å½“å‰å…ƒç´ ä¸å‰åå…ƒç´ éƒ½ä¸ç›¸ç­‰æ—¶ï¼Œæ‰å¯èƒ½æ˜¯å³°æˆ–è°·ã€‚</p>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">countHillValley</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n = nums.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"number\">0</span>, i = <span class=\"number\">1</span>, ls = nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (nums[i] == nums[i<span class=\"number\">-1</span>]) i++;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (i &lt; n - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> cur = nums[i];</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (i &lt; n - <span class=\"number\">1</span> &amp;&amp; nums[i] == nums[i<span class=\"number\">+1</span>]) i++;</span><br><span class=\"line\">            i++;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i &lt; n) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((ls &gt; cur &amp;&amp; cur &lt; nums[i]) || (ls &lt; cur &amp;&amp; cur &gt; nums[i])) ans++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            ls = cur;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "æ•°ç»„"
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A3480-%E5%88%A0%E9%99%A4%E4%B8%80%E4%B8%AA%E5%86%B2%E7%AA%81%E5%AF%B9%E5%90%8E%E6%9C%80%E5%A4%A7%E5%AD%90%E6%95%B0%E7%BB%84%E6%95%B0%E7%9B%AE/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A3480-%E5%88%A0%E9%99%A4%E4%B8%80%E4%B8%AA%E5%86%B2%E7%AA%81%E5%AF%B9%E5%90%8E%E6%9C%80%E5%A4%A7%E5%AD%90%E6%95%B0%E7%BB%84%E6%95%B0%E7%9B%AE/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š3480. åˆ é™¤ä¸€ä¸ªå†²çªå¯¹åæœ€å¤§å­æ•°ç»„æ•°ç›®",
            "date_published": "2025-07-26T07:12:36.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9tYXhpbWl6ZS1zdWJhcnJheXMtYWZ0ZXItcmVtb3Zpbmctb25lLWNvbmZsaWN0aW5nLXBhaXI/ZW52VHlwZT1kYWlseS1xdWVzdGlvbiZhbXA7ZW52SWQ9MjAyNS0wNy0yNg==\">LeetCode 3480</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°  <code>n</code> ï¼Œè¡¨ç¤ºä¸€ä¸ªåŒ…å«ä»  <code>1</code>  åˆ°  <code>n</code>  æŒ‰é¡ºåºæ’åˆ—çš„æ•´æ•°æ•°ç»„  <code>nums</code> ã€‚æ­¤å¤–ï¼Œç»™ä½ ä¸€ä¸ªäºŒç»´æ•°ç»„  <code>conflictingPairs</code> ï¼Œå…¶ä¸­  <code>conflictingPairs[i] = [a, b]</code>  è¡¨ç¤º  <code>a</code>  å’Œ  <code>b</code>  å½¢æˆä¸€ä¸ªå†²çªå¯¹ã€‚</p>\n<p>ä»  <code>conflictingPairs</code>  ä¸­åˆ é™¤æ°å¥½ä¸€ä¸ªå…ƒç´ ã€‚ç„¶åï¼Œè®¡ç®—æ•°ç»„  <code>nums</code>  ä¸­çš„éç©ºå­æ•°ç»„æ•°é‡ï¼Œè¿™äº›å­æ•°ç»„éƒ½ä¸èƒ½åŒæ—¶åŒ…å«ä»»ä½•å‰©ä½™å†²çªå¯¹  <code>[a, b]</code>  ä¸­çš„  <code>a</code>  å’Œ  <code>b</code> ã€‚</p>\n<p>è¿”å›åˆ é™¤æ°å¥½ä¸€ä¸ªå†²çªå¯¹åå¯èƒ½å¾—åˆ°çš„æœ€å¤§å­æ•°ç»„æ•°é‡ã€‚</p>\n<p>å­æ•°ç»„ æ˜¯æ•°ç»„ä¸­ä¸€ä¸ªè¿ç»­çš„ éç©º å…ƒç´ åºåˆ—ã€‚</p>\n<div class=\"note info no-icon\">\n<ul>\n<li>2 &lt;= n &lt;= 10^5</li>\n<li>1 &lt;= conflictingPairs.length &lt;= 2 * n</li>\n<li>conflictingPairs[i].length == 2</li>\n<li>1 &lt;= conflictingPairs[i][j] &lt;= n</li>\n<li>conflictingPairs[i][0] != conflictingPairs[i][1]</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<div class=\"note info\">\n<p>å‚è€ƒé¢˜è§£<span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9tYXhpbWl6ZS1zdWJhcnJheXMtYWZ0ZXItcmVtb3Zpbmctb25lLWNvbmZsaWN0aW5nLXBhaXIvc29sdXRpb25zLzM2MDMwNDcvbWVpLWp1LXp1by1kdWFuLWRpYW4td2VpLWh1LXp1aS14aWFvLWNpLTRudnU2\">æšä¸¾å·¦ç«¯ç‚¹ï¼Œç»´æŠ¤æœ€å°æ¬¡å° bï¼ˆPython/Java/C++/Goï¼‰</span></p>\n</div>\n<p>å¯¹äºè¿™é“é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè®¡ç®—åœ¨ä¸åˆ é™¤ä»»ä½•å†²çªå¯¹çš„æƒ…å†µä¸‹ï¼Œ <code>nums</code>  æ•°ç»„ä¸­æœ‰å¤šå°‘ä¸ªå­æ•°ç»„æ»¡è¶³æ¡ä»¶ã€‚<br />\næˆ‘çš„æ€è·¯æ˜¯ä»¥  <code>i</code>  ä¸ºç»“å°¾çš„å­æ•°ç»„æ•°é‡ä¸º  <code>i - a0</code> ï¼Œå…¶ä¸­  <code>a0</code>  æ˜¯å½“å‰  <code>i</code>  ä¹‹å‰çš„æœ€å¤§å†²çªå¯¹çš„å·¦ç«¯ç‚¹ã€‚<br />\nå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾æ¯ä¸ª  <code>i</code> ï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ªå˜é‡  <code>a0</code>  æ¥è®°å½•å½“å‰çš„æœ€å¤§å†²çªå¯¹çš„å·¦ç«¯ç‚¹ã€‚<br />\nå¦‚æœåˆ é™¤ä¸€ä¸ªå†²çªå¯¹æ˜¯æœ‰æ•ˆçš„ï¼Œé‚£ä¹ˆå°±ä»£è¡¨åˆ é™¤çš„æ˜¯å½“å‰  <code>i</code>  ä¹‹å‰çš„æœ€å¤§å†²çªå¯¹çš„å·¦ç«¯ç‚¹ã€‚<br />\nå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æšä¸¾æ—¶ï¼Œç»´æŠ¤ä¸€ä¸ªå˜é‡  <code>a1</code>  æ¥è®°å½•å½“å‰çš„æ¬¡å¤§å†²çªå¯¹çš„å·¦ç«¯ç‚¹ã€‚<br />\nè¿™æ ·å°±å¯ä»¥è®¡ç®—å¯¹äºæ¯ä¸€ä¸ªå½“å‰æœ€å¤§å€¼  <code>a0</code>  åœ¨æ‰€æœ‰ä½ç½®çš„è´¡çŒ®ã€‚<br />\nä¹Ÿå°±æ˜¯  <code>a0 - a1</code> ã€‚<br />\nå†™æ³• 1ï¼šæŒ‰å³ç«¯ç‚¹ä¼˜å…ˆæ’åº<br />\nå†™æ³• 2ï¼šå‚¨å­˜å†²çªå¯¹æ¯ä¸ªå³ç«¯ç‚¹çš„æœ€å¤§å’Œæ¬¡å¤§å·¦ç«¯ç‚¹</p>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•1</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">long</span> <span class=\"type\">long</span> <span class=\"title\">maxSubarrays</span><span class=\"params\">(<span class=\"type\">int</span> n, vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt;&amp; conflictingPairs)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp; x:conflictingPairs)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x[<span class=\"number\">0</span>] &gt; x[<span class=\"number\">1</span>]) <span class=\"built_in\">swap</span>(x[<span class=\"number\">0</span>],x[<span class=\"number\">1</span>]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ranges::<span class=\"built_in\">sort</span>(conflictingPairs,[](<span class=\"type\">const</span> vector&lt;<span class=\"type\">int</span>&gt; a, <span class=\"type\">const</span> vector&lt;<span class=\"type\">int</span>&gt; b)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (a[<span class=\"number\">1</span>] == b[<span class=\"number\">1</span>]) <span class=\"keyword\">return</span> a[<span class=\"number\">0</span>] &gt; b[<span class=\"number\">0</span>];</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> a[<span class=\"number\">1</span>] &lt; b[<span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"type\">int</span> m = conflictingPairs.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">extra</span><span class=\"params\">(n<span class=\"number\">+1</span>,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"type\">long</span> ans = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> a1 = <span class=\"number\">0</span>, a0 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>, j = <span class=\"number\">0</span>; i &lt;= n; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (j &lt; m &amp;&amp; conflictingPairs[j][<span class=\"number\">1</span>] == i)&#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> tmp = conflictingPairs[j][<span class=\"number\">0</span>];</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (tmp &gt; a0) &#123;</span><br><span class=\"line\">                    a1 = a0, a0 = tmp;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tmp &gt; a1) &#123;</span><br><span class=\"line\">                    a1 = tmp;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                j++;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (j &lt; m &amp;&amp; conflictingPairs[j][<span class=\"number\">1</span>] == i) a1 = <span class=\"built_in\">max</span>(a1, conflictingPairs[j++][<span class=\"number\">0</span>]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            ans += (i - a0);</span><br><span class=\"line\">            extra[a0] += (a0-a1);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans + ranges::<span class=\"built_in\">max</span>(extra);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•2</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">long</span> <span class=\"type\">long</span> <span class=\"title\">maxSubarrays</span><span class=\"params\">(<span class=\"type\">int</span> n, vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt;&amp; conflictingPairs)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> m = conflictingPairs.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        vector&lt;array&lt;<span class=\"type\">int</span>,2&gt;&gt; <span class=\"built_in\">g</span>(n<span class=\"number\">+1</span>, &#123;<span class=\"number\">0</span>,<span class=\"number\">0</span>&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; m; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> a = conflictingPairs[i][<span class=\"number\">0</span>], b = conflictingPairs[i][<span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (a &gt; b) <span class=\"built_in\">swap</span>(a,b);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (a &gt; g[b][<span class=\"number\">0</span>]) &#123;</span><br><span class=\"line\">                g[b][<span class=\"number\">1</span>] = g[b][<span class=\"number\">0</span>];</span><br><span class=\"line\">                g[b][<span class=\"number\">0</span>] = a;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (a &gt; g[b][<span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                g[b][<span class=\"number\">1</span>] = a;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">long</span> <span class=\"type\">long</span>&gt; <span class=\"title\">extra</span><span class=\"params\">(n<span class=\"number\">+1</span>,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"type\">long</span> ans = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> a1 = <span class=\"number\">0</span>, a0 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>, j = <span class=\"number\">0</span>; i &lt;= n; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;a:g[i])&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (a &gt; a0) &#123;</span><br><span class=\"line\">                    a1 = a0;</span><br><span class=\"line\">                    a0 = a;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (a &gt; a1) &#123;</span><br><span class=\"line\">                    a1 = a;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            ans += (i - a0);</span><br><span class=\"line\">            extra[a0] += (a0-a1);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans + ranges::<span class=\"built_in\">max</span>(extra);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<hr />\n<h2 id=\"å¤æ‚åº¦åˆ†æ\"><a class=\"anchor\" href=\"#å¤æ‚åº¦åˆ†æ\">#</a> ğŸ“ˆ å¤æ‚åº¦åˆ†æ</h2>\n<hr />\n<h2 id=\"é¢˜è§£æ€»ç»“\"><a class=\"anchor\" href=\"#é¢˜è§£æ€»ç»“\">#</a> ğŸ“ é¢˜è§£æ€»ç»“</h2>\n<ul>\n<li>æœ¬é¢˜æ ¸å¿ƒåœ¨äº XX æ€è·¯</li>\n<li>å¦‚æœæ•°æ®é‡æ›´å¤§ï¼Œè€ƒè™‘ä¼˜åŒ–æˆ XXX ç®—æ³•</li>\n<li>å¯å°è¯•æ‰©å±•ç‰ˆæœ¬ï¼Œå¦‚ï¼šå­—ç¬¦ä¸²ä¸­åŒ…å« k ä¸ªä¸åŒå­—ç¬¦çš„æœ€é•¿å­ä¸²ç­‰</li>\n</ul>\n<hr />\n",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "æšä¸¾"
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A3487-%E5%88%A0%E9%99%A4%E5%90%8E%E7%9A%84%E6%9C%80%E5%A4%A7%E5%AD%90%E6%95%B0%E7%BB%84%E5%85%83%E7%B4%A0%E5%92%8C/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A3487-%E5%88%A0%E9%99%A4%E5%90%8E%E7%9A%84%E6%9C%80%E5%A4%A7%E5%AD%90%E6%95%B0%E7%BB%84%E5%85%83%E7%B4%A0%E5%92%8C/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š3487. åˆ é™¤åçš„æœ€å¤§å­æ•°ç»„å…ƒç´ å’Œ",
            "date_published": "2025-07-25T05:38:47.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9tYXhpbXVtLXVuaXF1ZS1zdWJhcnJheS1zdW0tYWZ0ZXItZGVsZXRpb24/ZW52VHlwZT1kYWlseS1xdWVzdGlvbiZhbXA7ZW52SWQ9MjAyNS0wNy0yNQ==\">LeetCode 3487</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„  <code>nums</code>  ã€‚</p>\n<p>ä½ å¯ä»¥ä»æ•°ç»„  <code>nums</code>  ä¸­åˆ é™¤ä»»æ„æ•°é‡çš„å…ƒç´ ï¼Œä½†ä¸èƒ½å°†å…¶å˜ä¸º ç©º æ•°ç»„ã€‚æ‰§è¡Œåˆ é™¤æ“ä½œåï¼Œé€‰å‡º  <code>nums</code>  ä¸­æ»¡è¶³ä¸‹è¿°æ¡ä»¶çš„ä¸€ä¸ªå­æ•°ç»„ï¼š</p>\n<ul>\n<li>å­æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´  äº’ä¸ç›¸åŒ ã€‚</li>\n<li>æœ€å¤§åŒ– å­æ•°ç»„çš„å…ƒç´ å’Œã€‚</li>\n</ul>\n<p>è¿”å›å­æ•°ç»„çš„ æœ€å¤§å…ƒç´ å’Œ ã€‚<br />\nå­æ•°ç»„ æ˜¯æ•°ç»„çš„ä¸€ä¸ªè¿ç»­ã€éç©º çš„å…ƒç´ åºåˆ—ã€‚</p>\n<div class=\"note info no-icon\">\n<ul>\n<li>1 &lt;= nums.length &lt;= 100</li>\n<li>-100 &lt;= nums[i] &lt;= 100</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<p>å¯ä»¥åˆ é™¤ä»»æ„æ•°é‡çš„å…ƒç´ ï¼Œå› æ­¤ç›´æ¥ä¿ç•™æˆ‘ä»¬éœ€è¦çš„å…ƒç´ å³å¯ã€‚<br />\nå¦‚æœæ•°ç»„å…¨ä¸ºè´Ÿæ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥è¿”å›æœ€å¤§å€¼ã€‚<br />\nå¦‚æœæ•°ç»„ä¸­æœ‰æ­£æ•°ï¼Œé‚£æˆ‘ä»¬å°±ä¿ç•™æ‰€æœ‰æ­£æ•°ï¼Œå¹¶è®¡ç®—å®ƒä»¬çš„å’Œï¼ŒåŒæ—¶æ³¨æ„å»é‡ã€‚</p>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">maxSum</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> mx = ranges::<span class=\"built_in\">max</span>(nums);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (mx &lt;= <span class=\"number\">0</span>) <span class=\"keyword\">return</span> mx;</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">bool</span>&gt; <span class=\"title\">vis</span><span class=\"params\">(<span class=\"number\">201</span>,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> n:nums)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (n &gt; <span class=\"number\">0</span> &amp;&amp; !vis[<span class=\"number\">100</span>+n]) ans += n;</span><br><span class=\"line\">            vis[<span class=\"number\">100</span>+n] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "è´ªå¿ƒ",
                "æ•°ç»„"
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2322-%E4%BB%8E%E6%A0%91%E4%B8%AD%E5%88%A0%E9%99%A4%E8%BE%B9%E7%9A%84%E6%9C%80%E5%B0%8F%E5%88%86%E6%95%B0/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A2322-%E4%BB%8E%E6%A0%91%E4%B8%AD%E5%88%A0%E9%99%A4%E8%BE%B9%E7%9A%84%E6%9C%80%E5%B0%8F%E5%88%86%E6%95%B0/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š2322. ä»æ ‘ä¸­åˆ é™¤è¾¹çš„æœ€å°åˆ†æ•°",
            "date_published": "2025-07-25T05:35:16.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9taW5pbXVtLXNjb3JlLWFmdGVyLXJlbW92YWxzLW9uLWEtdHJlZT9lbnZUeXBlPWRhaWx5LXF1ZXN0aW9uJmFtcDtlbnZJZD0yMDI1LTA3LTI0\">LeetCode 2322</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>å­˜åœ¨ä¸€æ£µæ— å‘è¿é€šæ ‘ï¼Œæ ‘ä¸­æœ‰ç¼–å·ä»  <code>0</code>  åˆ°  <code>n - 1</code>  çš„  <code>n</code>  ä¸ªèŠ‚ç‚¹ï¼Œ ä»¥åŠ  <code>n - 1</code>  æ¡è¾¹ã€‚</p>\n<p>ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä»  <code>0</code>  å¼€å§‹çš„æ•´æ•°æ•°ç»„  <code>nums</code>  ï¼Œé•¿åº¦ä¸º  <code>n</code>  ï¼Œå…¶ä¸­  <code>nums[i]</code>  è¡¨ç¤ºç¬¬  <code>i</code>  ä¸ªèŠ‚ç‚¹çš„å€¼ã€‚å¦ç»™ä½ ä¸€ä¸ªäºŒç»´æ•´æ•°æ•°ç»„  <code>edges</code>  ï¼Œé•¿åº¦ä¸º  <code>n - 1</code>  ï¼Œå…¶ä¸­  <code>edges[i] = [ai, bi]</code>  è¡¨ç¤ºæ ‘ä¸­å­˜åœ¨ä¸€æ¡ä½äºèŠ‚ç‚¹  <code>ai</code>  å’Œ  <code>bi</code>  ä¹‹é—´çš„è¾¹ã€‚</p>\n<p>åˆ é™¤æ ‘ä¸­ä¸¤æ¡ ä¸åŒ çš„è¾¹ä»¥å½¢æˆä¸‰ä¸ªè¿é€šç»„ä»¶ã€‚å¯¹äºä¸€ç§åˆ é™¤è¾¹æ–¹æ¡ˆï¼Œå®šä¹‰å¦‚ä¸‹æ­¥éª¤ä»¥è®¡ç®—å…¶åˆ†æ•°ï¼š</p>\n<pre><code>åˆ†åˆ«è·å–ä¸‰ä¸ªç»„ä»¶ æ¯ä¸ª ç»„ä»¶ä¸­æ‰€æœ‰èŠ‚ç‚¹å€¼çš„å¼‚æˆ–å€¼ã€‚\næœ€å¤§ å¼‚æˆ–å€¼å’Œ æœ€å° å¼‚æˆ–å€¼çš„ å·®å€¼ å°±æ˜¯è¿™ä¸€ç§åˆ é™¤è¾¹æ–¹æ¡ˆçš„åˆ†æ•°ã€‚\n\nä¾‹å¦‚ï¼Œä¸‰ä¸ªç»„ä»¶çš„èŠ‚ç‚¹å€¼åˆ†åˆ«æ˜¯ï¼š`[4,5,7]`ã€`[1,9]` å’Œ `[3,3,3]` ã€‚ä¸‰ä¸ªå¼‚æˆ–å€¼åˆ†åˆ«æ˜¯ `4 ^ 5 ^ 7 = 6`ã€`1 ^ 9 = 8` å’Œ `3 ^ 3 ^ 3 = 3` ã€‚æœ€å¤§å¼‚æˆ–å€¼æ˜¯ `8` ï¼Œæœ€å°å¼‚æˆ–å€¼æ˜¯ `3` ï¼Œåˆ†æ•°æ˜¯ `8 - 3 = 5` ã€‚\n</code></pre>\n<p>è¿”å›åœ¨ç»™å®šæ ‘ä¸Šæ‰§è¡Œä»»æ„åˆ é™¤è¾¹æ–¹æ¡ˆå¯èƒ½çš„ æœ€å° åˆ†æ•°ã€‚</p>\n<div class=\"note info no-icon\">\n<ul>\n<li>n == nums.length</li>\n<li>3 &lt;= n &lt;= 1000</li>\n<li>1 &lt;= nums[i] &lt;= 10^8</li>\n<li>edges.length == n - 1</li>\n<li>edges[i].length == 2</li>\n<li>0 &lt;= ai, bi &lt; n</li>\n<li>ai != bi</li>\n<li>edges è¡¨ç¤ºä¸€æ£µæœ‰æ•ˆçš„æ ‘</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<p>é¦–å…ˆæˆ‘ä»¬ç¡®å®šä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œç„¶åå¯¹æ ‘è¿›è¡Œ DFS éå†ï¼Œè®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„å­æ ‘å¼‚æˆ–å€¼ã€‚æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸¤æ¡è¾¹çš„åˆ é™¤æ–¹æ¡ˆï¼Œä½¿å¾—åˆ é™¤åçš„ä¸‰ä¸ªæ ‘çš„åˆ†æ•°æœ€å°ã€‚<br />\nç”±äºæœ€å¤šæœ‰ 1000 ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æš´åŠ›æšä¸¾çš„æ–¹å¼æ¥ç»Ÿè®¡æ‰€æœ‰è¾¹çš„åˆ é™¤æ–¹æ¡ˆã€‚<br />\næ¯æ¬¡é€‰æ‹©ä¸¤æ¡è¾¹è¿›è¡Œåˆ é™¤ï¼Œç„¶åè®¡ç®—åˆ é™¤åçš„ä¸‰ä¸ªæ ‘çš„å¼‚æˆ–å€¼ï¼Œæ›´æ–°æœ€å°åˆ†æ•°ã€‚<br />\nå¯¹äºä»åŸæ¥çš„æ ‘ä¸­åˆ†å‡ºå»çš„ä¸¤ä¸ªå­æ ‘ï¼Œæœ‰ä¸¤ç§å…³ç³»ï¼š</p>\n<ul>\n<li>ä¸¤ä¸ªå­æ ‘ï¼Œä¸€ä¸ªå­æ ‘çš„æ ¹æ˜¯å¦ä¸€ä¸ªå­æ ‘çš„ç¥–å…ˆï¼Œåˆ™ <code>v[0] = val[0] ^ val[x]ï¼Œv[1] = val[y]ï¼Œv[2] = val[x] ^ v[1]</code></li>\n<li>ä¸¤ä¸ªå­æ ‘äº’ä¸ç›¸äº¤ï¼Œåˆ™ <code>v[0] = val[0] ^ val[x] ^ val[y]ï¼Œv[1] = val[x]ï¼Œv[2] = val[y]</code></li>\n</ul>\n<p>å› æ­¤ï¼Œå½“å‰çš„å…³é”®å°±æ˜¯å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªå­æ ‘çš„å…³ç³»ã€‚<br />\nå†™æ³• 1ï¼šæœ€è¿‘å…¬å…±ç¥–å…ˆ<br />\nå†™æ³• 2ï¼šdfs åºï¼Œé€šè¿‡å…¥åºå’Œå‡ºåºåˆ¤æ–­</p>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•1</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">minimumScore</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums, vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt;&amp; edges)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n = nums.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">e</span>(n),<span class=\"built_in\">dp</span>(<span class=\"number\">10</span>,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n<span class=\"number\">+1</span>,<span class=\"number\">0</span>));</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">f</span><span class=\"params\">(n)</span>, <span class=\"title\">val</span><span class=\"params\">(n)</span>, <span class=\"title\">dfn</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> _:edges)&#123;</span><br><span class=\"line\">            e[_[<span class=\"number\">0</span>]].<span class=\"built_in\">push_back</span>(_[<span class=\"number\">1</span>]);</span><br><span class=\"line\">            e[_[<span class=\"number\">1</span>]].<span class=\"built_in\">push_back</span>(_[<span class=\"number\">0</span>]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> dfs = [&amp;](<span class=\"keyword\">auto</span> &amp;&amp; self, <span class=\"type\">int</span> fa, <span class=\"type\">int</span> cur)-&gt;<span class=\"type\">int</span>&#123;</span><br><span class=\"line\">            f[cur] = fa;</span><br><span class=\"line\">            <span class=\"type\">int</span> ans = nums[cur];</span><br><span class=\"line\">            dfn[cur] = ++cnt;</span><br><span class=\"line\">            dp[<span class=\"number\">0</span>][cnt] = fa;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> _:e[cur])&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (_ == fa) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                ans ^= <span class=\"built_in\">self</span>(self, cur, _);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            val[cur] = ans;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(dfs,<span class=\"number\">0</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> get = [&amp;](<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> dfn[x] &lt; dfn[y]? x : y;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= __lg(n); i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j + (<span class=\"number\">1</span>&lt;&lt;i) - <span class=\"number\">1</span> &lt;= n; j++)&#123;</span><br><span class=\"line\">                dp[i][j] = <span class=\"built_in\">get</span>(dp[i<span class=\"number\">-1</span>][j], dp[i<span class=\"number\">-1</span>][j + (<span class=\"number\">1</span>&lt;&lt;(i<span class=\"number\">-1</span>))]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> LCA = [&amp;](<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x == y) <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">            x = dfn[x], y = dfn[y];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x &gt; y) <span class=\"built_in\">swap</span>(x, y);</span><br><span class=\"line\">            <span class=\"type\">int</span> k = __lg(y - x++);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">get</span>(dp[k][x], dp[k][y - (<span class=\"number\">1</span>&lt;&lt;k) + <span class=\"number\">1</span>]);</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"number\">1e8</span><span class=\"number\">+10</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> m = edges.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span>&amp; _:edges)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dfn[_[<span class=\"number\">0</span>]] &gt; dfn[_[<span class=\"number\">1</span>]]) <span class=\"built_in\">swap</span>(_[<span class=\"number\">0</span>], _[<span class=\"number\">1</span>]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; m; i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = i + <span class=\"number\">1</span>; j &lt; m; j++)&#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> x = edges[i][<span class=\"number\">1</span>], y = edges[j][<span class=\"number\">1</span>];</span><br><span class=\"line\">                <span class=\"type\">int</span> lca = <span class=\"built_in\">LCA</span>(x,y);</span><br><span class=\"line\">                <span class=\"type\">int</span> v1,v2,v3;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (lca == x || lca == y)&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (dfn[x] &gt; dfn[y]) &#123;</span><br><span class=\"line\">                        <span class=\"built_in\">swap</span>(x, y);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    v1 = val[<span class=\"number\">0</span>] ^ val[x];</span><br><span class=\"line\">                    v2 = val[y];</span><br><span class=\"line\">                    v3 = val[x] ^ v2;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    v1 = val[x];</span><br><span class=\"line\">                    v2 = val[y];</span><br><span class=\"line\">                    v3 = val[<span class=\"number\">0</span>] ^ v1 ^ v2;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                ans = <span class=\"built_in\">min</span>(ans, <span class=\"built_in\">max</span>(v1,<span class=\"built_in\">max</span>(v2,v3)) - <span class=\"built_in\">min</span>(v1,<span class=\"built_in\">min</span>(v2,v3)));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•2</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">minimumScore</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums, vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt;&amp; edges)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n = nums.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">e</span>(n);</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">val</span><span class=\"params\">(n)</span>, <span class=\"title\">dfn</span><span class=\"params\">(n)</span>, <span class=\"title\">dfo</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> _:edges)&#123;</span><br><span class=\"line\">            e[_[<span class=\"number\">0</span>]].<span class=\"built_in\">push_back</span>(_[<span class=\"number\">1</span>]);</span><br><span class=\"line\">            e[_[<span class=\"number\">1</span>]].<span class=\"built_in\">push_back</span>(_[<span class=\"number\">0</span>]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> dfs = [&amp;](<span class=\"keyword\">auto</span> &amp;&amp; self, <span class=\"type\">int</span> fa, <span class=\"type\">int</span> cur)-&gt;<span class=\"type\">int</span>&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> ans = nums[cur];</span><br><span class=\"line\">            dfn[cur] = ++cnt;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> _:e[cur])&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (_ == fa) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                ans ^= <span class=\"built_in\">self</span>(self, cur, _);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            val[cur] = ans;</span><br><span class=\"line\">            dfo[cur] = cnt;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(dfs,<span class=\"number\">0</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"number\">1e8</span><span class=\"number\">+10</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> m = edges.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span>&amp; _:edges)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dfn[_[<span class=\"number\">0</span>]] &gt; dfn[_[<span class=\"number\">1</span>]]) <span class=\"built_in\">swap</span>(_[<span class=\"number\">0</span>], _[<span class=\"number\">1</span>]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; m; i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = i + <span class=\"number\">1</span>; j &lt; m; j++)&#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> x = edges[i][<span class=\"number\">1</span>], y = edges[j][<span class=\"number\">1</span>];</span><br><span class=\"line\">                <span class=\"type\">int</span> v1,v2,v3;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (dfn[x] &gt; dfn[y]) &#123;</span><br><span class=\"line\">                        <span class=\"built_in\">swap</span>(x, y);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (dfo[x] &gt;= dfo[y])&#123;</span><br><span class=\"line\">                    </span><br><span class=\"line\">                    v1 = val[<span class=\"number\">0</span>] ^ val[x];</span><br><span class=\"line\">                    v2 = val[y];</span><br><span class=\"line\">                    v3 = val[x] ^ v2;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    v1 = val[x];</span><br><span class=\"line\">                    v2 = val[y];</span><br><span class=\"line\">                    v3 = val[<span class=\"number\">0</span>] ^ v1 ^ v2;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                ans = <span class=\"built_in\">min</span>(ans, <span class=\"built_in\">max</span>(v1,<span class=\"built_in\">max</span>(v2,v3)) - <span class=\"built_in\">min</span>(v1,<span class=\"built_in\">min</span>(v2,v3)));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "DFS",
                "æœ€è¿‘å…¬å…±ç¥–å…ˆ",
                "æ ‘",
                "å¼‚æˆ–",
                "dfsåº"
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A1717-%E5%88%A0%E9%99%A4%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9C%80%E5%A4%A7%E5%BE%97%E5%88%86/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A1717-%E5%88%A0%E9%99%A4%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9C%80%E5%A4%A7%E5%BE%97%E5%88%86/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š1717. åˆ é™¤å­å­—ç¬¦ä¸²çš„æœ€å¤§å¾—åˆ†",
            "date_published": "2025-07-25T05:32:32.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9tYXhpbXVtLXNjb3JlLWZyb20tcmVtb3Zpbmctc3Vic3RyaW5ncz9lbnZUeXBlPWRhaWx5LXF1ZXN0aW9uJmFtcDtlbnZJZD0yMDI1LTA3LTI1\">LeetCode 1717</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²  <code>s</code>  å’Œä¸¤ä¸ªæ•´æ•°  <code>x</code>  å’Œ  <code>y</code>  ã€‚ä½ å¯ä»¥æ‰§è¡Œä¸‹é¢ä¸¤ç§æ“ä½œä»»æ„æ¬¡ã€‚</p>\n<ul>\n<li>åˆ é™¤å­å­—ç¬¦ä¸²  <code>&quot;ab&quot;</code>  å¹¶å¾—åˆ°  <code>x</code>  åˆ†ã€‚\n<ul>\n<li>æ¯”æ–¹è¯´ï¼Œä»  <code>&quot;cabxbae&quot;</code>  åˆ é™¤  <code>&quot;ab&quot;</code>  ï¼Œå¾—åˆ°  <code>&quot;cxbae&quot;</code>  ã€‚</li>\n</ul>\n</li>\n<li>åˆ é™¤å­å­—ç¬¦ä¸²  <code>&quot;ba&quot;</code>  å¹¶å¾—åˆ°  <code>y</code>  åˆ†ã€‚\n<ul>\n<li>æ¯”æ–¹è¯´ï¼Œä»  <code>&quot;cabxbae&quot;</code>  åˆ é™¤  <code>&quot;ba&quot;</code>  ï¼Œå¾—åˆ°  <code>&quot;cabxe&quot;</code>  ã€‚</li>\n</ul>\n</li>\n</ul>\n<p>è¯·è¿”å›å¯¹  <code>s</code>  å­—ç¬¦ä¸²æ‰§è¡Œä¸Šé¢æ“ä½œè‹¥å¹²æ¬¡èƒ½å¾—åˆ°çš„æœ€å¤§å¾—åˆ†ã€‚</p>\n<div class=\"note info no-icon\">\n<ul>\n<li>1 &lt;= s.length &lt;= 10^5</li>\n<li>1 &lt;= x, y &lt;= 10^4</li>\n<li>s åªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<p>ç”±äºåˆ é™¤çš„æ˜¯å­å­—ç¬¦ä¸²ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦åˆ†åˆ«è€ƒè™‘æ¯ä¸€ä¸ªè¿ç»­çš„ç”±  <code>a</code>  å’Œ  <code>b</code>  ç»„æˆçš„å­ä¸²ã€‚<br />\næ€è·¯ï¼šè´ªå¿ƒ<br />\nå¯¹äºæ¯ä¸€ä¸ªç”±  <code>a</code>  å’Œ  <code>b</code>  ç»„æˆçš„å­ä¸²ï¼Œä½¿ç”¨æ‹¬å·åŒ¹é…çš„æ–¹å¼ï¼Œæˆ‘ä»¬å…ˆé€‰æ‹©å¾—åˆ†æ›´é«˜çš„æ“ä½œè¿›è¡Œåˆ é™¤ï¼Œå†é€‰æ‹©å¾—åˆ†è¾ƒä½çš„æ“ä½œè¿›è¡Œåˆ é™¤ï¼Œç›´åˆ°æ— æ³•åˆ é™¤ä¸ºæ­¢ã€‚<br />\nå†™æ³• 1ï¼šæ ˆ<br />\né€šè¿‡ä¸¤ä¸ªæ ˆæ¥è¿›è¡Œä¸¤æ¬¡éå†ï¼Œç¬¬ä¸€æ¬¡éå†æ—¶åˆ é™¤å¾—åˆ†è¾ƒé«˜çš„æ“ä½œï¼Œç¬¬äºŒæ¬¡éå†æ—¶åˆ é™¤å¾—åˆ†è¾ƒä½çš„æ“ä½œã€‚<br />\nå†™æ³• 2ï¼šè®¡æ•°<br />\né€šè¿‡è®¡æ•°çš„æ–¹å¼ï¼Œé€ä¸ªç»Ÿè®¡æ¯ä¸ªå­ä¸²ä¸­  <code>a</code>  å’Œ  <code>b</code>  çš„æ•°é‡ï¼Œè¿›è¡ŒåŒ¹é…ï¼ŒåŒ¹é…å®Œé«˜åˆ†çš„ï¼Œ <code>a</code>  å’Œ  <code>b</code>  çš„æ•°é‡çš„æœ€å°å€¼å°±æ˜¯ä½åˆ†çš„æ“ä½œå¯ä»¥åˆ é™¤çš„æ¬¡æ•°ã€‚</p>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•1</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">maximumGain</span><span class=\"params\">(string s, <span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> st = <span class=\"number\">0</span>, ed = <span class=\"number\">0</span>, n = s.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        string ab = <span class=\"string\">&quot;ab&quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (y&gt;x) ab = <span class=\"string\">&quot;ba&quot;</span>, <span class=\"built_in\">swap</span>(x,y);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (ed &lt; n) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (st &lt; n &amp;&amp; !ab.<span class=\"built_in\">contains</span>(s[st])) st++;</span><br><span class=\"line\">            ed = st;</span><br><span class=\"line\">            stack&lt;string&gt; q,q1;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (ed &lt; n &amp;&amp; ab.<span class=\"built_in\">contains</span>(s[ed])) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!q.<span class=\"built_in\">empty</span>()) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (q.<span class=\"built_in\">top</span>() + s[ed] == ab) &#123;</span><br><span class=\"line\">                        q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">                        ans += x;</span><br><span class=\"line\">                        cout &lt;&lt; ed &lt;&lt; <span class=\"string\">&#x27;\\n&#x27;</span>;</span><br><span class=\"line\">                        ed++;</span><br><span class=\"line\">                        <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(<span class=\"built_in\">string</span>(<span class=\"number\">1</span>,s[ed++]));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            st = ed + <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())&#123;</span><br><span class=\"line\">                cout &lt;&lt; q.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!q<span class=\"number\">1.</span><span class=\"built_in\">empty</span>() &amp;&amp; q<span class=\"number\">1.</span><span class=\"built_in\">top</span>() + q.<span class=\"built_in\">top</span>() == ab) &#123;</span><br><span class=\"line\">                    q.<span class=\"built_in\">pop</span>(), q<span class=\"number\">1.</span><span class=\"built_in\">pop</span>();</span><br><span class=\"line\">                    ans += y;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    q<span class=\"number\">1.</span><span class=\"built_in\">push</span>(q.<span class=\"built_in\">top</span>());</span><br><span class=\"line\">                    q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•2</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">maximumGain</span><span class=\"params\">(string s, <span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> st = <span class=\"number\">0</span>, ed = <span class=\"number\">0</span>, n = s.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        string ab = <span class=\"string\">&quot;ab&quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (y&gt;x) ab = <span class=\"string\">&quot;ba&quot;</span>, <span class=\"built_in\">swap</span>(x,y);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (ed &lt; n) &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> cnta = <span class=\"number\">0</span>, cntb = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (st &lt; n &amp;&amp; !ab.<span class=\"built_in\">contains</span>(s[st])) st++;</span><br><span class=\"line\">            ed = st;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (ed &lt; n &amp;&amp; ab.<span class=\"built_in\">contains</span>(s[ed])) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (s[ed] == ab[<span class=\"number\">0</span>]) &#123;</span><br><span class=\"line\">                    cnta++;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (cnta &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                        cnta--;</span><br><span class=\"line\">                        ans += x;</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                        cntb++;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                ed++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            st = ed + <span class=\"number\">1</span>;</span><br><span class=\"line\">            ans += <span class=\"built_in\">min</span>(cnta, cntb) * y;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "å­—ç¬¦ä¸²",
                "è´ªå¿ƒ",
                "æ ˆ"
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A1695-%E5%88%A0%E9%99%A4%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%9C%80%E5%A4%A7%E5%BE%97%E5%88%86/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A1695-%E5%88%A0%E9%99%A4%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%9C%80%E5%A4%A7%E5%BE%97%E5%88%86/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š1695. åˆ é™¤å­æ•°ç»„çš„æœ€å¤§å¾—åˆ†",
            "date_published": "2025-07-22T14:24:07.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9tYXhpbXVtLWVyYXN1cmUtdmFsdWU/ZW52VHlwZT1kYWlseS1xdWVzdGlvbiZhbXA7ZW52SWQ9MjAyNS0wNy0yMg==\">LeetCode 1695</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ç»™ä½ ä¸€ä¸ªæ­£æ•´æ•°æ•°ç»„  <code>nums</code>  ï¼Œè¯·ä½ ä»ä¸­åˆ é™¤ä¸€ä¸ªå«æœ‰ è‹¥å¹²ä¸åŒå…ƒç´  çš„å­æ•°ç»„ã€‚åˆ é™¤å­æ•°ç»„çš„ å¾—åˆ† å°±æ˜¯å­æ•°ç»„å„å…ƒç´ ä¹‹ å’Œ ã€‚</p>\n<p>è¿”å› åªåˆ é™¤ä¸€ä¸ª å­æ•°ç»„å¯è·å¾—çš„ æœ€å¤§å¾—åˆ† ã€‚</p>\n<p>å¦‚æœæ•°ç»„  <code>b</code>  æ˜¯æ•°ç»„  <code>a</code>  çš„ä¸€ä¸ªè¿ç»­å­åºåˆ—ï¼Œå³å¦‚æœå®ƒç­‰äº  <code>a[l],a[l+1],...,a[r]</code>  ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯  <code>a</code>  çš„ä¸€ä¸ªå­æ•°ç»„ã€‚</p>\n<div class=\"note info no-icon\">\n<ul>\n<li>1 &lt;= nums.length &lt;= 10^5</li>\n<li>1 &lt;= nums[i] &lt;= 10^4</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<p>ç”±äºå­æ•°ç»„æ˜¯è¿ç»­çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ»‘åŠ¨çª—å£çš„æ–¹å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥ç»´æŠ¤ä¸€ä¸ªçª—å£ï¼Œçª—å£å†…çš„å…ƒç´ éƒ½æ˜¯ä¸åŒçš„ï¼Œç„¶åè®¡ç®—çª—å£å†…å…ƒç´ çš„å’Œã€‚<br />\nå½“çª—å£å†…çš„å…ƒç´ å‡ºç°é‡å¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†å·¦è¾¹çš„å…ƒç´ ç§»å‡ºçª—å£ï¼Œç›´åˆ°çª—å£å†…çš„å…ƒç´ éƒ½ä¸é‡å¤ä¸ºæ­¢ã€‚æ¯æ¬¡æ›´æ–°çª—å£æ—¶ï¼Œæˆ‘ä»¬éƒ½è®¡ç®—å½“å‰çª—å£å†…å…ƒç´ çš„å’Œï¼Œå¹¶æ›´æ–°æœ€å¤§å¾—åˆ†ã€‚</p>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">maximumUniqueSubarray</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">bool</span>&gt; <span class=\"title\">vis</span><span class=\"params\">(<span class=\"number\">10010</span>,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> st = <span class=\"number\">0</span>, ed = <span class=\"number\">0</span>, n = nums.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"type\">int</span> sum = <span class=\"number\">0</span>, ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (ed &lt; n)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (vis[nums[ed]]) &#123;</span><br><span class=\"line\">                sum -= nums[st];</span><br><span class=\"line\">                vis[nums[st++]] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            sum += nums[ed];</span><br><span class=\"line\">            vis[nums[ed++]] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            ans = <span class=\"built_in\">max</span>(ans, sum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "æ»‘åŠ¨çª—å£",
                "æ•°ç»„"
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A1957-%E5%88%A0%E9%99%A4%E5%AD%97%E7%AC%A6%E4%BD%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8F%98%E5%A5%BD/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A1957-%E5%88%A0%E9%99%A4%E5%AD%97%E7%AC%A6%E4%BD%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8F%98%E5%A5%BD/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š1957. åˆ é™¤å­—ç¬¦ä½¿å­—ç¬¦ä¸²å˜å¥½",
            "date_published": "2025-07-22T14:23:43.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9kZWxldGUtY2hhcmFjdGVycy10by1tYWtlLWZhbmN5LXN0cmluZz9lbnZUeXBlPWRhaWx5LXF1ZXN0aW9uJmFtcDtlbnZJZD0yMDI1LTA3LTIx\">LeetCode 1957</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ä¸€ä¸ªå­—ç¬¦ä¸²å¦‚æœæ²¡æœ‰ ä¸‰ä¸ªè¿ç»­ ç›¸åŒå­—ç¬¦ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ª å¥½å­—ç¬¦ä¸² ã€‚</p>\n<p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²  <code>s</code>  ï¼Œè¯·ä½ ä»  <code>s</code>  åˆ é™¤ æœ€å°‘ çš„å­—ç¬¦ï¼Œä½¿å®ƒå˜æˆä¸€ä¸ª å¥½å­—ç¬¦ä¸² ã€‚</p>\n<p>è¯·ä½ è¿”å›åˆ é™¤åçš„å­—ç¬¦ä¸²ã€‚é¢˜ç›®æ•°æ®ä¿è¯ç­”æ¡ˆæ€»æ˜¯ å”¯ä¸€çš„ ã€‚</p>\n<div class=\"note info no-icon\">\n<ul>\n<li>1 &lt;= s.length &lt;= 10^5</li>\n<li>s åªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<p>è®°å½•ä¸Šä¸€ä¸ªå­—ç¬¦æ˜¯ä»€ä¹ˆä»¥åŠå‡ºç°çš„æ¬¡æ•°ï¼Œå¦‚æœå½“å‰å­—ç¬¦å’Œä¸Šä¸€ä¸ªå­—ç¬¦ç›¸åŒï¼Œåˆ™å¢åŠ è®¡æ•°ï¼Œå¦‚æœä¸åŒåˆ™é‡ç½®è®¡æ•°ã€‚å½“è®¡æ•°å°äº 3 æ—¶ï¼Œè¯´æ˜å¯ä»¥ä¿ç•™è¯¥å­—ç¬¦ï¼Œå¦åˆ™éœ€è¦åˆ é™¤ã€‚</p>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\">string <span class=\"title\">makeFancyString</span><span class=\"params\">(string s)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"type\">char</span> last = <span class=\"string\">&#x27;#&#x27;</span>;</span><br><span class=\"line\">        string ans;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> c:s)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c == last)&#123;</span><br><span class=\"line\">                cnt++;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                cnt = <span class=\"number\">1</span>;</span><br><span class=\"line\">                last = c;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (cnt &lt; <span class=\"number\">3</span>) ans+=c;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "å­—ç¬¦ä¸²"
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A1948-%E5%88%A0%E9%99%A4%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E6%96%87%E4%BB%B6%E5%A4%B9/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A1948-%E5%88%A0%E9%99%A4%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E6%96%87%E4%BB%B6%E5%A4%B9/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š1948. åˆ é™¤ç³»ç»Ÿä¸­çš„é‡å¤æ–‡ä»¶å¤¹",
            "date_published": "2025-07-22T14:23:18.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9kZWxldGUtZHVwbGljYXRlLWZvbGRlcnMtaW4tc3lzdGVtP2VudlR5cGU9ZGFpbHktcXVlc3Rpb24mYW1wO2VudklkPTIwMjUtMDctMzE=\">LeetCode 1948</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ç”±äºä¸€ä¸ªæ¼æ´ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­å­˜åœ¨è®¸å¤šé‡å¤æ–‡ä»¶å¤¹ã€‚ç»™ä½ ä¸€ä¸ªäºŒç»´æ•°ç»„  <code>paths</code> ï¼Œå…¶ä¸­  <code>paths[i]</code>  æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿä¸­ç¬¬  <code>i</code>  ä¸ªæ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„çš„æ•°ç»„ã€‚</p>\n<ul>\n<li>ä¾‹å¦‚ï¼Œ <code>[&quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</code>  è¡¨ç¤ºè·¯å¾„  <code>&quot;/one/two/three&quot;</code>  ã€‚</li>\n</ul>\n<p>å¦‚æœä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼ˆä¸éœ€è¦åœ¨åŒä¸€å±‚çº§ï¼‰åŒ…å« éç©ºä¸”ç›¸åŒçš„ å­æ–‡ä»¶å¤¹ é›†åˆ å¹¶å…·æœ‰ç›¸åŒçš„å­æ–‡ä»¶å¤¹ç»“æ„ï¼Œåˆ™è®¤ä¸ºè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹æ˜¯ç›¸åŒæ–‡ä»¶å¤¹ã€‚ç›¸åŒæ–‡ä»¶å¤¹çš„æ ¹å±‚çº§ ä¸ éœ€è¦ç›¸åŒã€‚å¦‚æœå­˜åœ¨ä¸¤ä¸ªï¼ˆæˆ–ä¸¤ä¸ªä»¥ä¸Šï¼‰ç›¸åŒ æ–‡ä»¶å¤¹ï¼Œåˆ™éœ€è¦å°†è¿™äº›æ–‡ä»¶å¤¹å’Œæ‰€æœ‰å®ƒä»¬çš„å­æ–‡ä»¶å¤¹ æ ‡è®° ä¸ºå¾…åˆ é™¤ã€‚</p>\n<ul>\n<li>ä¾‹å¦‚ï¼Œä¸‹é¢æ–‡ä»¶ç»“æ„ä¸­çš„æ–‡ä»¶å¤¹  <code>&quot;/a&quot;</code>  å’Œ  <code>&quot;/b&quot;</code>  ç›¸åŒã€‚å®ƒä»¬ï¼ˆä»¥åŠå®ƒä»¬çš„å­æ–‡ä»¶å¤¹ï¼‰åº”è¯¥è¢« å…¨éƒ¨ æ ‡è®°ä¸ºå¾…åˆ é™¤ï¼š\n<ul>\n<li><code>/a</code>\n<ul>\n<li><code>/a/x</code></li>\n<li><code>/a/x/y</code></li>\n<li><code>/a/z</code></li>\n</ul>\n</li>\n<li><code>/b</code>\n<ul>\n<li><code>/b/x</code>\n<ul>\n<li><code>/b/x/y</code></li>\n<li><code>/b/z</code></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>ç„¶è€Œï¼Œå¦‚æœæ–‡ä»¶ç»“æ„ä¸­è¿˜åŒ…å«è·¯å¾„  <code>&quot;/b/w&quot;</code>  ï¼Œé‚£ä¹ˆæ–‡ä»¶å¤¹  <code>&quot;/a&quot;</code>  å’Œ  <code>&quot;/b&quot;</code>  å°±ä¸ç›¸åŒã€‚æ³¨æ„ï¼Œå³ä¾¿æ·»åŠ äº†æ–°çš„æ–‡ä»¶å¤¹  <code>&quot;/b/w&quot;</code>  ï¼Œä»ç„¶è®¤ä¸º  <code>&quot;/a/x&quot;</code>  å’Œ  <code>&quot;/b/x&quot;</code>  ç›¸åŒã€‚</li>\n</ul>\n<p>ä¸€æ—¦æ‰€æœ‰çš„ç›¸åŒæ–‡ä»¶å¤¹å’Œå®ƒä»¬çš„å­æ–‡ä»¶å¤¹éƒ½è¢«æ ‡è®°ä¸ºå¾…åˆ é™¤ï¼Œæ–‡ä»¶ç³»ç»Ÿå°†ä¼š åˆ é™¤ æ‰€æœ‰ä¸Šè¿°æ–‡ä»¶å¤¹ã€‚æ–‡ä»¶ç³»ç»Ÿåªä¼šæ‰§è¡Œä¸€æ¬¡åˆ é™¤æ“ä½œã€‚æ‰§è¡Œå®Œè¿™ä¸€æ¬¡åˆ é™¤æ“ä½œåï¼Œä¸ä¼šåˆ é™¤æ–°å‡ºç°çš„ç›¸åŒæ–‡ä»¶å¤¹ã€‚</p>\n<p>è¿”å›äºŒç»´æ•°ç»„  <code>ans</code>  ï¼Œè¯¥æ•°ç»„åŒ…å«åˆ é™¤æ‰€æœ‰æ ‡è®°æ–‡ä»¶å¤¹ä¹‹åå‰©ä½™æ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚è·¯å¾„å¯ä»¥æŒ‰ ä»»æ„é¡ºåº è¿”å›ã€‚</p>\n<div class=\"note info no-icon\">\n<ul>\n<li>1 &lt;= paths.length &lt;= 2 * 10^4</li>\n<li>1 &lt;= paths[i].length &lt;= 500</li>\n<li>1 &lt;= paths[i][j].length &lt;= 10</li>\n<li>1 &lt;= sum(paths[i][j].length) &lt;= 2 * 10^5</li>\n<li>path [i][j] ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆ</li>\n<li>ä¸ä¼šå­˜åœ¨ä¸¤ä¸ªè·¯å¾„éƒ½æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶å¤¹çš„æƒ…å†µ</li>\n<li>å¯¹äºä¸åœ¨æ ¹å±‚çº§çš„ä»»æ„æ–‡ä»¶å¤¹ï¼Œå…¶çˆ¶æ–‡ä»¶å¤¹ä¹Ÿä¼šåŒ…å«åœ¨è¾“å…¥ä¸­</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<div class=\"note info no-icon\">\n<p>è¯¥é¢˜è§£å‚è€ƒ<span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9kZWxldGUtZHVwbGljYXRlLWZvbGRlcnMtaW4tc3lzdGVtL3NvbHV0aW9ucy84OTUxNDgvemktZGlhbi1zaHUtaGEteGktYmlhby1ieS1lbmRsZXNzY2hlbmctMTE1cg==\">æ‹¬å·è¡¨ç¤ºæ³• + å­—å…¸æ ‘ï¼ˆPython/Java/C++/Goï¼‰</span></p>\n</div>\n<ul>\n<li>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†æ¯ä¸ªæ–‡ä»¶å¤¹è·¯å¾„è½¬æ¢ä¸ºæ‹¬å·è¡¨ç¤ºæ³•ã€‚å¯¹äºæ¯ä¸ªæ–‡ä»¶å¤¹è·¯å¾„ï¼Œå°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶ä¸­æ¯ä¸ªå­æ–‡ä»¶å¤¹ç”¨æ‹¬å·åŒ…è£¹èµ·æ¥ã€‚</li>\n<li>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå­—å…¸æ ‘ï¼ˆTrieï¼‰æ¥å­˜å‚¨è¿™äº›æ‹¬å·è¡¨ç¤ºæ³•å­—ç¬¦ä¸²ã€‚å­—å…¸æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªæ‹¬å·è¡¨ç¤ºæ³•å­—ç¬¦ä¸²çš„å‰ç¼€ã€‚</li>\n<li>åœ¨æ’å…¥æ‹¬å·è¡¨ç¤ºæ³•å­—ç¬¦ä¸²æ—¶ï¼Œå¦‚æœå‘ç°æŸä¸ªèŠ‚ç‚¹å·²ç»å­˜åœ¨ï¼Œåˆ™è¯´æ˜è¯¥æ–‡ä»¶å¤¹è·¯å¾„å·²ç»å­˜åœ¨é‡å¤çš„å­æ–‡ä»¶å¤¹ç»“æ„ã€‚æˆ‘ä»¬å°†è¯¥èŠ‚ç‚¹æ ‡è®°ä¸ºå¾…åˆ é™¤ã€‚</li>\n<li>æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰éå†å­—å…¸æ ‘ï¼Œå°†æœªè¢«æ ‡è®°ä¸ºå¾…åˆ é™¤çš„èŠ‚ç‚¹çš„è·¯å¾„æ”¶é›†èµ·æ¥ï¼Œè¿”å›è¿™äº›è·¯å¾„ã€‚</li>\n</ul>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Trie</span>&#123;</span><br><span class=\"line\">    unordered_map&lt;string, Trie*&gt; children;</span><br><span class=\"line\">    string name;</span><br><span class=\"line\">    <span class=\"type\">bool</span> is_del = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    vector&lt;vector&lt;string&gt;&gt; <span class=\"built_in\">deleteDuplicateFolder</span>(vector&lt;vector&lt;string&gt;&gt;&amp; paths) &#123;</span><br><span class=\"line\">        Trie *rt = <span class=\"keyword\">new</span> <span class=\"built_in\">Trie</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">const</span> vector&lt;string&gt;&amp; path:paths)&#123;</span><br><span class=\"line\">            Trie *cur = rt;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">const</span> string&amp; node: path)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!cur-&gt;children.<span class=\"built_in\">contains</span>(node)) &#123;</span><br><span class=\"line\">                    cur-&gt;children[node] = <span class=\"keyword\">new</span> <span class=\"built_in\">Trie</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                cur = cur-&gt;children[node];</span><br><span class=\"line\">                cur-&gt;name = node;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        unordered_map&lt;string, Trie*&gt; expr_to_node;</span><br><span class=\"line\">        vector&lt;vector&lt;string&gt;&gt; ans;</span><br><span class=\"line\">        vector&lt;string&gt; path;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> get = [&amp;](<span class=\"keyword\">this</span> <span class=\"keyword\">auto</span> &amp;&amp; get, Trie *node) -&gt; string&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (node-&gt;children.<span class=\"built_in\">empty</span>())&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> node-&gt;name;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            vector&lt;string&gt; expr;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span>&amp; [_, children] : node-&gt;children) &#123;</span><br><span class=\"line\">                expr.<span class=\"built_in\">emplace_back</span>(<span class=\"string\">&quot;(&quot;</span> + <span class=\"built_in\">get</span>(children) + <span class=\"string\">&quot;)&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            ranges::<span class=\"built_in\">sort</span>(expr);</span><br><span class=\"line\">            string sub_expr;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;e:expr) &#123;</span><br><span class=\"line\">                sub_expr += e;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (expr_to_node.<span class=\"built_in\">contains</span>(sub_expr)) &#123;</span><br><span class=\"line\">                expr_to_node[sub_expr]-&gt;is_del = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                node-&gt;is_del = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                expr_to_node[sub_expr] = node;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">return</span> node-&gt;name + sub_expr;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span>&amp; [_,child] : rt-&gt;children)&#123;</span><br><span class=\"line\">            <span class=\"built_in\">get</span>(child);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">auto</span> dfs = [&amp;](<span class=\"keyword\">this</span> <span class=\"keyword\">auto</span>&amp;&amp; dfs, Trie* node) -&gt; <span class=\"type\">void</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (node-&gt;is_del) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            path.<span class=\"built_in\">push_back</span>(node-&gt;name);</span><br><span class=\"line\">            ans.<span class=\"built_in\">push_back</span>(path);</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span>&amp; [_, child] : node-&gt;children)&#123;</span><br><span class=\"line\">                <span class=\"built_in\">dfs</span>(child);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            path.<span class=\"built_in\">pop_back</span>();</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;[_, child] : rt-&gt;children)&#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(child);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "å­—ç¬¦ä¸²",
                "å­—å…¸æ ‘"
            ]
        },
        {
            "id": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/cs231n%E7%9A%84assignment1%EF%BC%9Asoftmax/",
            "url": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/cs231n%E7%9A%84assignment1%EF%BC%9Asoftmax/",
            "title": "cs231nçš„assignment1ï¼šsoftmax",
            "date_published": "2025-07-20T11:17:43.000Z",
            "content_html": "<h1 id=\"é—®é¢˜è®¾ç½®ä¸ç¬¦å·å®šä¹‰\"><a class=\"anchor\" href=\"#é—®é¢˜è®¾ç½®ä¸ç¬¦å·å®šä¹‰\">#</a> é—®é¢˜è®¾ç½®ä¸ç¬¦å·å®šä¹‰</h1>\n<p>Softmax åˆ†ç±»å™¨æ˜¯å¤šåˆ†ç±»é—®é¢˜çš„æ ¸å¿ƒç®—æ³•ä¹‹ä¸€ã€‚ç†è§£å…¶æ•°å­¦åŸç†å’Œæ¢¯åº¦è®¡ç®—å¯¹æŒæ¡æ·±åº¦å­¦ä¹ è‡³å…³é‡è¦ã€‚</p>\n<h2 id=\"ç¬¦å·å®šä¹‰\"><a class=\"anchor\" href=\"#ç¬¦å·å®šä¹‰\">#</a> ç¬¦å·å®šä¹‰</h2>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼šç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> ä¸ªæ ·æœ¬çš„ç‰¹å¾å‘é‡ï¼ˆå½¢çŠ¶ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mo>Ã—</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">D \\times 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼‰</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span>ï¼šæƒé‡çŸ©é˜µï¼ˆå½¢çŠ¶ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mo>Ã—</mo><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">D \\times C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>ï¼‰</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼šç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> ä¸ªæ ·æœ¬çš„çœŸå®æ ‡ç­¾</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mi>j</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>w</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">s_j = x_i^T w_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1274389999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-2.441336em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.258664em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>ï¼šç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> ä¸ªç±»åˆ«çš„å¾—åˆ†</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>j</mi></msub><mo>=</mo><mfrac><msup><mi>e</mi><msub><mi>s</mi><mi>j</mi></msub></msup><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><msup><mi>e</mi><msub><mi>s</mi><mi>k</mi></msub></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">p_j = \\frac{e^{s_j}}{\\sum_{k=1}^C e^{s_k}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.593957em;vertical-align:-0.654672em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.939285em;\"><span style=\"top:-2.570335em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mop op-symbol small-op mtight\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8852357142857143em;\"><span style=\"top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-2.8971428571428572em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32143857142857146em;\"><span></span></span></span></span></span></span><span class=\"mspace mtight\" style=\"margin-right:0.19516666666666668em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6650357142857143em;\"><span style=\"top:-2.8574928571428573em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3448em;margin-left:0em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.69444em;\"></span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34963999999999995em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7789785714285715em;\"><span style=\"top:-2.9714357142857146em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3448em;margin-left:0em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.65952em;\"></span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5091600000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.654672em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>ï¼šSoftmax æ¦‚ç‡</li>\n</ul>\n<h2 id=\"æŸå¤±å‡½æ•°æ„æˆ\"><a class=\"anchor\" href=\"#æŸå¤±å‡½æ•°æ„æˆ\">#</a> æŸå¤±å‡½æ•°æ„æˆ</h2>\n<p>å•ä¸ªæ ·æœ¬çš„æŸå¤±ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mo>âˆ’</mo><mi>log</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><msub><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L_i = -\\log(p_{y_i})\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>æ€»æŸå¤±ï¼ˆåŠ æ­£åˆ™åŒ–ï¼‰ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>L</mi><mi>i</mi></msub><mo>+</mo><mi>Î»</mi><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><munderover><mo>âˆ‘</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></munderover><msubsup><mi>w</mi><mrow><mi>d</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">L = \\frac{1}{N} \\sum_{i=1}^N L_i + \\lambda \\sum_{j=1}^C \\sum_{d=1}^D w_{dj}^2\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106005em;vertical-align:-1.277669em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.2421130000000007em;vertical-align:-1.4137769999999998em;\"></span><span class=\"mord mathnormal\">Î»</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.302113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.864108em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.383108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<details class=\"info\"><summary>L2æ­£åˆ™åŒ–è¯¦ç»†è¯´æ˜</summary><div>\n<p>L2 æ­£åˆ™åŒ–é€šè¿‡åœ¨æŸå¤±å‡½æ•°ä¸­æ·»åŠ æƒé‡å¹³æ–¹å’Œé¡¹æ¥é˜²æ­¢è¿‡æ‹Ÿåˆã€‚å…¶æ•°å­¦å½¢å¼ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î»</mi><mo>âˆ‘</mo><msup><mi>w</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\lambda \\sum w^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064118em;vertical-align:-0.25001em;\"></span><span class=\"mord mathnormal\">Î»</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>ï¼Œå…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î»</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">Î»</span></span></span></span> æ˜¯æ­£åˆ™åŒ–å¼ºåº¦ã€‚L2 æ­£åˆ™åŒ–çš„æ ¸å¿ƒæ€æƒ³æ˜¯æƒ©ç½šè¿‡å¤§çš„æƒé‡å€¼ï¼Œè¿«ä½¿æ¨¡å‹å­¦ä¹ æ›´ç®€å•çš„å‚æ•°åˆ†å¸ƒã€‚</p>\n<p><strong>ä¸»è¦ä½œç”¨ï¼š</strong></p>\n<ul>\n<li><strong>é˜²æ­¢è¿‡æ‹Ÿåˆ</strong>ï¼šé™åˆ¶æ¨¡å‹å¤æ‚åº¦ï¼Œæé«˜æ³›åŒ–èƒ½åŠ›</li>\n<li><strong>æ•°å€¼ç¨³å®šæ€§</strong>ï¼šé¿å…æƒé‡çˆ†ç‚¸ï¼Œä¿æŒè®­ç»ƒç¨³å®š</li>\n<li><strong>ç‰¹å¾é€‰æ‹©</strong>ï¼šå€¾å‘äºä½¿ç”¨æ‰€æœ‰ç‰¹å¾ä½†é™ä½å…¶æƒé‡</li>\n</ul>\n<p><strong>ä¸ L1 æ­£åˆ™åŒ–çš„åŒºåˆ«ï¼š</strong></p>\n<ul>\n<li>L2 æ­£åˆ™åŒ–äº§ç”Ÿå¹³æ»‘çš„æƒé‡è¡°å‡ï¼Œä¸ä¼šäº§ç”Ÿç¨€ç–è§£</li>\n<li>L1 æ­£åˆ™åŒ–åˆ™å€¾å‘äºäº§ç”Ÿç¨€ç–æƒé‡ï¼ˆè®¸å¤šæƒé‡ä¸º 0ï¼‰</li>\n</ul>\n</div></details>\n<h1 id=\"softmaxå‡½æ•°çš„æ¢¯åº¦æ¨å¯¼\"><a class=\"anchor\" href=\"#softmaxå‡½æ•°çš„æ¢¯åº¦æ¨å¯¼\">#</a> Softmax å‡½æ•°çš„æ¢¯åº¦æ¨å¯¼</h1>\n<h2 \\partial=\"\" s_k=\"\" id=\"step-1-è®¡ç®—-fracpartial-p_j\"><a class=\"anchor\" href=\"#step-1-è®¡ç®—-fracpartial-p_j\">#</a> Step 1: è®¡ç®— \\frac{\\partial p_j}</h2>\n<p>å¯¹äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>j</mi></msub><mo>=</mo><mfrac><msup><mi>e</mi><msub><mi>s</mi><mi>j</mi></msub></msup><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><msup><mi>e</mi><msub><mi>s</mi><mi>k</mi></msub></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">p_j = \\frac{e^{s_j}}{\\sum_{k=1}^C e^{s_k}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.593957em;vertical-align:-0.654672em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.939285em;\"><span style=\"top:-2.570335em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mop op-symbol small-op mtight\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8852357142857143em;\"><span style=\"top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-2.8971428571428572em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32143857142857146em;\"><span></span></span></span></span></span></span><span class=\"mspace mtight\" style=\"margin-right:0.19516666666666668em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6650357142857143em;\"><span style=\"top:-2.8574928571428573em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3448em;margin-left:0em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.69444em;\"></span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34963999999999995em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7789785714285715em;\"><span style=\"top:-2.9714357142857146em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3448em;margin-left:0em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.65952em;\"></span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5091600000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.654672em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>ï¼Œéœ€è¦åˆ†ä¸¤ç§æƒ…å†µè®¡ç®—åå¯¼æ•°ï¼š</p>\n<p><strong>æƒ…å†µ 1ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo>=</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">j = k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span></strong></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>p</mi><mi>j</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>s</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><msup><mi>e</mi><msub><mi>s</mi><mi>j</mi></msub></msup><mo>â‹…</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msup><mi>e</mi><msub><mi>s</mi><mi>k</mi></msub></msup><mo>âˆ’</mo><msup><mi>e</mi><msub><mi>s</mi><mi>j</mi></msub></msup><mo>â‹…</mo><msup><mi>e</mi><msub><mi>s</mi><mi>j</mi></msub></msup></mrow><mrow><mo stretchy=\"false\">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msup><mi>e</mi><msub><mi>s</mi><mi>k</mi></msub></msup><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial p_j}{\\partial s_j} = \\frac{e^{s_j} \\cdot \\sum_{k=1}^C e^{s_k} - e^{s_j} \\cdot e^{s_j}}{(\\sum_{k=1}^C e^{s_k})^2}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.841882em;vertical-align:-1.170941em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.670941em;\"><span style=\"top:-2.128769em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.590392em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6897100000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.170941em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo>=</mo><mfrac><msup><mi>e</mi><msub><mi>s</mi><mi>j</mi></msub></msup><mrow><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msup><mi>e</mi><msub><mi>s</mi><mi>k</mi></msub></msup></mrow></mfrac><mo>â‹…</mo><mfrac><mrow><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msup><mi>e</mi><msub><mi>s</mi><mi>k</mi></msub></msup><mo>âˆ’</mo><msup><mi>e</mi><msub><mi>s</mi><mi>j</mi></msub></msup></mrow><mrow><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msup><mi>e</mi><msub><mi>s</mi><mi>k</mi></msub></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">= \\frac{e^{s_j}}{\\sum_{k=1}^C e^{s_k}} \\cdot \\frac{\\sum_{k=1}^C e^{s_k} - e^{s_j}}{\\sum_{k=1}^C e^{s_k}}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.512333em;vertical-align:-1.170941em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.341392em;\"><span style=\"top:-2.128769em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.590392em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.170941em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.841882em;vertical-align:-1.170941em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.670941em;\"><span style=\"top:-2.128769em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.590392em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6897100000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.170941em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo>=</mo><msub><mi>p</mi><mi>j</mi></msub><mo stretchy=\"false\">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>p</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">= p_j(1 - p_j)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p><strong>æƒ…å†µ 2ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo mathvariant=\"normal\">â‰ </mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">j \\neq k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"inner\"><span class=\"mrel\">î€ </span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span></strong></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>p</mi><mi>j</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>s</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>0</mn><mo>â‹…</mo><munderover><mo>âˆ‘</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msup><mi>e</mi><msub><mi>s</mi><mi>l</mi></msub></msup><mo>âˆ’</mo><msup><mi>e</mi><msub><mi>s</mi><mi>j</mi></msub></msup><mo>â‹…</mo><msup><mi>e</mi><msub><mi>s</mi><mi>k</mi></msub></msup></mrow><mrow><mo stretchy=\"false\">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msup><mi>e</mi><msub><mi>s</mi><mi>l</mi></msub></msup><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial p_j}{\\partial s_k} = \\frac{0 \\cdot \\sum_{l=1}^C e^{s_l} - e^{s_j} \\cdot e^{s_k}}{(\\sum_{l=1}^C e^{s_l})^2}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.20744em;vertical-align:-0.8360000000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.3139999999999996em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.841882em;vertical-align:-1.170941em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.670941em;\"><span style=\"top:-2.128769em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.590392em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6897100000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.170941em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo>=</mo><mo>âˆ’</mo><mfrac><msup><mi>e</mi><msub><mi>s</mi><mi>j</mi></msub></msup><mrow><munderover><mo>âˆ‘</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msup><mi>e</mi><msub><mi>s</mi><mi>l</mi></msub></msup></mrow></mfrac><mo>â‹…</mo><mfrac><msup><mi>e</mi><msub><mi>s</mi><mi>k</mi></msub></msup><mrow><munderover><mo>âˆ‘</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msup><mi>e</mi><msub><mi>s</mi><mi>l</mi></msub></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">= -\\frac{e^{s_j}}{\\sum_{l=1}^C e^{s_l}} \\cdot \\frac{e^{s_k}}{\\sum_{l=1}^C e^{s_l}}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.512333em;vertical-align:-1.170941em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.341392em;\"><span style=\"top:-2.128769em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.590392em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.170941em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.512333em;vertical-align:-1.170941em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.341392em;\"><span style=\"top:-2.128769em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.590392em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.170941em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo>=</mo><mo>âˆ’</mo><msub><mi>p</mi><mi>j</mi></msub><msub><mi>p</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">= -p_j p_k\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8694379999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<h2 \\partial=\"\" s_j=\"\" id=\"step-2-è®¡ç®—-fracpartial-l_i\"><a class=\"anchor\" href=\"#step-2-è®¡ç®—-fracpartial-l_i\">#</a> Step 2: è®¡ç®— \\frac{\\partial L_i}</h2>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mo>âˆ’</mo><mi>log</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><msub><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L_i = -\\log(p_{y_i})\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>s</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>âˆ’</mo><mfrac><mn>1</mn><msub><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mfrac><mo>â‹…</mo><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>s</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L_i}{\\partial s_j} = -\\frac{1}{p_{y_i}} \\cdot \\frac{\\partial p_{y_i}}{\\partial s_j}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.293548em;vertical-align:-0.972108em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p><strong>æƒ…å†µ 1ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">j = y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼ˆæ­£ç¡®ç±»åˆ«ï¼‰</strong></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>s</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mrow></mfrac><mo>=</mo><mo>âˆ’</mo><mfrac><mn>1</mn><msub><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mfrac><mo>â‹…</mo><msub><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo stretchy=\"false\">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mo>âˆ’</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L_i}{\\partial s_{y_i}} = -\\frac{1}{p_{y_i}} \\cdot p_{y_i}(1 - p_{y_i}) = -(1 - p_{y_i}) = p_{y_i} - 1\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.293548em;vertical-align:-0.972108em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8694379999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span></span></p>\n<p><strong>æƒ…å†µ 2ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo mathvariant=\"normal\">â‰ </mo><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">j \\neq y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"inner\"><span class=\"mrel\">î€ </span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼ˆé”™è¯¯ç±»åˆ«ï¼‰</strong></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>s</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>âˆ’</mo><mfrac><mn>1</mn><msub><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mfrac><mo>â‹…</mo><mo stretchy=\"false\">(</mo><mo>âˆ’</mo><msub><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msub><msub><mi>p</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>p</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L_i}{\\partial s_j} = -\\frac{1}{p_{y_i}} \\cdot (-p_{y_i} p_j) = p_j\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.293548em;vertical-align:-0.972108em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">âˆ’</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<h2 id=\"step-3-è®¡ç®—-fracpartial-l_ipartial-w_dj\"><a class=\"anchor\" href=\"#step-3-è®¡ç®—-fracpartial-l_ipartial-w_dj\">#</a> Step 3: è®¡ç®— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>w</mi><mrow><mi>d</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L_i}{\\partial w_{dj}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.4442879999999998em;vertical-align:-0.5480799999999999em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8962079999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.02691em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29011428571428566em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4101em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5480799999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></h2>\n<p>ç”±äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mi>j</mi></msub><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></msubsup><msub><mi>x</mi><mrow><mi>i</mi><mi>d</mi></mrow></msub><msub><mi>w</mi><mrow><mi>d</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">s_j = \\sum_{d=1}^D x_{id} w_{dj}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2809409999999999em;vertical-align:-0.29971000000000003em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ‰€ä»¥ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>s</mi><mi>j</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>w</mi><mrow><mi>d</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial s_j}{\\partial w_{dj}} = x_{id}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>ä½¿ç”¨é“¾å¼æ³•åˆ™ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>w</mi><mrow><mi>d</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>s</mi><mi>j</mi></msub></mrow></mfrac><mo>â‹…</mo><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>s</mi><mi>j</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>w</mi><mrow><mi>d</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>s</mi><mi>j</mi></msub></mrow></mfrac><mo>â‹…</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L_i}{\\partial w_{dj}} = \\frac{\\partial L_i}{\\partial s_j} \\cdot \\frac{\\partial s_j}{\\partial w_{dj}} = \\frac{\\partial L_i}{\\partial s_j} \\cdot x_{id}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<div class=\"note info no-icon\">\n<p><strong>æœ€ç»ˆæ¢¯åº¦å…¬å¼ï¼š</strong></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>w</mi><mrow><mi>d</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.3599999999999999em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>d</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>j</mi></msub><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>ifÂ </mtext><mi>j</mi><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>d</mi></mrow></msub><mo>â‹…</mo><msub><mi>p</mi><mi>j</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>ifÂ </mtext><mi>j</mi><mo mathvariant=\"normal\">â‰ </mo><msub><mi>y</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L_i}{\\partial w_{dj}} = \\begin{cases} x_{id}(p_j - 1) &amp; \\text{if } j = y_i \\\\ x_{id} \\cdot p_j &amp; \\text{if } j \\neq y_i \\end{cases}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.343548em;vertical-align:-0.972108em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">ifÂ </span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">ifÂ </span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"inner\"><span class=\"mrel\">î€ </span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n</div>\n<h2 id=\"å‘é‡åŒ–è¡¨ç¤º\"><a class=\"anchor\" href=\"#å‘é‡åŒ–è¡¨ç¤º\">#</a> å‘é‡åŒ–è¡¨ç¤º</h2>\n<p>å¯¹äºæ•´ä¸ªæƒé‡çŸ©é˜µï¼Œå¯ä»¥å†™æˆï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>W</mi></mrow></mfrac><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âŠ—</mo><mo stretchy=\"false\">(</mo><mi>p</mi><mo>âˆ’</mo><msub><mi>e</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L_i}{\\partial W} = x_i \\otimes (p - e_{y_i})\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.05744em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âŠ—</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>å…¶ä¸­ï¼š</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âŠ—</mo></mrow><annotation encoding=\"application/x-tex\">\\otimes</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord\">âŠ—</span></span></span></span> æ˜¯å¤–ç§¯</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>p</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>p</mi><mi>C</mi></msub><msup><mo stretchy=\"false\">]</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">p = [p_1, p_2, ..., p_C]^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913309999999998em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span> æ˜¯æ¦‚ç‡å‘é‡</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>e</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mrow><annotation encoding=\"application/x-tex\">e_{y_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> æ˜¯ one-hot å‘é‡ï¼ˆåªæœ‰ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä½ä¸º 1ï¼‰</li>\n</ul>\n<h1 id=\"l2æ­£åˆ™åŒ–çš„æ¢¯åº¦è®¡ç®—\"><a class=\"anchor\" href=\"#l2æ­£åˆ™åŒ–çš„æ¢¯åº¦è®¡ç®—\">#</a> L2 æ­£åˆ™åŒ–çš„æ¢¯åº¦è®¡ç®—</h1>\n<p>å¯¹äºæ­£åˆ™åŒ–é¡¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î»</mi><msubsup><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></msubsup><msubsup><mi>w</mi><mrow><mi>d</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\lambda \\sum_{j=1}^C \\sum_{d=1}^D w_{dj}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.417049em;vertical-align:-0.43581800000000004em;\"></span><span class=\"mord mathnormal\">Î»</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.43581800000000004em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-2.4168920000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4192159999999999em;\"><span></span></span></span></span></span></span></span></span></span>ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mi mathvariant=\"normal\">âˆ‚</mi><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>w</mi><mrow><mi>d</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo stretchy=\"false\">(</mo><mi>Î»</mi><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><munderover><mo>âˆ‘</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></munderover><msubsup><mi>w</mi><mrow><mi>d</mi><mi>j</mi></mrow><mn>2</mn></msubsup><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><mi>Î»</mi><msub><mi>w</mi><mrow><mi>d</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial}{\\partial w_{dj}}(\\lambda \\sum_{j=1}^C \\sum_{d=1}^D w_{dj}^2) = 2\\lambda w_{dj}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.2421130000000007em;vertical-align:-1.4137769999999998em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.972108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Î»</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.302113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.864108em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.383108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.980548em;vertical-align:-0.286108em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">Î»</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<h2 id=\"å®Œæ•´æ¢¯åº¦å…¬å¼\"><a class=\"anchor\" href=\"#å®Œæ•´æ¢¯åº¦å…¬å¼\">#</a> å®Œæ•´æ¢¯åº¦å…¬å¼</h2>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>W</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>W</mi></mrow></mfrac><mo>+</mo><mn>2</mn><mi>Î»</mi><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L}{\\partial W} = \\frac{1}{N} \\sum_{i=1}^N \\frac{\\partial L_i}{\\partial W} + 2\\lambda W\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.05744em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106005em;vertical-align:-1.277669em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">Î»</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span></span></p>\n<h1 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ä»£ç å®ç°</h1>\n<h2 id=\"æœ´ç´ å®ç°å¾ªç¯ç‰ˆæœ¬\"><a class=\"anchor\" href=\"#æœ´ç´ å®ç°å¾ªç¯ç‰ˆæœ¬\">#</a> æœ´ç´ å®ç°ï¼ˆå¾ªç¯ç‰ˆæœ¬ï¼‰</h2>\n<figure class=\"highlight python\"><figcaption><span>SoftmaxæŸå¤±å‡½æ•°æœ´ç´ å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">softmax_loss_naive</span>(<span class=\"params\">W, X, y, reg</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    Softmax loss function, naive implementation (with loops)</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    è¾“å…¥ç»´åº¦ Dï¼Œç±»åˆ«æ•° Cï¼Œå°æ‰¹é‡æ ·æœ¬æ•° N</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    å‚æ•°:</span></span><br><span class=\"line\"><span class=\"string\">    - W: æƒé‡çŸ©é˜µï¼Œå½¢çŠ¶ (D, C)</span></span><br><span class=\"line\"><span class=\"string\">    - X: è¾“å…¥æ•°æ®ï¼Œå½¢çŠ¶ (N, D) </span></span><br><span class=\"line\"><span class=\"string\">    - y: æ ‡ç­¾ï¼Œå½¢çŠ¶ (N,)ï¼Œy[i] = c è¡¨ç¤º X[i] çš„æ ‡ç­¾ä¸º c</span></span><br><span class=\"line\"><span class=\"string\">    - reg: æ­£åˆ™åŒ–å¼ºåº¦</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    è¿”å›:</span></span><br><span class=\"line\"><span class=\"string\">    - loss: æ ‡é‡æŸå¤±å€¼</span></span><br><span class=\"line\"><span class=\"string\">    - gradient: æƒé‡æ¢¯åº¦ï¼Œå½¢çŠ¶ä¸ W ç›¸åŒ</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"comment\"># åˆå§‹åŒ–æŸå¤±å’Œæ¢¯åº¦</span></span><br><span class=\"line\">    loss = <span class=\"number\">0.0</span></span><br><span class=\"line\">    dW = np.zeros_like(W)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># è®¡ç®—æŸå¤±å’Œæ¢¯åº¦</span></span><br><span class=\"line\">    num_classes = W.shape[<span class=\"number\">1</span>]</span><br><span class=\"line\">    num_train = X.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(num_train):</span><br><span class=\"line\">        scores = X[i].dot(W)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># æ•°å€¼ç¨³å®šçš„æ¦‚ç‡è®¡ç®—</span></span><br><span class=\"line\">        scores -= np.<span class=\"built_in\">max</span>(scores)  <span class=\"comment\"># é˜²æ­¢æŒ‡æ•°æº¢å‡º</span></span><br><span class=\"line\">        p = np.exp(scores)</span><br><span class=\"line\">        p /= p.<span class=\"built_in\">sum</span>()  <span class=\"comment\"># å½’ä¸€åŒ–</span></span><br><span class=\"line\">        logp = np.log(p)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># è®¡ç®—äº¤å‰ç†µæŸå¤±</span></span><br><span class=\"line\">        loss -= logp[y[i]]  <span class=\"comment\"># è´Ÿå¯¹æ•°ä¼¼ç„¶</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># è®¡ç®—æ¢¯åº¦</span></span><br><span class=\"line\">        dW += np.outer(X[i], p)  <span class=\"comment\"># æ‰€æœ‰ç±»åˆ«çš„è´¡çŒ®</span></span><br><span class=\"line\">        dW[:, y[i]] -= X[i]  <span class=\"comment\"># å‡å»æ­£ç¡®ç±»åˆ«çš„è´¡çŒ®</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># å½’ä¸€åŒ–æŸå¤±å’Œæ¢¯åº¦ï¼ŒåŠ å…¥L2æ­£åˆ™åŒ–</span></span><br><span class=\"line\">    loss = loss / num_train + reg * np.<span class=\"built_in\">sum</span>(W * W)</span><br><span class=\"line\">    dW = dW / num_train + <span class=\"number\">2</span> * reg * W</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> loss, dW</span><br></pre></td></tr></table></figure>\n<details class=\"info\"><summary>éšæœºæ¢¯åº¦ä¸‹é™SGDè¯¦ç»†è¯´æ˜</summary><div>\n<p>éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic Gradient Descent, SGDï¼‰æ˜¯ä¸€ç§ä¼˜åŒ–ç®—æ³•ï¼Œé€šè¿‡éšæœºé€‰å–å°æ‰¹é‡æ ·æœ¬æ¥æ›´æ–°æ¨¡å‹å‚æ•°ã€‚</p>\n<p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong></p>\n<ul>\n<li>æ¯æ¬¡è¿­ä»£åªä½¿ç”¨å°æ‰¹é‡æ ·æœ¬è®¡ç®—æ¢¯åº¦ï¼Œè€Œéå…¨éƒ¨è®­ç»ƒæ•°æ®</li>\n<li>é€šè¿‡éšæœºæ€§å¼•å…¥å™ªå£°ï¼Œæœ‰åŠ©äºè·³å‡ºå±€éƒ¨æœ€ä¼˜è§£</li>\n<li>è®¡ç®—æ•ˆç‡é«˜ï¼Œé€‚åˆå¤§è§„æ¨¡æ•°æ®é›†</li>\n</ul>\n<p><strong>ç®—æ³•æ­¥éª¤ï¼š</strong></p>\n<ol>\n<li>éšæœºé€‰æ‹© batch_size ä¸ªæ ·æœ¬</li>\n<li>è®¡ç®—è¯¥æ‰¹æ¬¡çš„æŸå¤±å’Œæ¢¯åº¦</li>\n<li>æ›´æ–°å‚æ•°ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo>â†</mo><mi>W</mi><mo>âˆ’</mo><mi>Î±</mi><mi mathvariant=\"normal\">âˆ‡</mi><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">W \\leftarrow W - \\alpha \\nabla L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">â†</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span><span class=\"mord\">âˆ‡</span><span class=\"mord mathnormal\">L</span></span></span></span></li>\n<li>é‡å¤ç›´è‡³æ”¶æ•›</li>\n</ol>\n<p><strong>ä¼˜åŠ¿ï¼š</strong></p>\n<ul>\n<li><strong>è®¡ç®—æ•ˆç‡</strong>ï¼šæ¯æ¬¡è¿­ä»£è®¡ç®—é‡å°</li>\n<li><strong>å†…å­˜å‹å¥½</strong>ï¼šä¸éœ€è¦åŠ è½½å…¨éƒ¨æ•°æ®</li>\n<li><strong>æ³›åŒ–æ€§èƒ½</strong>ï¼šéšæœºæ€§æœ‰åŠ©äºé¿å…è¿‡æ‹Ÿåˆ</li>\n</ul>\n<p><strong>è¶…å‚æ•°è°ƒèŠ‚ï¼š</strong></p>\n<ul>\n<li><strong>å­¦ä¹ ç‡</strong>ï¼šæ§åˆ¶å‚æ•°æ›´æ–°æ­¥é•¿</li>\n<li><strong>æ‰¹æ¬¡å¤§å°</strong>ï¼šå¹³è¡¡è®¡ç®—æ•ˆç‡ä¸æ¢¯åº¦ä¼°è®¡ç²¾åº¦</li>\n</ul>\n</div></details>\n<h2 id=\"è®­ç»ƒè¿‡ç¨‹å®ç°\"><a class=\"anchor\" href=\"#è®­ç»ƒè¿‡ç¨‹å®ç°\">#</a> è®­ç»ƒè¿‡ç¨‹å®ç°</h2>\n<figure class=\"highlight python\"><figcaption><span>SGDè®­ç»ƒè¿‡ç¨‹</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">train</span>(<span class=\"params\">self, X, y, learning_rate=<span class=\"number\">1e-3</span>, reg=<span class=\"number\">1e-5</span>, num_iters=<span class=\"number\">100</span>, batch_size=<span class=\"number\">200</span>, verbose=<span class=\"literal\">False</span></span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™è®­ç»ƒçº¿æ€§åˆ†ç±»å™¨</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    å‚æ•°:</span></span><br><span class=\"line\"><span class=\"string\">    - X: è®­ç»ƒæ•°æ®ï¼Œå½¢çŠ¶ (N, D)</span></span><br><span class=\"line\"><span class=\"string\">    - y: è®­ç»ƒæ ‡ç­¾ï¼Œå½¢çŠ¶ (N,)</span></span><br><span class=\"line\"><span class=\"string\">    - learning_rate: å­¦ä¹ ç‡</span></span><br><span class=\"line\"><span class=\"string\">    - reg: æ­£åˆ™åŒ–å¼ºåº¦</span></span><br><span class=\"line\"><span class=\"string\">    - num_iters: è¿­ä»£æ¬¡æ•°</span></span><br><span class=\"line\"><span class=\"string\">    - batch_size: æ‰¹æ¬¡å¤§å°</span></span><br><span class=\"line\"><span class=\"string\">    - verbose: æ˜¯å¦æ‰“å°è®­ç»ƒè¿‡ç¨‹</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    è¿”å›:</span></span><br><span class=\"line\"><span class=\"string\">    - loss_history: æ¯æ¬¡è¿­ä»£çš„æŸå¤±å€¼åˆ—è¡¨</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    num_train, dim = X.shape</span><br><span class=\"line\">    num_classes = np.<span class=\"built_in\">max</span>(y) + <span class=\"number\">1</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"variable language_\">self</span>.W <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">        <span class=\"comment\"># éšæœºåˆå§‹åŒ–æƒé‡</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.W = <span class=\"number\">0.001</span> * np.random.randn(dim, num_classes)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># è¿è¡Œéšæœºæ¢¯åº¦ä¸‹é™</span></span><br><span class=\"line\">    loss_history = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> it <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(num_iters):</span><br><span class=\"line\">        <span class=\"comment\"># éšæœºé‡‡æ ·æ‰¹æ¬¡æ•°æ®</span></span><br><span class=\"line\">        indices = np.random.choice(num_train, batch_size, replace=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        X_batch = X[indices]</span><br><span class=\"line\">        y_batch = y[indices]</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># è®¡ç®—æŸå¤±å’Œæ¢¯åº¦</span></span><br><span class=\"line\">        loss, grad = <span class=\"variable language_\">self</span>.loss(X_batch, y_batch, reg)</span><br><span class=\"line\">        loss_history.append(loss)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># å‚æ•°æ›´æ–°</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.W -= learning_rate * grad</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">if</span> verbose <span class=\"keyword\">and</span> it % <span class=\"number\">100</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&quot;iteration %d / %d: loss %f&quot;</span> % (it, num_iters, loss))</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> loss_history</span><br></pre></td></tr></table></figure>\n<h2 id=\"é¢„æµ‹å®ç°\"><a class=\"anchor\" href=\"#é¢„æµ‹å®ç°\">#</a> é¢„æµ‹å®ç°</h2>\n<figure class=\"highlight python\"><figcaption><span>é¢„æµ‹å‡½æ•°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">predict</span>(<span class=\"params\">self, X</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    ä½¿ç”¨è®­ç»ƒå¥½çš„æƒé‡é¢„æµ‹æ•°æ®æ ‡ç­¾</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    å‚æ•°:</span></span><br><span class=\"line\"><span class=\"string\">    - X: æµ‹è¯•æ•°æ®ï¼Œå½¢çŠ¶ (N, D)</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    è¿”å›:</span></span><br><span class=\"line\"><span class=\"string\">    - y_pred: é¢„æµ‹æ ‡ç­¾ï¼Œå½¢çŠ¶ (N,)</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    scores = X.dot(<span class=\"variable language_\">self</span>.W)  <span class=\"comment\"># è®¡ç®—å¾—åˆ†</span></span><br><span class=\"line\">    y_pred = np.argmax(scores, axis=<span class=\"number\">1</span>)  <span class=\"comment\"># é€‰æ‹©æœ€é«˜å¾—åˆ†çš„ç±»åˆ«</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> y_pred</span><br></pre></td></tr></table></figure>\n<h1 id=\"è¶…å‚æ•°è°ƒä¼˜\"><a class=\"anchor\" href=\"#è¶…å‚æ•°è°ƒä¼˜\">#</a> è¶…å‚æ•°è°ƒä¼˜</h1>\n<p>æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ€§èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºè¶…å‚æ•°çš„é€‰æ‹©ã€‚å¯¹äº Softmax åˆ†ç±»å™¨ï¼Œä¸»è¦çš„è¶…å‚æ•°åŒ…æ‹¬å­¦ä¹ ç‡å’Œæ­£åˆ™åŒ–å¼ºåº¦ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>ç½‘æ ¼æœç´¢è¶…å‚æ•°è°ƒä¼˜</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># è¶…å‚æ•°å€™é€‰å€¼</span></span><br><span class=\"line\">learning_rates = [<span class=\"number\">5e-8</span>, <span class=\"number\">1e-7</span>, <span class=\"number\">5e-7</span>, <span class=\"number\">1e-6</span>, <span class=\"number\">5e-6</span>] </span><br><span class=\"line\">regularization_strengths = [<span class=\"number\">1e3</span>, <span class=\"number\">5e3</span>, <span class=\"number\">1e4</span>, <span class=\"number\">2.5e4</span>, <span class=\"number\">5e4</span>, <span class=\"number\">1e5</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">best_val = -<span class=\"number\">1</span></span><br><span class=\"line\">best_softmax = <span class=\"literal\">None</span></span><br><span class=\"line\">results = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç½‘æ ¼æœç´¢</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> lr <span class=\"keyword\">in</span> learning_rates:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> reg <span class=\"keyword\">in</span> regularization_strengths:</span><br><span class=\"line\">        softmax = Softmax()</span><br><span class=\"line\">        softmax.train(X_train, y_train, learning_rate=lr, reg=reg, num_iters=<span class=\"number\">150</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># è¯„ä¼°æ€§èƒ½</span></span><br><span class=\"line\">        y_train_pred = softmax.predict(X_train)</span><br><span class=\"line\">        train_accuracy = np.mean(y_train == y_train_pred)</span><br><span class=\"line\">        y_val_pred = softmax.predict(X_val)</span><br><span class=\"line\">        val_accuracy = np.mean(y_val == y_val_pred)</span><br><span class=\"line\">        </span><br><span class=\"line\">        results[(lr, reg)] = (train_accuracy, val_accuracy)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># ä¿å­˜æœ€ä½³æ¨¡å‹</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> val_accuracy &gt; best_val:</span><br><span class=\"line\">            best_val = val_accuracy</span><br><span class=\"line\">            best_softmax = softmax</span><br></pre></td></tr></table></figure>\n<div class=\"note warning no-icon\">\n<p><strong>è°ƒä¼˜æ³¨æ„äº‹é¡¹ï¼š</strong> è¶…å‚æ•°è°ƒä¼˜æ—¶åº”ä½¿ç”¨éªŒè¯é›†è€Œéæµ‹è¯•é›†æ¥é€‰æ‹©æœ€ä½³å‚æ•°ï¼Œé¿å…åœ¨æµ‹è¯•é›†ä¸Šè¿‡æ‹Ÿåˆã€‚</p>\n</div>\n<h1 id=\"ç†è®ºé—®é¢˜åˆ†æ\"><a class=\"anchor\" href=\"#ç†è®ºé—®é¢˜åˆ†æ\">#</a> ç†è®ºé—®é¢˜åˆ†æ</h1>\n<h2 id=\"svmä¸softmaxæŸå¤±å‡½æ•°çš„å¯¹æ¯”\"><a class=\"anchor\" href=\"#svmä¸softmaxæŸå¤±å‡½æ•°çš„å¯¹æ¯”\">#</a> SVM ä¸ Softmax æŸå¤±å‡½æ•°çš„å¯¹æ¯”</h2>\n<p><strong>Question:</strong> æ˜¯å¦å¯èƒ½å‘è®­ç»ƒé›†æ·»åŠ ä¸€ä¸ªæ–°æ•°æ®ç‚¹ï¼Œè¯¥ç‚¹ä¼šæ”¹å˜ softmax æŸå¤±ï¼Œä½†ä¿æŒ SVM æŸå¤±ä¸å˜ï¼Ÿ</p>\n<p><strong>Answer:</strong> <strong>æ˜¯</strong></p>\n<details class=\"info\"><summary>SVMæŸå¤±å‡½æ•°è¯¦ç»†è¯´æ˜</summary><div>\n<p>æ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰æŸå¤±å‡½æ•°ä½¿ç”¨ hinge loss æ¥å¤„ç†å¤šåˆ†ç±»é—®é¢˜ã€‚å…¶æ•°å­¦å½¢å¼ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo mathvariant=\"normal\">â‰ </mo><msub><mi>y</mi><mi>i</mi></msub></mrow></munder><mi>max</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><msub><mi>s</mi><mi>j</mi></msub><mo>âˆ’</mo><msub><mi>s</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>+</mo><mi mathvariant=\"normal\">Î”</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L_i = \\sum_{j \\neq y_i} \\max(0, s_j - s_{y_i} + \\Delta)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.488226em;vertical-align:-1.438221em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\"><span class=\"mrel mtight\"><span class=\"mord vbox mtight\"><span class=\"thinbox mtight\"><span class=\"rlap mtight\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"inner\"><span class=\"mrel mtight\">î€ </span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel mtight\">=</span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.438221em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8694379999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">Î”</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>å…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Î”</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Î”</span></span></span></span> æ˜¯é—´éš”å‚æ•°ï¼Œé€šå¸¸è®¾ä¸º 1ã€‚</p>\n<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>\n<ul>\n<li><strong>é—´éš”æœ€å¤§åŒ–</strong>ï¼šè¦æ±‚æ­£ç¡®ç±»åˆ«å¾—åˆ†æ¯”é”™è¯¯ç±»åˆ«å¾—åˆ†è‡³å°‘é«˜å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Î”</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Î”</span></span></span></span></li>\n<li><strong>ç¨€ç–æ€§</strong>ï¼šåªæœ‰ &quot;éš¾åˆ†ç±»&quot; çš„æ ·æœ¬å¯¹æŸå¤±æœ‰è´¡çŒ®</li>\n<li><strong>é²æ£’æ€§</strong>ï¼šå¯¹å¼‚å¸¸å€¼ç›¸å¯¹ä¸æ•æ„Ÿ</li>\n</ul>\n<p><strong>ä¸ Softmax çš„åŒºåˆ«ï¼š</strong></p>\n<ul>\n<li>SVM å…³æ³¨åˆ†ç±»è¾¹ç•Œï¼ŒSoftmax å…³æ³¨æ¦‚ç‡åˆ†å¸ƒ</li>\n<li>SVM æŸå¤±åœ¨æ»¡è¶³é—´éš”æ¡ä»¶æ—¶ä¸º 0ï¼ŒSoftmax æŸå¤±æ°¸è¿œå¤§äº 0</li>\n<li>SVM é€‚åˆå°æ ·æœ¬ï¼ŒSoftmax é€‚åˆå¤§è§„æ¨¡æ•°æ®</li>\n</ul>\n</div></details>\n<h3 id=\"åŸå› åˆ†æ\"><a class=\"anchor\" href=\"#åŸå› åˆ†æ\">#</a> åŸå› åˆ†æ</h3>\n<p>SVM æŸå¤±å’Œ softmax æŸå¤±å¯¹åˆ†ç±»ç»“æœçš„æ•æ„Ÿåº¦ä¸åŒï¼š</p>\n<ol>\n<li>\n<p><strong>SVM æŸå¤±</strong></p>\n<ul>\n<li>ä½¿ç”¨ hinge lossï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi>j</mi><mo mathvariant=\"normal\">â‰ </mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msub><mi>max</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><msub><mi>s</mi><mi>j</mi></msub><mo>âˆ’</mo><msub><mi>s</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>+</mo><mi mathvariant=\"normal\">Î”</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L_i = \\sum_{j \\neq y_i} \\max(0, s_j - s_{y_i} + \\Delta)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.185818em;vertical-align:-0.43581800000000004em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.18639799999999984em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\"><span class=\"mrel mtight\"><span class=\"mord vbox mtight\"><span class=\"thinbox mtight\"><span class=\"rlap mtight\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"inner\"><span class=\"mrel mtight\">î€ </span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel mtight\">=</span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.43581800000000004em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8694379999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">Î”</span><span class=\"mclose\">)</span></span></span></span></li>\n<li><strong>å…³é”®ç‰¹æ€§</strong>ï¼šå½“æ­£ç¡®ç±»åˆ«çš„å¾—åˆ†æ»¡è¶³ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>â‰¥</mo><msub><mi>s</mi><mi>j</mi></msub><mo>+</mo><mi mathvariant=\"normal\">Î”</mi></mrow><annotation encoding=\"application/x-tex\">s_{y_i} \\geq s_j + \\Delta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.922078em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">â‰¥</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8694379999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Î”</span></span></span></span>ï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ€</mi><mi>j</mi><mo mathvariant=\"normal\">â‰ </mo><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\forall j \\neq y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\">âˆ€</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"inner\"><span class=\"mrel\">î€ </span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼‰æ—¶ï¼ŒæŸå¤±å€¼ä¸º <strong>0</strong></li>\n<li>è‹¥æ–°æ•°æ®ç‚¹å·²è¢«å……åˆ†æ­£ç¡®åˆ†ç±»ï¼Œæ·»åŠ è¯¥ç‚¹ä¸ä¼šæ”¹å˜ SVM æ€»æŸå¤±</li>\n</ul>\n</li>\n<li>\n<p><strong>Softmax æŸå¤±</strong></p>\n<ul>\n<li>ä½¿ç”¨äº¤å‰ç†µï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mo>âˆ’</mo><mi>log</mi><mo>â¡</mo><mrow><mo fence=\"true\">(</mo><mfrac><msup><mi>e</mi><msub><mi>s</mi><msub><mi>y</mi><mi>i</mi></msub></msub></msup><mrow><msub><mo>âˆ‘</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>s</mi><mi>j</mi></msub></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">L_i = -\\log\\left(\\frac{e^{s_{y_i}}}{\\sum_j e^{s_j}}\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.827512em;vertical-align:-0.677512em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.942065em;\"><span style=\"top:-2.6447149999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mop op-symbol small-op mtight\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.14964714285714287em;\"><span style=\"top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.46032428571428574em;\"><span></span></span></span></span></span></span><span class=\"mspace mtight\" style=\"margin-right:0.19516666666666668em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7789785714285715em;\"><span style=\"top:-2.9714357142857146em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3448em;margin-left:0em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.65952em;\"></span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5091600000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.78295em;\"><span style=\"top:-2.975407142857143em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.23055999999999988em;\"><span style=\"top:-2.3em;margin-left:0em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3448em;margin-left:-0.03588em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.65952em;\"></span><span class=\"mord mathnormal mtight\">i</span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31472em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5147200000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.677512em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span></span></li>\n<li><strong>å…³é”®ç‰¹æ€§</strong>ï¼šå³ä½¿æ•°æ®ç‚¹è¢«æ­£ç¡®åˆ†ç±»ï¼Œåªè¦æ¦‚ç‡æœªè¾¾åˆ° 1ï¼ŒæŸå¤±å€¼ä»å¤§äº 0</li>\n<li>æ·»åŠ æ–°ç‚¹æ€»ä¼šæ”¹å˜ softmax æ€»æŸå¤±</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"ç¤ºä¾‹è¯´æ˜\"><a class=\"anchor\" href=\"#ç¤ºä¾‹è¯´æ˜\">#</a> ç¤ºä¾‹è¯´æ˜</h3>\n<p>å‡è®¾å½“å‰è®­ç»ƒé›†æŸå¤±ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>ï¼Œæ·»åŠ ä¸€ä¸ªå……åˆ†æ­£ç¡®åˆ†ç±»çš„æ–°ç‚¹ï¼š</p>\n<div class=\"tab\" data-id=\"comparison\" data-title=\"SVMæŸå¤±å˜åŒ–\">\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>æ–°æŸå¤±</mtext><mo>=</mo><mi>L</mi><mo>+</mo><munder><munder><mn>0</mn><mo stretchy=\"true\">âŸ</mo></munder><mtext>æ–°ç‚¹è´¡çŒ®</mtext></munder><mo>=</mo><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">\\text{æ–°æŸå¤±} = L + \\underbrace{0}_{\\text{æ–°ç‚¹è´¡çŒ®}} = L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">æ–°æŸå¤±</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.970771em;vertical-align:-1.3263310000000001em;\"></span><span class=\"mord munder\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6444399999999999em;\"><span style=\"top:-1.6736689999999999em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord cjk_fallback mtight\">æ–°ç‚¹è´¡çŒ®</span></span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord munder\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.64444em;\"><span class=\"svg-align\" style=\"top:-2.352em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\"><span class=\"brace-left\" style=\"height:0.548em;\"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class=\"brace-center\" style=\"height:0.548em;\"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class=\"brace-right\" style=\"height:0.548em;\"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.648em;\"><span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3263310000000001em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>ï¼ˆ<strong>ä¸å˜</strong>ï¼‰</p>\n</div>\n<div class=\"tab\" data-id=\"comparison\" data-title=\"SoftmaxæŸå¤±å˜åŒ–\">\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>æ–°æŸå¤±</mtext><mo>=</mo><mi>L</mi><mo>+</mo><munder><munder><mrow><mo>&gt;</mo><mn>0</mn></mrow><mo stretchy=\"true\">âŸ</mo></munder><mtext>æ–°ç‚¹äº¤å‰ç†µ</mtext></munder><mo>&gt;</mo><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">\\text{æ–°æŸå¤±} = L + \\underbrace{&gt;0}_{\\text{æ–°ç‚¹äº¤å‰ç†µ}} &gt; L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">æ–°æŸå¤±</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.009871em;vertical-align:-1.365431em;\"></span><span class=\"mord munder\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6444399999999999em;\"><span style=\"top:-1.634569em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord cjk_fallback mtight\">æ–°ç‚¹äº¤å‰ç†µ</span></span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord munder\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.64444em;\"><span class=\"svg-align\" style=\"top:-2.3129em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\"><span class=\"brace-left\" style=\"height:0.548em;\"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class=\"brace-center\" style=\"height:0.548em;\"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class=\"brace-right\" style=\"height:0.548em;\"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6871em;\"><span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.365431em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>ï¼ˆ<strong>å¢åŠ </strong>ï¼‰</p>\n</div>\n<h2 id=\"svmæ¢¯åº¦æ£€éªŒä¸­çš„æ•°å€¼é—®é¢˜\"><a class=\"anchor\" href=\"#svmæ¢¯åº¦æ£€éªŒä¸­çš„æ•°å€¼é—®é¢˜\">#</a> SVM æ¢¯åº¦æ£€éªŒä¸­çš„æ•°å€¼é—®é¢˜</h2>\n<p><strong>Question:</strong> SVM æŸå¤±çš„æ¢¯åº¦æ£€éªŒå¶å°”å¤±è´¥çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</p>\n<p><strong>Answer:</strong> SVM æŸå¤±å‡½æ•°åœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>max</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mo>â‹…</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\max(0, \\cdot)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">â‹…</span><span class=\"mclose\">)</span></span></span></span> çš„ä¸å¯å¯¼ç‚¹å¯¼è‡´æ¢¯åº¦æœªå®šä¹‰ã€‚</p>\n<h3 id=\"é—®é¢˜æ ¹æº\"><a class=\"anchor\" href=\"#é—®é¢˜æ ¹æº\">#</a> é—®é¢˜æ ¹æº</h3>\n<ol>\n<li><strong>æ•°å­¦åŸå› </strong>ï¼šSVM æŸå¤±åœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mi>j</mi></msub><mo>âˆ’</mo><msub><mi>s</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>+</mo><mi mathvariant=\"normal\">Î”</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">s_j - s_{y_i} + \\Delta = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8694379999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8694379999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Î”</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span> æ—¶ä¸å¯å¾®</li>\n<li><strong>å®ç°å·®å¼‚</strong>ï¼šæ¢¯åº¦æ£€æŸ¥ä½¿ç”¨æ•°å€¼è¿‘ä¼¼ï¼Œä»£ç å®ç°ä½¿ç”¨æ¬¡æ¢¯åº¦</li>\n<li><strong>è¾¹ç•Œæ•ˆåº”</strong>ï¼šå½“æ•°æ®ç‚¹ä½äºå†³ç­–è¾¹ç•Œæ—¶ï¼Œä¸¤ç§æ–¹æ³•å¯èƒ½ç»™å‡ºä¸åŒç»“æœ</li>\n</ol>\n<h3 id=\"ä¸€ç»´ç¤ºä¾‹\"><a class=\"anchor\" href=\"#ä¸€ç»´ç¤ºä¾‹\">#</a> ä¸€ç»´ç¤ºä¾‹</h3>\n<p>å‡è®¾äºŒåˆ†ç±»é—®é¢˜ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">s = [s_1, s_2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">y_i=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Î”</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\Delta=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Î”</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼š</p>\n<p><strong>æŸå¤±å‡½æ•°</strong>ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L_i = \\max(0, s_2 - s_1 + 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></p>\n<p><strong>è§£ææ¢¯åº¦</strong>ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>s</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.3599999999999999em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>ifÂ </mtext><msub><mi>s</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L_i}{\\partial s_1} = \\begin{cases} -1 &amp; \\text{if } s_2 - s_1 + 1 &gt; 0 \\\\ 0 &amp; \\text{otherwise} \\end{cases}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.20744em;vertical-align:-0.8360000000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.3139999999999996em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">âˆ’</span><span class=\"mord\">1</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">ifÂ </span></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">otherwise</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p><strong>å¤±è´¥åœºæ™¯</strong>ï¼šå½“ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">s_2 - s_1 + 1 = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span> æ—¶</p>\n<ul>\n<li>è§£ææ¢¯åº¦ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(0, 0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span></li>\n<li>æ•°å€¼æ¢¯åº¦ï¼šå¯èƒ½ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(0, 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></li>\n</ul>\n<h3 id=\"é—´éš”å‚æ•°çš„å½±å“\"><a class=\"anchor\" href=\"#é—´éš”å‚æ•°çš„å½±å“\">#</a> é—´éš”å‚æ•°çš„å½±å“</h3>\n<ul>\n<li><strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Î”</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Î”</span></span></span></span> å¢å¤§</strong>ï¼šå†³ç­–è¾¹ç•Œè¿œç¦»æ•°æ®ç‚¹ï¼Œè¾¹ç•Œç‚¹å‡å°‘ï¼Œå¤±è´¥é¢‘ç‡é™ä½</li>\n<li><strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Î”</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Î”</span></span></span></span> å‡å°</strong>ï¼šæ›´å¤šç‚¹ä½äºè¾¹ç•Œé™„è¿‘ï¼Œå¤±è´¥é¢‘ç‡å¢åŠ </li>\n</ul>\n<div class=\"note info no-icon\">\n<p><strong>å¤„ç†å»ºè®®ï¼š</strong> å¢åŠ æ¢¯åº¦æ£€æŸ¥å®¹å·®ï¼Œå¤šæ¬¡éšæœºæµ‹è¯•ï¼Œè¿™ç§ä¸ä¸€è‡´æ˜¯ SVM æ•°å­¦æ€§è´¨å¯¼è‡´çš„æ­£å¸¸ç°è±¡ã€‚</p>\n</div>\n",
            "tags": [
                "å­¦ä¹ ç¬”è®°",
                "æœºå™¨å­¦ä¹ ",
                "ä»£ç å®ç°",
                "cs231n",
                "assignment1",
                "æ¢¯åº¦ä¸‹é™",
                "æŸå¤±å‡½æ•°",
                "SGD",
                "æ·±åº¦å­¦ä¹ ",
                "softmax",
                "cs231n",
                "SVM",
                "æ­£åˆ™åŒ–",
                "å¤šåˆ†ç±»"
            ]
        },
        {
            "id": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/cs231n%E7%9A%84assignment1%EF%BC%9AKNN/",
            "url": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/cs231n%E7%9A%84assignment1%EF%BC%9AKNN/",
            "title": "cs231nçš„assignment1ï¼šKNN",
            "date_published": "2025-07-20T08:16:40.000Z",
            "content_html": "<h1 id=\"k-æœ€è¿‘é‚»ç®—æ³•åŸºç¡€\"><a class=\"anchor\" href=\"#k-æœ€è¿‘é‚»ç®—æ³•åŸºç¡€\">#</a> K æœ€è¿‘é‚»ç®—æ³•åŸºç¡€</h1>\n<p>K æœ€è¿‘é‚»ï¼ˆK-Nearest Neighbors, KNNï¼‰æ˜¯ä¸€ç§åŸºæœ¬çš„åˆ†ç±»å’Œå›å½’ç®—æ³•ã€‚è¯¥ç®—æ³•åŸºäº &quot;ç›¸ä¼¼çš„æ ·æœ¬å…·æœ‰ç›¸ä¼¼çš„ç±»åˆ«&quot; è¿™ä¸€å‡è®¾ï¼Œé€šè¿‡å¯»æ‰¾æµ‹è¯•æ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„ k ä¸ªæœ€è¿‘é‚»å±…æ¥è¿›è¡Œé¢„æµ‹ã€‚</p>\n<details class=\"info\"><summary>KNN ç®—æ³•è¯¦è§£</summary><div>\n<p>KNN ç®—æ³•æ˜¯ä¸€ç§<strong>æƒ°æ€§å­¦ä¹ </strong>ï¼ˆlazy learningï¼‰æ–¹æ³•ï¼Œå³åœ¨è®­ç»ƒé˜¶æ®µä¸è¿›è¡Œä»»ä½•è®¡ç®—ï¼Œä»…å­˜å‚¨è®­ç»ƒæ•°æ®ã€‚é¢„æµ‹æ—¶ï¼Œé€šè¿‡è®¡ç®—æµ‹è¯•æ ·æœ¬ä¸æ‰€æœ‰è®­ç»ƒæ ·æœ¬çš„è·ç¦»ï¼Œé€‰æ‹©è·ç¦»æœ€è¿‘çš„ k ä¸ªæ ·æœ¬ï¼Œå¹¶æ ¹æ®è¿™ k ä¸ªæ ·æœ¬çš„æ ‡ç­¾è¿›è¡ŒæŠ•ç¥¨å†³å®šæµ‹è¯•æ ·æœ¬çš„ç±»åˆ«ã€‚</p>\n<p>ç®—æ³•ç‰¹ç‚¹ï¼š</p>\n<ul>\n<li><strong>éå‚æ•°æ–¹æ³•</strong>ï¼šä¸å¯¹æ•°æ®åˆ†å¸ƒåšä»»ä½•å‡è®¾</li>\n<li><strong>å±€éƒ¨æ•æ„Ÿ</strong>ï¼šä¸»è¦å—é‚»è¿‘æ ·æœ¬å½±å“</li>\n<li><strong>è®¡ç®—ç®€å•</strong>ï¼šåŸç†ç›´è§‚ï¼Œæ˜“äºç†è§£å’Œå®ç°</li>\n<li><strong>å¯¹å™ªå£°æ•æ„Ÿ</strong>ï¼šå¼‚å¸¸ç‚¹å¯èƒ½å½±å“åˆ†ç±»ç»“æœ</li>\n</ul>\n</div></details>\n<h1 id=\"è·ç¦»åº¦é‡æ–¹æ³•\"><a class=\"anchor\" href=\"#è·ç¦»åº¦é‡æ–¹æ³•\">#</a> è·ç¦»åº¦é‡æ–¹æ³•</h1>\n<p>è·ç¦»è®¡ç®—æ˜¯ KNN ç®—æ³•çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ã€‚ä¸åŒçš„è·ç¦»åº¦é‡æ–¹å¼ä¼šç›´æ¥å½±å“ç®—æ³•çš„æ€§èƒ½è¡¨ç°ã€‚</p>\n<h2 id=\"æ¬§å‡ é‡Œå¾—è·ç¦»è®¡ç®—\"><a class=\"anchor\" href=\"#æ¬§å‡ é‡Œå¾—è·ç¦»è®¡ç®—\">#</a> æ¬§å‡ é‡Œå¾—è·ç¦»è®¡ç®—</h2>\n<p>åœ¨åŒå¾ªç¯å®ç°ä¸­ï¼Œè®¡ç®—æµ‹è¯•æ ·æœ¬å’Œè®­ç»ƒæ ·æœ¬ä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼š</p>\n<figure class=\"highlight python\"><figcaption><span>æ¬§å‡ é‡Œå¾—è·ç¦»è®¡ç®—</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dists[i, j] = np.sqrt(np.<span class=\"built_in\">sum</span>((X[i] - <span class=\"variable language_\">self</span>.X_train[j]) ** <span class=\"number\">2</span>))</span><br></pre></td></tr></table></figure>\n<p>è¯¥å…¬å¼è®¡ç®—æµ‹è¯•æ ·æœ¬  <code>X[i]</code>  ä¸è®­ç»ƒæ ·æœ¬  <code>self.X_train[j]</code>  ä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œå³ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msqrt><mrow><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>âˆ’</mo><msub><mi>x</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">d(x_i, x_j) = \\sqrt{\\sum_{k=1}^{n}(x_{ik} - x_{jk})^2}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.1812600000000004em;vertical-align:-1.302113em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8791470000000003em;\"><span class=\"svg-align\" style=\"top:-5.141260000000001em;\"><span class=\"pstrut\" style=\"height:5.141260000000001em;\"></span><span class=\"mord\" style=\"padding-left:1.056em;\"><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.302113em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.8391470000000005em;\"><span class=\"pstrut\" style=\"height:5.141260000000001em;\"></span><span class=\"hide-tail\" style=\"min-width:0.742em;height:3.2212600000000005em;\"><svg width='400em' height='3.2212600000000005em' viewBox='0 0 400000 3221' preserveAspectRatio='xMinYMin slice'><path d='M702 80H40000040\nH742v3087l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\n219 661 l218 661zM702 80H400000v40H742z'/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.302113em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>å…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> æ˜¯ç‰¹å¾ç»´åº¦ã€‚</p>\n<details class=\"warning\"><summary>L1 è·ç¦»è¯¦è§£</summary><div>\n<p>L1 è·ç¦»ï¼ˆæ›¼å“ˆé¡¿è·ç¦»ï¼‰æ˜¯å¦ä¸€ç§å¸¸ç”¨çš„è·ç¦»åº¦é‡æ–¹å¼ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>d</mi><mrow><mi>L</mi><mn>1</mn></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>âˆ’</mo><msub><mi>x</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mi mathvariant=\"normal\">âˆ£</mi></mrow><annotation encoding=\"application/x-tex\">d_{L1}(x_i, x_j) = \\sum_{k=1}^{n}|x_{ik} - x_{jk}|\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9535100000000005em;vertical-align:-1.302113em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.302113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span></span></span></span></span></p>\n<p>L1 è·ç¦»ä¸ L2 è·ç¦»ï¼ˆæ¬§å‡ é‡Œå¾—è·ç¦»ï¼‰çš„åŒºåˆ«ï¼š</p>\n<ul>\n<li><strong>L1 è·ç¦»</strong>ï¼šå¯¹å¼‚å¸¸å€¼ä¸æ•æ„Ÿï¼Œè®¡ç®—æ›´å¿«</li>\n<li><strong>L2 è·ç¦»</strong>ï¼šè€ƒè™‘äº†å‡ ä½•è·ç¦»ï¼Œå¯¹å¼‚å¸¸å€¼æ•æ„Ÿ</li>\n<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šé«˜ç»´ç¨€ç–æ•°æ®å¸¸ç”¨ L1ï¼Œä½ç»´å¯†é›†æ•°æ®å¸¸ç”¨ L2</li>\n</ul>\n</div></details>\n<h2 id=\"è·ç¦»çŸ©é˜µå¯è§†åŒ–åˆ†æ\"><a class=\"anchor\" href=\"#è·ç¦»çŸ©é˜µå¯è§†åŒ–åˆ†æ\">#</a> è·ç¦»çŸ©é˜µå¯è§†åŒ–åˆ†æ</h2>\n<p>é€šè¿‡å›¾å½¢åŒ–å‘ç°ä¸€äº›è¡Œæˆ–åˆ—å¾ˆäº®ï¼Œä»£è¡¨è·ç¦»è¿œï¼Œè¯´æ˜ä¸€äº›æµ‹è¯•æ•°æ®å’Œæ‰€æœ‰è®­ç»ƒæ•°æ®æ— å…³ï¼Œä»¥åŠä¸€äº›è®­ç»ƒæ•°æ®å’Œæ‰€æœ‰æµ‹è¯•æ•°æ®å…³ç³»å¼±ã€‚</p>\n<div class=\"note info no-icon\">\n<p>è·ç¦»çŸ©é˜µçš„å¯è§†åŒ–æœ‰åŠ©äºç†è§£æ•°æ®åˆ†å¸ƒï¼šäº®ç‚¹è¡¨ç¤ºè·ç¦»è¿œï¼Œæš—ç‚¹è¡¨ç¤ºè·ç¦»è¿‘ã€‚å¦‚æœæŸä¸€è¡Œå¾ˆäº®ï¼Œè¯´æ˜è¯¥æµ‹è¯•æ ·æœ¬æ˜¯å¼‚å¸¸ç‚¹ï¼›å¦‚æœæŸä¸€åˆ—å¾ˆäº®ï¼Œè¯´æ˜è¯¥è®­ç»ƒæ ·æœ¬ä¸å…·ä»£è¡¨æ€§ã€‚</p>\n</div>\n<h1 id=\"é¢„æµ‹å®ç°ä¸ä¼˜åŒ–\"><a class=\"anchor\" href=\"#é¢„æµ‹å®ç°ä¸ä¼˜åŒ–\">#</a> é¢„æµ‹å®ç°ä¸ä¼˜åŒ–</h1>\n<h2 id=\"åŸºç¡€é¢„æµ‹å‡½æ•°\"><a class=\"anchor\" href=\"#åŸºç¡€é¢„æµ‹å‡½æ•°\">#</a> åŸºç¡€é¢„æµ‹å‡½æ•°</h2>\n<p>å®Œæˆé¢„æµ‹ç»“æœçš„å‡½æ•°å®ç°åŒ…æ‹¬ä¸¤ä¸ªå…³é”®æ­¥éª¤ï¼šé¦–å…ˆé€šè¿‡  <code>argsort</code>  é€‰å‡º k ä¸ªæœ€è¿‘çš„ä¸‹æ ‡ç´¢å¼•ï¼Œç„¶åä»ä¸­é€‰å‡ºå‡ºç°æ¬¡æ•°æœ€å¤šçš„æ ‡ç­¾ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>KNNé¢„æµ‹å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(num_test):</span><br><span class=\"line\">    <span class=\"comment\"># A list of length k storing the labels of the k nearest neighbors to</span></span><br><span class=\"line\">    <span class=\"comment\"># the ith test point.</span></span><br><span class=\"line\">    closest_y = []</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># Use the distance matrix to find the k nearest neighbors of the ith    </span></span><br><span class=\"line\">    <span class=\"comment\"># testing point, and use self.y_train to find the labels of these       </span></span><br><span class=\"line\">    <span class=\"comment\"># neighbors. Store these labels in closest_y.</span></span><br><span class=\"line\">    closest_y = <span class=\"variable language_\">self</span>.y_train[np.argsort(dists[i])[:k]]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Now that you have found the labels of the k nearest neighbors, you    </span></span><br><span class=\"line\">    <span class=\"comment\"># need to find the most common label in the list closest_y of labels.   </span></span><br><span class=\"line\">    <span class=\"comment\"># Store this label in y_pred[i]. Break ties by choosing the smaller     </span></span><br><span class=\"line\">    <span class=\"comment\"># label.</span></span><br><span class=\"line\">    counts = np.bincount(closest_y)</span><br><span class=\"line\">    max_count = np.<span class=\"built_in\">max</span>(counts)</span><br><span class=\"line\">    candidates = np.where(counts == max_count)[<span class=\"number\">0</span>]</span><br><span class=\"line\">    y_pred[i] = np.<span class=\"built_in\">min</span>(candidates)  <span class=\"comment\"># Choose the smallest label in case</span></span><br></pre></td></tr></table></figure>\n<div class=\"note success no-icon\">\n<p>é€šè¿‡æµ‹è¯•å‘ç°ï¼Œé€‚å½“æé«˜ k å€¼å¯ä»¥å¾®å°åœ°æé«˜å‡†ç¡®ç‡ï¼Œä½†éœ€è¦é€šè¿‡äº¤å‰éªŒè¯æ‰¾åˆ°æœ€ä¼˜å€¼ã€‚</p>\n</div>\n<h2 id=\"è®¡ç®—æ•ˆç‡ä¼˜åŒ–\"><a class=\"anchor\" href=\"#è®¡ç®—æ•ˆç‡ä¼˜åŒ–\">#</a> è®¡ç®—æ•ˆç‡ä¼˜åŒ–</h2>\n<h3 id=\"å•å¾ªç¯å®ç°\"><a class=\"anchor\" href=\"#å•å¾ªç¯å®ç°\">#</a> å•å¾ªç¯å®ç°</h3>\n<figure class=\"highlight python\"><figcaption><span>å•å¾ªç¯è·ç¦»è®¡ç®—</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dists[i, :] = np.sqrt(np.<span class=\"built_in\">sum</span>((X[i] - <span class=\"variable language_\">self</span>.X_train) ** <span class=\"number\">2</span>, axis=<span class=\"number\">1</span>))</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ— å¾ªç¯å‘é‡åŒ–å®ç°\"><a class=\"anchor\" href=\"#æ— å¾ªç¯å‘é‡åŒ–å®ç°\">#</a> æ— å¾ªç¯å‘é‡åŒ–å®ç°</h3>\n<figure class=\"highlight python\"><figcaption><span>å‘é‡åŒ–è·ç¦»è®¡ç®—</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X_square = np.<span class=\"built_in\">sum</span>(X ** <span class=\"number\">2</span>, axis=<span class=\"number\">1</span>).reshape(num_test, <span class=\"number\">1</span>)</span><br><span class=\"line\">X_train_square = np.<span class=\"built_in\">sum</span>(<span class=\"variable language_\">self</span>.X_train ** <span class=\"number\">2</span>, axis=<span class=\"number\">1</span>).reshape(<span class=\"number\">1</span>, num_train)</span><br><span class=\"line\">dists = np.sqrt(X_square + X_train_square - <span class=\"number\">2</span> * np.dot(X, <span class=\"variable language_\">self</span>.X_train.T))</span><br></pre></td></tr></table></figure>\n<p>è¯¥å®ç°åŸºäºè·ç¦»å…¬å¼çš„å±•å¼€ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">âˆ£</mi><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>j</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msup><mi mathvariant=\"normal\">âˆ£</mi><mn>2</mn></msup><mo>=</mo><mi mathvariant=\"normal\">âˆ£</mi><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msup><mi mathvariant=\"normal\">âˆ£</mi><mn>2</mn></msup><mo>+</mo><mi mathvariant=\"normal\">âˆ£</mi><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>x</mi><mi>j</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msup><mi mathvariant=\"normal\">âˆ£</mi><mn>2</mn></msup><mo>âˆ’</mo><mn>2</mn><msub><mi>x</mi><mi>i</mi></msub><mo>â‹…</mo><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">||x_i - x_j||^2 = ||x_i||^2 + ||x_j||^2 - 2x_i \\cdot x_j\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.150216em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord\">âˆ£</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord\">âˆ£</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.150216em;vertical-align:-0.286108em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord\">âˆ£</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.79444em;vertical-align:-0.15em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<div class=\"note warning no-icon\">\n<p>å•å¾ªç¯æ•ˆç‡ä¸ä¸€å®šæ¯”åŒå¾ªç¯æ•ˆç‡æ›´å¥½ï¼Œä½†æ— å¾ªç¯çš„å‘é‡åŒ–å®ç°æ•ˆç‡æ˜æ˜¾æ›´ä¼˜ã€‚</p>\n</div>\n<h1 id=\"äº¤å‰éªŒè¯ä¸å‚æ•°é€‰æ‹©\"><a class=\"anchor\" href=\"#äº¤å‰éªŒè¯ä¸å‚æ•°é€‰æ‹©\">#</a> äº¤å‰éªŒè¯ä¸å‚æ•°é€‰æ‹©</h1>\n<p>äº¤å‰éªŒè¯æ˜¯é€‰æ‹©æœ€ä¼˜ k å€¼çš„æ ‡å‡†æ–¹æ³•ã€‚é€šè¿‡å°†è®­ç»ƒæ•°æ®åˆ†æˆå¤šä¸ªæŠ˜å ï¼Œè½®æµä½¿ç”¨å…¶ä¸­ä¸€éƒ¨åˆ†ä½œä¸ºéªŒè¯é›†ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>äº¤å‰éªŒè¯å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">num_folds = <span class=\"number\">5</span></span><br><span class=\"line\">k_choices = [<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">15</span>, <span class=\"number\">20</span>, <span class=\"number\">50</span>, <span class=\"number\">100</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">X_train_folds = []</span><br><span class=\"line\">y_train_folds = []</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Split up the training data into folds</span></span><br><span class=\"line\">X_train_folds = np.array_split(X_train, num_folds)</span><br><span class=\"line\">y_train_folds = np.array_split(y_train, num_folds)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># A dictionary holding the accuracies for different values of k</span></span><br><span class=\"line\">k_to_accuracies = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Perform k-fold cross validation to find the best value of k</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> k_choices:</span><br><span class=\"line\">    k_to_accuracies[k] = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> fold <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(num_folds):</span><br><span class=\"line\">        <span class=\"comment\"># Use the fold-th fold as the validation set, and the rest as training data</span></span><br><span class=\"line\">        X_train = np.concatenate([X_train_folds[i] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(num_folds) <span class=\"keyword\">if</span> i != fold])</span><br><span class=\"line\">        y_train = np.concatenate([y_train_folds[i] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(num_folds) <span class=\"keyword\">if</span> i != fold])</span><br><span class=\"line\">        X_val = X_train_folds[fold]</span><br><span class=\"line\">        y_val = y_train_folds[fold]</span><br><span class=\"line\">        classifier.train(X_train, y_train)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># Compute distances between validation and training data</span></span><br><span class=\"line\">        dists = classifier.compute_distances_no_loops(X_val)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Predict labels for the validation set</span></span><br><span class=\"line\">        y_val_pred = classifier.predict_labels(dists, k=k)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Compute accuracy and store it</span></span><br><span class=\"line\">        num_correct = np.<span class=\"built_in\">sum</span>(y_val_pred == y_val)</span><br><span class=\"line\">        accuracy = num_correct / <span class=\"built_in\">len</span>(y_val)</span><br><span class=\"line\">        k_to_accuracies[k].append(accuracy)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Print out the computed accuracies</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> <span class=\"built_in\">sorted</span>(k_to_accuracies):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> accuracy <span class=\"keyword\">in</span> k_to_accuracies[k]:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;k = %d, accuracy = %f&#x27;</span> % (k, accuracy))</span><br></pre></td></tr></table></figure>\n<h1 id=\"é‡è¦ç†è®ºæ€§è´¨\"><a class=\"anchor\" href=\"#é‡è¦ç†è®ºæ€§è´¨\">#</a> é‡è¦ç†è®ºæ€§è´¨</h1>\n<h2 id=\"è®­ç»ƒè¯¯å·®ç‰¹æ€§\"><a class=\"anchor\" href=\"#è®­ç»ƒè¯¯å·®ç‰¹æ€§\">#</a> è®­ç»ƒè¯¯å·®ç‰¹æ€§</h2>\n<div class=\"note info no-icon\">\n<p>1-NN çš„è®­ç»ƒè¯¯å·®æ€»æ˜¯å°äºæˆ–ç­‰äº 5-NN çš„è®­ç»ƒè¯¯å·®ã€‚è¿™æ˜¯å› ä¸ºå½“ k=1 æ—¶ï¼Œæ¯ä¸ªè®­ç»ƒæ ·æœ¬çš„æœ€è¿‘é‚»å°±æ˜¯å®ƒè‡ªå·±ï¼Œå› æ­¤è®­ç»ƒè¯¯å·®ä¸º 0ã€‚</p>\n</div>\n<h2 id=\"è®¡ç®—å¤æ‚åº¦\"><a class=\"anchor\" href=\"#è®¡ç®—å¤æ‚åº¦\">#</a> è®¡ç®—å¤æ‚åº¦</h2>\n<div class=\"note warning no-icon\">\n<p>ä½¿ç”¨ k-NN åˆ†ç±»å™¨åˆ†ç±»æµ‹è¯•ç¤ºä¾‹æ‰€éœ€çš„æ—¶é—´éšç€è®­ç»ƒé›†çš„å¤§å°è€Œçº¿æ€§å¢é•¿ã€‚è¿™æ˜¯ k-NN ä½œä¸ºæƒ°æ€§å­¦ä¹ ç®—æ³•çš„ä¸»è¦ç¼ºç‚¹ä¹‹ä¸€ã€‚</p>\n</div>\n",
            "tags": [
                "å­¦ä¹ ç¬”è®°",
                "æœºå™¨å­¦ä¹ ",
                "ä»£ç å®ç°",
                "cs231n",
                "assignment1",
                "æ·±åº¦å­¦ä¹ ",
                "è®¡ç®—æœºè§†è§‰",
                "äº¤å‰éªŒè¯",
                "KNN",
                "åˆ†ç±»ç®—æ³•",
                "è·ç¦»è®¡ç®—",
                "å‘é‡åŒ–",
                "è¿‘é‚»æœç´¢",
                "ç›‘ç£å­¦ä¹ ",
                "æƒ°æ€§å­¦ä¹ ",
                "cs231n"
            ]
        },
        {
            "id": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/Transformer%E7%9A%84%E5%AE%9E%E7%8E%B0/",
            "url": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/Transformer%E7%9A%84%E5%AE%9E%E7%8E%B0/",
            "title": "Transformerçš„å®ç°",
            "date_published": "2025-07-19T17:17:29.000Z",
            "content_html": "<p>æœ¬æ–‡åŸºäº<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kYXRhd2hhbGVjaGluYS5naXRodWIuaW8vaGFwcHktbGxtLyMvLi9jaGFwdGVyMi8lRTclQUMlQUMlRTQlQkElOEMlRTclQUIlQTAlMjBUcmFuc2Zvcm1lciVFNiU5RSVCNiVFNiU5RSU4NA==\"> Happy-LLM ç¬¬äºŒç«  Transformer æ¶æ„</span>çš„å®ç°ï¼Œè¯¦ç»†è§£æ Transformer æ¨¡å‹çš„æ ¸å¿ƒç»„ä»¶åŠå…¶ PyTorch å®ç°ã€‚</p>\n<h1 id=\"ä½ç½®ç¼–ç æœºåˆ¶\"><a class=\"anchor\" href=\"#ä½ç½®ç¼–ç æœºåˆ¶\">#</a> ä½ç½®ç¼–ç æœºåˆ¶</h1>\n<p>Transformer æ¶æ„é‡‡ç”¨<strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶</strong>å¤„ç†åºåˆ—æ•°æ®ï¼Œä½†è‡ªæ³¨æ„åŠ›æœ¬èº«å¯¹ä½ç½®ä¿¡æ¯ä¸æ•æ„Ÿã€‚ä¸ºäº†è®©æ¨¡å‹ç†è§£åºåˆ—ä¸­å…ƒç´ çš„ä½ç½®å…³ç³»ï¼Œéœ€è¦å¼•å…¥ä½ç½®ç¼–ç ã€‚</p>\n<details class=\"info\"><summary>ç»å¯¹ä½ç½®ç¼–ç Sinusoidalè¯¦è§£</summary><div>\n<p>ç»å¯¹ä½ç½®ç¼–ç é€šè¿‡<strong>æ­£ä½™å¼¦å‡½æ•°</strong>ä¸ºåºåˆ—ä¸­çš„æ¯ä¸ªä½ç½®ç”Ÿæˆå›ºå®šçš„ç¼–ç å‘é‡ã€‚è¯¥æ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨ä¸åŒé¢‘ç‡çš„ä¸‰è§’å‡½æ•°ï¼Œä¸ºæ¯ä¸ªä½ç½®åˆ›å»ºå”¯ä¸€ä¸”æœ‰è§„å¾‹çš„è¡¨ç¤ºã€‚</p>\n<p><strong>æ ¸å¿ƒå…¬å¼ï¼š</strong></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><msub><mi>E</mi><mrow><mo stretchy=\"false\">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo separator=\"true\">,</mo><mn>2</mn><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo>=</mo><mi>sin</mi><mo>â¡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi>i</mi><mi mathvariant=\"normal\">/</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">PE_{(pos,2i)} = \\sin\\left(\\frac{pos}{10000^{2i/d_{model}}}\\right)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.03853em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.8539999999999999em;vertical-align:-0.704em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1075599999999999em;\"><span style=\"top:-2.2960000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mtight\">/</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">s</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.704em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><msub><mi>E</mi><mrow><mo stretchy=\"false\">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo separator=\"true\">,</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msub><mo>=</mo><mi>cos</mi><mo>â¡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi>i</mi><mi mathvariant=\"normal\">/</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">PE_{(pos,2i+1)} = \\cos\\left(\\frac{pos}{10000^{2i/d_{model}}}\\right)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.03853em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.8539999999999999em;vertical-align:-0.704em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1075599999999999em;\"><span style=\"top:-2.2960000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mtight\">/</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">s</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.704em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span></span></span></p>\n<p>å…¶ä¸­ï¼š</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">pos</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">s</span></span></span></span> è¡¨ç¤ºä½ç½®ç´¢å¼•ï¼ˆ0, 1, 2, ...ï¼‰</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> è¡¨ç¤ºç»´åº¦ç´¢å¼•ï¼ˆ0, 1, 2, ..., <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mi mathvariant=\"normal\">/</mi><mn>2</mn><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">d_{model}/2-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼‰</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">d_{model}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> æ˜¯æ¨¡å‹çš„éšè—å±‚ç»´åº¦</li>\n</ul>\n<p><strong>ä¼˜åŠ¿ï¼š</strong></p>\n<ol>\n<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šæ— éœ€è®­ç»ƒå³å¯å¤„ç†ä»»æ„é•¿åº¦çš„åºåˆ—</li>\n<li><strong>ç›¸å¯¹ä½ç½®å…³ç³»</strong>ï¼šä»»ä½•ä½ç½®çš„ç¼–ç éƒ½å¯ä»¥è¡¨ç¤ºä¸ºå…¶ä»–ä½ç½®ç¼–ç çš„çº¿æ€§ç»„åˆ</li>\n<li><strong>è®¡ç®—æ•ˆç‡</strong>ï¼šé¢„è®¡ç®—åç›´æ¥åŠ æ³•æ“ä½œï¼Œæ— éœ€é¢å¤–å‚æ•°</li>\n</ol>\n<p><strong>ç¼ºç‚¹ï¼š</strong></p>\n<ol>\n<li><strong>å›ºå®šæ€§</strong>ï¼šæ— æ³•æ ¹æ®ä»»åŠ¡è‡ªé€‚åº”è°ƒæ•´</li>\n<li><strong>è¿œè·ç¦»å»ºæ¨¡èƒ½åŠ›æœ‰é™</strong>ï¼šå¯¹äºè¶…é•¿åºåˆ—ï¼Œä½ç½®ä¿¡æ¯å¯èƒ½å˜å¾—æ¨¡ç³Š</li>\n</ol>\n</div></details>\n<figure class=\"highlight python\"><figcaption><span>ä½ç½®ç¼–ç å®ç°</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kYXRhd2hhbGVjaGluYS5naXRodWIuaW8vaGFwcHktbGxtLyMvLi9jaGFwdGVyMi8lRTclQUMlQUMlRTQlQkElOEMlRTclQUIlQTAlMjBUcmFuc2Zvcm1lciVFNiU5RSVCNiVFNiU5RSU4NA==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">PositionalEncoding</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args: ModelArgs</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>().__init__()</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.dropout = nn.Dropout(args.dropout)</span><br><span class=\"line\">        <span class=\"comment\"># block size æ˜¯åºåˆ—çš„æœ€å¤§é•¿åº¦</span></span><br><span class=\"line\">        pe = torch.zeros(args.block_size, args.d_model)</span><br><span class=\"line\">        position = torch.arange(<span class=\"number\">0</span>, args.block_size, dtype=torch.<span class=\"built_in\">float</span>).unsqueeze(<span class=\"number\">1</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        div_term = torch.exp(torch.arange(<span class=\"number\">0</span>, args.d_model, <span class=\"number\">2</span>).<span class=\"built_in\">float</span>() * (-np.log(<span class=\"number\">10000.0</span>) / args.d_model))</span><br><span class=\"line\">        pe[:, <span class=\"number\">0</span>::<span class=\"number\">2</span>] = torch.sin(position * div_term)</span><br><span class=\"line\">        pe[:, <span class=\"number\">1</span>::<span class=\"number\">2</span>] = torch.cos(position * div_term)</span><br><span class=\"line\">        pe = pe.unsqueeze(<span class=\"number\">0</span>)  <span class=\"comment\"># å¢åŠ  batch ç»´åº¦</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.register_buffer(<span class=\"string\">&#x27;pe&#x27;</span>, pe)</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">        x = x + <span class=\"variable language_\">self</span>.pe[:, :x.size(<span class=\"number\">1</span>)].requires_grad_(<span class=\"literal\">False</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">self</span>.dropout(x)</span><br></pre></td></tr></table></figure>\n<div class=\"note info no-icon\">\n<p>ä½ç½®ç¼–ç é€šè¿‡<strong>åŠ æ³•</strong>è€Œé<strong>æ‹¼æ¥</strong>çš„æ–¹å¼ä¸è¯åµŒå…¥ç»“åˆï¼Œè¿™æ ·æ—¢ä¿æŒäº†æ¨¡å‹ç»´åº¦ä¸å˜ï¼Œåˆèå…¥äº†ä½ç½®ä¿¡æ¯ã€‚</p>\n</div>\n<h1 id=\"å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶\"><a class=\"anchor\" href=\"#å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶\">#</a> å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶</h1>\n<p>å¤šå¤´æ³¨æ„åŠ›æ˜¯ Transformer çš„æ ¸å¿ƒåˆ›æ–°ï¼Œå®ƒå…è®¸æ¨¡å‹åŒæ—¶å…³æ³¨åºåˆ—ä¸­ä¸åŒä½ç½®çš„ä¿¡æ¯ï¼Œå¹¶ä»å¤šä¸ªè¡¨ç¤ºå­ç©ºé—´ä¸­å­¦ä¹ ä¸åŒç±»å‹çš„ä¾èµ–å…³ç³»ã€‚</p>\n<h2 id=\"æ³¨æ„åŠ›è®¡ç®—åŸç†\"><a class=\"anchor\" href=\"#æ³¨æ„åŠ›è®¡ç®—åŸç†\">#</a> æ³¨æ„åŠ›è®¡ç®—åŸç†</h2>\n<p><strong>æ ‡å‡†æ³¨æ„åŠ›å…¬å¼ï¼š</strong></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>Attention</mtext><mo stretchy=\"false\">(</mo><mi>Q</mi><mo separator=\"true\">,</mo><mi>K</mi><mo separator=\"true\">,</mo><mi>V</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>softmax</mtext><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence=\"true\">)</mo></mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\text{Attention}(Q,K,V) = \\text{softmax}\\left(\\frac{QK^T}{\\sqrt{d_k}}\\right)V\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">Attention</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.468361em;vertical-align:-0.95003em;\"></span><span class=\"mord text\"><span class=\"mord\">softmax</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5183309999999999em;\"><span style=\"top:-2.25278em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85722em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.81722em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.18278000000000005em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span></span></p>\n<p>å…¶ä¸­ï¼š</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span> (Query)ï¼šæŸ¥è¯¢çŸ©é˜µï¼Œå½¢çŠ¶ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator=\"true\">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator=\"true\">,</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(batch\\_size, seq\\_len, d_{model})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> (Key)ï¼šé”®çŸ©é˜µï¼Œå½¢çŠ¶ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator=\"true\">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator=\"true\">,</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(batch\\_size, seq\\_len, d_{model})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> (Value)ï¼šå€¼çŸ©é˜µï¼Œå½¢çŠ¶ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator=\"true\">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator=\"true\">,</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(batch\\_size, seq\\_len, d_{model})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">d_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼šé”®å‘é‡çš„ç»´åº¦ï¼Œç”¨äºç¼©æ”¾ä»¥é˜²æ­¢ softmax æ¢¯åº¦æ¶ˆå¤±</li>\n</ul>\n<p><strong>å¤šå¤´æ³¨æ„åŠ›å…¬å¼ï¼š</strong></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>MultiHead</mtext><mo stretchy=\"false\">(</mo><mi>Q</mi><mo separator=\"true\">,</mo><mi>K</mi><mo separator=\"true\">,</mo><mi>V</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>Concat</mtext><mo stretchy=\"false\">(</mo><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mi>h</mi></msub><mo stretchy=\"false\">)</mo><msup><mi>W</mi><mi>O</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\text{MultiHead}(Q,K,V) = \\text{Concat}(head_1, ..., head_h)W^O\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">MultiHead</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413309999999999em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">Concat</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">O</span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mtext>Attention</mtext><mo stretchy=\"false\">(</mo><mi>Q</mi><msubsup><mi>W</mi><mi>i</mi><mi>Q</mi></msubsup><mo separator=\"true\">,</mo><mi>K</mi><msubsup><mi>W</mi><mi>i</mi><mi>K</mi></msubsup><mo separator=\"true\">,</mo><mi>V</mi><msubsup><mi>W</mi><mi>i</mi><mi>V</mi></msubsup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">head_i = \\text{Attention}(QW_i^Q, KW_i^K, VW_i^V)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.236103em;vertical-align:-0.276864em;\"></span><span class=\"mord text\"><span class=\"mord\">Attention</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9592389999999998em;\"><span style=\"top:-2.4231360000000004em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.180908em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">Q</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.276864em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<figure class=\"highlight python\"><figcaption><span>å¤šå¤´æ³¨æ„åŠ›å®ç°</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kYXRhd2hhbGVjaGluYS5naXRodWIuaW8vaGFwcHktbGxtLyMvLi9jaGFwdGVyMi8lRTclQUMlQUMlRTQlQkElOEMlRTclQUIlQTAlMjBUcmFuc2Zvcm1lciVFNiU5RSVCNiVFNiU5RSU4NA==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MultiHeadAttention</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args: ModelArgs, is_causal=<span class=\"literal\">False</span></span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>().__init__()</span><br><span class=\"line\">        <span class=\"keyword\">assert</span> args.d_model % args.num_heads == <span class=\"number\">0</span>, <span class=\"string\">&quot;d_model must be divisible by num_heads&quot;</span></span><br><span class=\"line\">        <span class=\"comment\"># è¡¨ç¤ºå½“å‰æ²¡æœ‰è¿›è¡Œæ¨¡å‹å¹¶è¡Œï¼ˆå³æ‰€æœ‰è®¡ç®—éƒ½åœ¨ä¸€ä¸ªè®¾å¤‡ä¸Šå®Œæˆï¼‰</span></span><br><span class=\"line\">        model_parallel_size = <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"comment\"># æ‰€ä»¥æ¯ä¸ªå¤´çš„æœ¬åœ°æ•°é‡æ˜¯æ€»å¤´æ•°é™¤ä»¥æ¨¡å‹å¹¶è¡Œå¤§å°</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.n_local_heads = args.num_heads // model_parallel_size</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.head_dim = args.d_model // args.num_heads</span><br><span class=\"line\">        <span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        æƒé‡çŸ©é˜µæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªçº¿æ€§å˜æ¢çš„å‚æ•°ã€‚</span></span><br><span class=\"line\"><span class=\"string\">        PyTorch çš„çº¿æ€§å±‚ï¼ˆnn.Linearï¼‰å†…éƒ¨å®ç°å°±æ˜¯ä¸€ä¸ªæƒé‡çŸ©é˜µå’Œä¸€ä¸ªå¯é€‰çš„åç½®é¡¹ã€‚</span></span><br><span class=\"line\"><span class=\"string\">        çº¿æ€§å±‚çš„å‰å‘è®¡ç®—å°±æ˜¯è¾“å…¥å¼ é‡ä¸æƒé‡çŸ©é˜µåšçŸ©é˜µä¹˜æ³•ï¼ˆåŠ ä¸Šåç½®ï¼‰ï¼Œ</span></span><br><span class=\"line\"><span class=\"string\">        è¿™å’Œæˆ‘ä»¬æ‰‹åŠ¨å®šä¹‰æƒé‡çŸ©é˜µå¹¶åšçº¿æ€§å˜æ¢æ˜¯ä¸€æ ·çš„ã€‚</span></span><br><span class=\"line\"><span class=\"string\">        &#x27;&#x27;&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.wq = nn.Linear(args.d_model, args.num_heads * <span class=\"variable language_\">self</span>.head_dim, bias=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.wk = nn.Linear(args.d_model, args.num_heads * <span class=\"variable language_\">self</span>.head_dim, bias=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.wv = nn.Linear(args.d_model, args.num_heads * <span class=\"variable language_\">self</span>.head_dim, bias=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.wo = nn.Linear(args.num_heads * <span class=\"variable language_\">self</span>.head_dim, args.d_model, bias=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># åŠŸèƒ½ï¼šä»¥args.dropoutçš„æ¦‚ç‡éšæœºç½®é›¶</span></span><br><span class=\"line\">        <span class=\"comment\"># æ³¨æ„åŠ›çš„ dropout</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.attn_dropout = nn.Dropout(args.dropout)</span><br><span class=\"line\">        <span class=\"comment\"># æ®‹å·®è¿æ¥çš„ dropout</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.resid_dropout = nn.Dropout(args.dropout)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.is_causal = is_causal</span><br><span class=\"line\">        <span class=\"keyword\">if</span> is_causal:</span><br><span class=\"line\">            <span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">            è¿™ä¸ªå¼ é‡çš„å½¢çŠ¶æ˜¯ (1, 1, args.max_seq_len, args.max_seq_len)ã€‚</span></span><br><span class=\"line\"><span class=\"string\">                ç¬¬ä¸€ä¸ª 1ï¼šé€šå¸¸è¡¨ç¤º batch ç»´åº¦ï¼ˆæ‰¹æ¬¡å¤§å°ï¼‰ã€‚</span></span><br><span class=\"line\"><span class=\"string\">                ç¬¬äºŒä¸ª 1ï¼šé€šå¸¸è¡¨ç¤ºå¤´æ•°ï¼ˆæ¯”å¦‚å¤šå¤´æ³¨æ„åŠ›ä¸­çš„å•å¤´ï¼‰ã€‚</span></span><br><span class=\"line\"><span class=\"string\">                args.max_seq_lenï¼šåºåˆ—é•¿åº¦ï¼Œè¡¨ç¤ºæ¯ä¸ªæ ·æœ¬çš„æœ€å¤§é•¿åº¦ã€‚</span></span><br><span class=\"line\"><span class=\"string\">                args.max_seq_lenï¼šåŒæ ·æ˜¯åºåˆ—é•¿åº¦ï¼Œç”¨äºæ„é€ æ©ç çŸ©é˜µã€‚</span></span><br><span class=\"line\"><span class=\"string\">            &#x27;&#x27;&#x27;</span></span><br><span class=\"line\">            mask = torch.full((<span class=\"number\">1</span>, <span class=\"number\">1</span>, args.max_seq_len, args.max_seq_len), <span class=\"built_in\">float</span>(<span class=\"string\">&#x27;-inf&#x27;</span>))</span><br><span class=\"line\">            <span class=\"comment\"># è¿™é‡Œçš„ torch.triu(mask, diagonal=1) ä¼šå°†ä¸Šä¸‰è§’éƒ¨åˆ†ï¼ˆä¸åŒ…æ‹¬å¯¹è§’çº¿ï¼‰è®¾ç½®ä¸ºè´Ÿæ— ç©·å¤§ã€‚</span></span><br><span class=\"line\">            <span class=\"comment\"># è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†åœ¨è®¡ç®—æ³¨æ„åŠ›æ—¶ï¼Œç¡®ä¿æ¯ä¸ªä½ç½®åªèƒ½çœ‹åˆ°å®ƒä¹‹å‰çš„ä½ç½®ï¼Œ</span></span><br><span class=\"line\">            <span class=\"comment\"># ä¹Ÿå°±æ˜¯å®ç°äº†å› æœæ³¨æ„åŠ›ï¼ˆCausal Attentionï¼‰ã€‚</span></span><br><span class=\"line\">            <span class=\"comment\"># å‚æ•° diagonal=1 è¡¨ç¤ºä»å¯¹è§’çº¿çš„ä¸Šæ–¹ä¸€è¡Œå¼€å§‹å¡«å……è´Ÿæ— ç©·å¤§ã€‚</span></span><br><span class=\"line\">            mask = torch.triu(mask, diagonal=<span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"comment\"># ç¼“å†²åŒºæ˜¯æ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œä½†ä¸ä¼šè¢«è§†ä¸ºå¯è®­ç»ƒå‚æ•°ã€‚è¿™ç§æœºåˆ¶é€šå¸¸ç”¨äºå­˜å‚¨å›ºå®šçš„å¼ é‡ã€‚</span></span><br><span class=\"line\">            <span class=\"variable language_\">self</span>.register_buffer(<span class=\"string\">&#x27;mask&#x27;</span>, mask)</span><br></pre></td></tr></table></figure>\n<h2 id=\"å› æœæ©ç æœºåˆ¶\"><a class=\"anchor\" href=\"#å› æœæ©ç æœºåˆ¶\">#</a> å› æœæ©ç æœºåˆ¶</h2>\n<p>å¯¹äºè§£ç å™¨ä¸­çš„<strong>æ©ç è‡ªæ³¨æ„åŠ›</strong>ï¼Œéœ€è¦ç¡®ä¿æ¯ä¸ªä½ç½®åªèƒ½å…³æ³¨åˆ°å®ƒä¹‹å‰çš„ä½ç½®ï¼Œè¿™é€šè¿‡<strong>ä¸Šä¸‰è§’æ©ç </strong>å®ç°ï¼š</p>\n<figure class=\"highlight python\"><figcaption><span>æ³¨æ„åŠ›å‰å‘ä¼ æ’­</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, query, key, value, attn_mask=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    batch_size, seq_len, _ = query.size()</span><br><span class=\"line\">    xq, xk, xv = <span class=\"variable language_\">self</span>.wq(query), <span class=\"variable language_\">self</span>.wk(key), <span class=\"variable language_\">self</span>.wv(value)</span><br><span class=\"line\">    <span class=\"comment\"># å°† Qã€Kã€V æ‹†åˆ†æˆå¤šå¤´ï¼Œç»´åº¦ä¸º (B, T, n_head, C // n_head)ï¼Œç„¶åäº¤æ¢ç»´åº¦ï¼Œå˜æˆ (B, n_head, T, C // n_head)</span></span><br><span class=\"line\">    <span class=\"comment\"># queryã€keyã€value çš„å½¢çŠ¶æ˜¯ (batch_size, seq_len, d_model)</span></span><br><span class=\"line\">    <span class=\"comment\"># çº¿æ€§å˜æ¢åï¼Œxqã€xkã€xv çš„å½¢çŠ¶æ˜¯ (batch_size, seq_len, num_heads * head_dim)</span></span><br><span class=\"line\">    <span class=\"comment\"># ç„¶åå°†å®ƒä»¬é‡å¡‘ä¸º (batch_size, seq_len, n_local_heads, head_dim)</span></span><br><span class=\"line\">    <span class=\"comment\"># ç”±äºåœ¨æ³¨æ„åŠ›è®¡ç®—ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†æ¯ä¸ªå¤´çš„ç»´åº¦åˆ†å¼€å¤„ç†ï¼Œ</span></span><br><span class=\"line\">    <span class=\"comment\"># æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†æœ€åçš„ç»´åº¦è¿›è¡Œè½¬ç½®ï¼Œä½¿å¾—æ¯ä¸ªå¤´çš„ç»´åº¦åœ¨ç¬¬äºŒä¸ªç»´åº¦ä¸Šã€‚</span></span><br><span class=\"line\">    <span class=\"comment\"># ç„¶åå°†å®ƒä»¬è½¬ç½®ä¸º (batch_size, n_local_heads, seq_len, head_dim)</span></span><br><span class=\"line\">    xq = xq.view(batch_size, seq_len, <span class=\"variable language_\">self</span>.n_local_heads, <span class=\"variable language_\">self</span>.head_dim).transpose(<span class=\"number\">1</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">    xk = xk.view(batch_size, seq_len, <span class=\"variable language_\">self</span>.n_local_heads, <span class=\"variable language_\">self</span>.head_dim).transpose(<span class=\"number\">1</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">    xv = xv.view(batch_size, seq_len, <span class=\"variable language_\">self</span>.n_local_heads, <span class=\"variable language_\">self</span>.head_dim).transpose(<span class=\"number\">1</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    scores = torch.matmul(xq, xk.transpose(<span class=\"number\">2</span>, <span class=\"number\">3</span>)) / (<span class=\"variable language_\">self</span>.head_dim ** <span class=\"number\">0.5</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"variable language_\">self</span>.is_causal:</span><br><span class=\"line\">        <span class=\"keyword\">assert</span> <span class=\"built_in\">hasattr</span>(<span class=\"variable language_\">self</span>, <span class=\"string\">&#x27;mask&#x27;</span>), <span class=\"string\">&quot;Causal mask not initialized&quot;</span></span><br><span class=\"line\">        scores = scores + <span class=\"variable language_\">self</span>.mask[:, :, :seq_len, :seq_len]</span><br><span class=\"line\">    <span class=\"comment\"># æ³¨æ„åŠ›åˆ†æ•°é€šå¸¸æ˜¯æµ®ç‚¹æ•°ï¼Œä¿æŒç±»å‹ä¸€è‡´</span></span><br><span class=\"line\">    scores = F.softmax(scores.<span class=\"built_in\">float</span>(), dim=-<span class=\"number\">1</span>).type_as(xq)</span><br><span class=\"line\">    scores = <span class=\"variable language_\">self</span>.attn_dropout(scores)</span><br><span class=\"line\">    output = torch.matmul(scores, xv)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># å°†è¾“å‡ºçš„å½¢çŠ¶ä» (batch_size, n_local_heads, seq_len, head_dim) è½¬æ¢ä¸º (batch_size, seq_len, num_heads * head_dim)</span></span><br><span class=\"line\">    <span class=\"comment\"># è¿™é‡Œçš„ contiguous() æ˜¯ä¸ºäº†ç¡®ä¿å†…å­˜å¸ƒå±€æ˜¯è¿ç»­çš„ï¼Œ</span></span><br><span class=\"line\">    <span class=\"comment\"># è¿™é‡Œçš„ -1 è¡¨ç¤ºè‡ªåŠ¨è®¡ç®—æœ€åä¸€ä¸ªç»´åº¦çš„å¤§å°ï¼Œ</span></span><br><span class=\"line\">    <span class=\"comment\"># è¿™æ ·å¯ä»¥ç¡®ä¿è¾“å‡ºçš„å½¢çŠ¶æ˜¯ (batch_size, seq_len, num_heads * head_dim)</span></span><br><span class=\"line\">    output = output.transpose(<span class=\"number\">1</span>, <span class=\"number\">2</span>).contiguous().view(batch_size, seq_len, -<span class=\"number\">1</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    output = <span class=\"variable language_\">self</span>.wo(output)</span><br><span class=\"line\">    output = <span class=\"variable language_\">self</span>.resid_dropout(output)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> output</span><br></pre></td></tr></table></figure>\n<div class=\"note info no-icon\">\n<p>ç¼©æ”¾å› å­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt{d_k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.18278000000000005em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85722em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.81722em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.18278000000000005em;\"><span></span></span></span></span></span></span></span></span> çš„ä½œç”¨æ˜¯é˜²æ­¢ç‚¹ç§¯ç»“æœè¿‡å¤§å¯¼è‡´ softmax å‡½æ•°è¿›å…¥æ¢¯åº¦æ¶ˆå¤±åŒºåŸŸï¼Œç¡®ä¿è®­ç»ƒç¨³å®šæ€§ã€‚</p>\n</div>\n<h1 id=\"å‰é¦ˆç¥ç»ç½‘ç»œ\"><a class=\"anchor\" href=\"#å‰é¦ˆç¥ç»ç½‘ç»œ\">#</a> å‰é¦ˆç¥ç»ç½‘ç»œ</h1>\n<p>Transformer ä¸­çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFFNï¼‰æ˜¯ä¸€ä¸ªç®€å•çš„ä¸¤å±‚å…¨è¿æ¥ç½‘ç»œï¼Œä¸ºæ¨¡å‹æä¾›éçº¿æ€§å˜æ¢èƒ½åŠ›ã€‚</p>\n<p><strong>FFN å…¬å¼ï¼š</strong></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>FFN</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>x</mi><msub><mi>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><msub><mi>W</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\text{FFN}(x) = \\max(0, xW_1 + b_1)W_2 + b_2\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">FFN</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>å…¶ä¸­æ¿€æ´»å‡½æ•°é‡‡ç”¨ ReLUï¼Œéšè—å±‚ç»´åº¦é€šå¸¸æ˜¯è¾“å…¥ç»´åº¦çš„ 4 å€ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>å‰é¦ˆç½‘ç»œå®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">FFN</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, dim: <span class=\"built_in\">int</span>, hidden_dim: <span class=\"built_in\">int</span>, dropout: <span class=\"built_in\">float</span> = <span class=\"number\">0.1</span></span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>().__init__()</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.w1 = nn.Linear(dim, hidden_dim, bias=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.w2 = nn.Linear(hidden_dim, dim, bias=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.dropout = nn.Dropout(dropout)</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">        <span class=\"comment\"># åŸå…¬å¼ï¼š</span></span><br><span class=\"line\">        <span class=\"comment\"># FFN(x) = max(0, xW1 + b1)W2 + b2</span></span><br><span class=\"line\">        <span class=\"comment\"># å…¶ä¸­ W1, b1, W2, b2 æ˜¯å¯å­¦ä¹ å‚æ•°ï¼Œmax(0, Â·) æ˜¯ ReLU æ¿€æ´»å‡½æ•°</span></span><br><span class=\"line\">        res = <span class=\"variable language_\">self</span>.dropout(<span class=\"variable language_\">self</span>.w2(F.relu(<span class=\"variable language_\">self</span>.w1(x))));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res</span><br></pre></td></tr></table></figure>\n<h1 id=\"å±‚å½’ä¸€åŒ–\"><a class=\"anchor\" href=\"#å±‚å½’ä¸€åŒ–\">#</a> å±‚å½’ä¸€åŒ–</h1>\n<p>å±‚å½’ä¸€åŒ–åœ¨ Transformer ä¸­èµ·åˆ°ç¨³å®šè®­ç»ƒå’ŒåŠ é€Ÿæ”¶æ•›çš„ä½œç”¨ã€‚ä¸æ‰¹å½’ä¸€åŒ–ä¸åŒï¼Œå±‚å½’ä¸€åŒ–åœ¨ç‰¹å¾ç»´åº¦ä¸Šè¿›è¡Œæ ‡å‡†åŒ–ã€‚</p>\n<p><strong>Layer Norm å…¬å¼ï¼š</strong></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>LayerNorm</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Î³</mi><mfrac><mrow><mi>x</mi><mo>âˆ’</mo><mi>Î¼</mi></mrow><mrow><mi>Ïƒ</mi><mo>+</mo><mi>Ïµ</mi></mrow></mfrac><mo>+</mo><mi>Î²</mi></mrow><annotation encoding=\"application/x-tex\">\\text{LayerNorm}(x) = \\gamma \\frac{x - \\mu}{\\sigma + \\epsilon} + \\beta\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">LayerNorm</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0296600000000002em;vertical-align:-0.7693300000000001em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">Î³</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603300000000002em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">Ïµ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">Î¼</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">Î²</span></span></span></span></span></p>\n<p>å…¶ä¸­ï¼š</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î¼</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">Î¼</span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ïƒ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span></span></span></span> åˆ†åˆ«æ˜¯è¾“å…¥åœ¨ç‰¹å¾ç»´åº¦ä¸Šçš„å‡å€¼å’Œæ ‡å‡†å·®</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î³</mi></mrow><annotation encoding=\"application/x-tex\">\\gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">Î³</span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î²</mi></mrow><annotation encoding=\"application/x-tex\">\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">Î²</span></span></span></span> æ˜¯å¯å­¦ä¹ çš„ç¼©æ”¾å’Œåç§»å‚æ•°</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ïµ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">Ïµ</span></span></span></span> æ˜¯é˜²æ­¢é™¤é›¶çš„å°å¸¸æ•°</li>\n</ul>\n<figure class=\"highlight python\"><figcaption><span>å±‚å½’ä¸€åŒ–å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">LayerNorm</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, features, eps: <span class=\"built_in\">float</span> = <span class=\"number\">1e-6</span></span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>().__init__()</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.weight = nn.Parameter(torch.ones(features))</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.bias = nn.Parameter(torch.zeros(features))</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.eps = eps</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">        mean = x.mean(dim=-<span class=\"number\">1</span>, keepdim=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        std = x.std(dim=-<span class=\"number\">1</span>, keepdim=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        normalized = (x - mean) / (std + <span class=\"variable language_\">self</span>.eps)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">self</span>.weight * normalized + <span class=\"variable language_\">self</span>.bias</span><br></pre></td></tr></table></figure>\n<h1 id=\"ç¼–ç å™¨æ¶æ„\"><a class=\"anchor\" href=\"#ç¼–ç å™¨æ¶æ„\">#</a> ç¼–ç å™¨æ¶æ„</h1>\n<p>ç¼–ç å™¨é‡‡ç”¨<strong> Pre-LayerNorm</strong> ç»“æ„ï¼Œå³åœ¨æ¯ä¸ªå­å±‚ä¹‹å‰è¿›è¡Œå±‚å½’ä¸€åŒ–ï¼Œè¿™ç§ç»“æ„ç›¸æ¯” Post-LayerNorm å…·æœ‰æ›´å¥½çš„è®­ç»ƒç¨³å®šæ€§ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>ç¼–ç å™¨å±‚å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">EncoderLayer</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args: ModelArgs</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>().__init__()</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.self_attn = MultiHeadAttention(args, is_causal=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.ffn = FFN(args.d_model, args.d_model * <span class=\"number\">4</span>, dropout=args.dropout)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.ln1 = LayerNorm(args.d_model)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.ln2 = LayerNorm(args.d_model)</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">        <span class=\"comment\"># å®é™…ä¸Šç»å…¸çš„tansformeré‡‡ç”¨çš„æ˜¯Pre-LNç»“æ„ï¼Œ</span></span><br><span class=\"line\">        <span class=\"comment\"># å³åœ¨æ¯ä¸ªå­å±‚ä¹‹å‰è¿›è¡Œå±‚å½’ä¸€åŒ–ï¼Œè€Œä¸æ˜¯åœ¨å­å±‚ä¹‹åã€‚</span></span><br><span class=\"line\">        <span class=\"comment\"># æ®‹å·®ä¾ç„¶æ˜¯åœ¨å­å±‚ä¹‹åè¿›è¡Œçš„ã€‚</span></span><br><span class=\"line\">        <span class=\"comment\"># Self-attention</span></span><br><span class=\"line\">        x_norm = <span class=\"variable language_\">self</span>.ln1(x)</span><br><span class=\"line\">        attn_output = x + <span class=\"variable language_\">self</span>.self_attn.forward(x_norm, x_norm, x_norm)</span><br><span class=\"line\">        <span class=\"comment\"># FFN</span></span><br><span class=\"line\">        output = attn_output + <span class=\"variable language_\">self</span>.ffn(<span class=\"variable language_\">self</span>.ln2(attn_output))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> output</span><br></pre></td></tr></table></figure>\n<p><strong>ç¼–ç å™¨å †å ï¼š</strong></p>\n<figure class=\"highlight python\"><figcaption><span>å®Œæ•´ç¼–ç å™¨</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Encoder</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args: ModelArgs</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>().__init__()</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.layers = nn.ModuleList([EncoderLayer(args) <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(args.n_layers)])</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.ln = LayerNorm(args.d_model)</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> layer <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.layers:</span><br><span class=\"line\">            x = layer(x)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">self</span>.ln(x)  <span class=\"comment\"># æœ€åä¸€ä¸ªå±‚å½’ä¸€åŒ–</span></span><br></pre></td></tr></table></figure>\n<div class=\"note info no-icon\">\n<p>ç¼–ç å™¨çš„è‡ªæ³¨æ„åŠ›å¯ä»¥çœ‹åˆ°åºåˆ—ä¸­çš„æ‰€æœ‰ä½ç½®ï¼Œå› æ­¤ä¸éœ€è¦æ©ç æœºåˆ¶ã€‚</p>\n</div>\n<h1 id=\"è§£ç å™¨æ¶æ„\"><a class=\"anchor\" href=\"#è§£ç å™¨æ¶æ„\">#</a> è§£ç å™¨æ¶æ„</h1>\n<p>è§£ç å™¨æ¯”ç¼–ç å™¨å¤šäº†ä¸€ä¸ª<strong>äº¤å‰æ³¨æ„åŠ›</strong>å±‚ï¼Œç”¨äºå…³æ³¨ç¼–ç å™¨çš„è¾“å‡ºã€‚è§£ç å™¨åŒ…å«ä¸‰ä¸ªä¸»è¦ç»„ä»¶ï¼š</p>\n<ol>\n<li><strong>æ©ç è‡ªæ³¨æ„åŠ›</strong>ï¼šåªèƒ½å…³æ³¨å½“å‰ä½ç½®ä¹‹å‰çš„å†…å®¹</li>\n<li><strong>äº¤å‰æ³¨æ„åŠ›</strong>ï¼šQuery æ¥è‡ªè§£ç å™¨ï¼ŒKey å’Œ Value æ¥è‡ªç¼–ç å™¨</li>\n<li><strong>å‰é¦ˆç¥ç»ç½‘ç»œ</strong>ï¼šæä¾›éçº¿æ€§å˜æ¢</li>\n</ol>\n<figure class=\"highlight python\"><figcaption><span>è§£ç å™¨å±‚å®ç°</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">DecoderLayer</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args: ModelArgs</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>().__init__()</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.mask_norm = LayerNorm(args.d_model)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.masked_self_attn = MultiHeadAttention(args, is_causal=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.multi_norm = LayerNorm(args.d_model)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.multi_attn = MultiHeadAttention(args, is_causal=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.ffn_norm = LayerNorm(args.d_model)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.ffn = FFN(args.d_model, args.d_model * <span class=\"number\">4</span>, dropout=args.dropout)</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x, enc_output</span>):</span><br><span class=\"line\">        <span class=\"comment\"># layer norm</span></span><br><span class=\"line\">        x_norm = <span class=\"variable language_\">self</span>.mask_norm(x)</span><br><span class=\"line\">        <span class=\"comment\"># Masked self-attention</span></span><br><span class=\"line\">        x = x + <span class=\"variable language_\">self</span>.masked_self_attn.forward(x_norm, x_norm, x_norm)</span><br><span class=\"line\">        <span class=\"comment\"># layer norm</span></span><br><span class=\"line\">        x_norm = <span class=\"variable language_\">self</span>.multi_norm(x)</span><br><span class=\"line\">        <span class=\"comment\"># Multi-head attention with encoder output</span></span><br><span class=\"line\">        x = x + <span class=\"variable language_\">self</span>.multi_attn.forward(x_norm, enc_output, enc_output)</span><br><span class=\"line\">        <span class=\"comment\"># layer norm</span></span><br><span class=\"line\">        x_norm = <span class=\"variable language_\">self</span>.ffn_norm(x)</span><br><span class=\"line\">        <span class=\"comment\"># Feed-forward network</span></span><br><span class=\"line\">        x = x + <span class=\"variable language_\">self</span>.ffn(x_norm)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x</span><br></pre></td></tr></table></figure>\n<p><strong>è§£ç å™¨å †å </strong></p>\n<figure class=\"highlight python\"><figcaption><span>å®Œæ•´è§£ç å™¨</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Decoder</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args: ModelArgs</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>().__init__()</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.layers = nn.ModuleList([DecoderLayer(args) <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(args.n_layers)])</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.ln = LayerNorm(args.d_model)</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x, enc_output</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> layer <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.layers:</span><br><span class=\"line\">            x = layer(x, enc_output)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">self</span>.ln(x)  <span class=\"comment\"># æœ€åä¸€ä¸ªå±‚å½’ä¸€åŒ–</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"å®Œæ•´transformeræ¨¡å‹\"><a class=\"anchor\" href=\"#å®Œæ•´transformeræ¨¡å‹\">#</a> å®Œæ•´ Transformer æ¨¡å‹</h1>\n<p>å°†æ‰€æœ‰ç»„ä»¶æ•´åˆï¼Œæ„å»ºå®Œæ•´çš„ Transformer æ¨¡å‹ï¼š</p>\n<figure class=\"highlight python\"><figcaption><span>æ¨¡å‹é…ç½®ç±»</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ModelArgs</span>:</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, d_model, num_heads, dropout=<span class=\"number\">0.1</span>, max_seq_len=<span class=\"number\">512</span>, n_layers=<span class=\"number\">6</span>,</span></span><br><span class=\"line\"><span class=\"params\">                 vocab_size=<span class=\"number\">10000</span>, block_size=<span class=\"number\">128</span></span>):</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.d_model = d_model</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.num_heads = num_heads</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.dropout = dropout</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.max_seq_len = max_seq_len</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.n_layers = n_layers</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.vocab_size = vocab_size</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.block_size = block_size</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><figcaption><span>å®Œæ•´Transformeræ¨¡å‹</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kYXRhd2hhbGVjaGluYS5naXRodWIuaW8vaGFwcHktbGxtLyMvLi9jaGFwdGVyMi8lRTclQUMlQUMlRTQlQkElOEMlRTclQUIlQTAlMjBUcmFuc2Zvcm1lciVFNiU5RSVCNiVFNiU5RSU4NA==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Transformer</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args: ModelArgs</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>().__init__()</span><br><span class=\"line\">        <span class=\"comment\"># å¿…é¡»è¾“å…¥è¯è¡¨å¤§å°å’Œ block size</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> args.vocab_size <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">None</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> args.block_size <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">None</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.args = args</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.transformer = nn.ModuleDict(<span class=\"built_in\">dict</span>(</span><br><span class=\"line\">            encoder=Encoder(args),</span><br><span class=\"line\">            decoder=Decoder(args),</span><br><span class=\"line\">            positional_encoding=PositionalEncoding(args),</span><br><span class=\"line\">            embedding=nn.Embedding(args.vocab_size, args.d_model, padding_idx=<span class=\"number\">0</span>),</span><br><span class=\"line\">            dropout=nn.Dropout(args.dropout),</span><br><span class=\"line\">        ))</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.lm_head = nn.Linear(args.d_model, args.vocab_size, bias=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.apply(<span class=\"variable language_\">self</span>._init_weights)</span><br><span class=\"line\">        <span class=\"comment\"># æŸ¥çœ‹æ‰€æœ‰å‚æ•°çš„æ•°é‡</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;number of parameters: %.2fM&quot;</span> % (<span class=\"variable language_\">self</span>.get_num_params()/<span class=\"number\">1e6</span>,))</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">_init_weights</span>(<span class=\"params\">self, module</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">isinstance</span>(module, nn.Linear):</span><br><span class=\"line\">            <span class=\"comment\"># ä½¿ç”¨æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–çº¿æ€§å±‚çš„æƒé‡</span></span><br><span class=\"line\">            nn.init.normal_(module.weight, mean=<span class=\"number\">0.0</span>, std=<span class=\"number\">0.02</span>)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> module.bias <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">                nn.init.zeros_(module.bias)</span><br><span class=\"line\">        <span class=\"keyword\">elif</span> <span class=\"built_in\">isinstance</span>(module, nn.Embedding):</span><br><span class=\"line\">            <span class=\"comment\"># åµŒå…¥å±‚çš„æƒé‡ä½¿ç”¨æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–</span></span><br><span class=\"line\">            nn.init.normal_(module.weight, mean=<span class=\"number\">0.0</span>, std=<span class=\"number\">0.02</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_num_params</span>(<span class=\"params\">self, non_embedding=<span class=\"literal\">True</span></span>):</span><br><span class=\"line\">        <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">        è®¡ç®—æ¨¡å‹å‚æ•°çš„æ•°é‡</span></span><br><span class=\"line\"><span class=\"string\">        :param non_embedding: æ˜¯å¦æ’é™¤åµŒå…¥å±‚å‚æ•°</span></span><br><span class=\"line\"><span class=\"string\">        :return: å‚æ•°æ•°é‡</span></span><br><span class=\"line\"><span class=\"string\">        &quot;&quot;&quot;</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> non_embedding:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">sum</span>(p.numel() <span class=\"keyword\">for</span> n, p <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.named_parameters() <span class=\"keyword\">if</span> <span class=\"string\">&#x27;embedding&#x27;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> n)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">sum</span>(p.numel() <span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.parameters())</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x, targets=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">        <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">        :param x: è¾“å…¥åºåˆ—ï¼Œå½¢çŠ¶ä¸º (batch_size, seq_len, 1)</span></span><br><span class=\"line\"><span class=\"string\">        :param targets: ç›®æ ‡åºåˆ—ï¼Œå½¢çŠ¶ä¸º (batch_size, seq_len, 1)ï¼Œå¯é€‰ç”¨äºè®¡ç®—æŸå¤±</span></span><br><span class=\"line\"><span class=\"string\">        :return: è¾“å‡º logitsï¼Œå½¢çŠ¶ä¸º (batch_size, seq_len, vocab_size)</span></span><br><span class=\"line\"><span class=\"string\">        &quot;&quot;&quot;</span></span><br><span class=\"line\">        device = x.device</span><br><span class=\"line\">        batch_size, seq_len = x.size()</span><br><span class=\"line\">        <span class=\"keyword\">assert</span> seq_len &lt;= <span class=\"variable language_\">self</span>.args.block_size, <span class=\"string\">&quot;Sequence length exceeds block size&quot;</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;x&quot;</span>, x.shape)</span><br><span class=\"line\">        <span class=\"comment\"># é€šè¿‡embeddingå±‚å°†è¾“å…¥åºåˆ—è½¬æ¢ä¸ºè¯å‘é‡ å½¢çŠ¶ä¸º (batch_size, seq_len, d_model)</span></span><br><span class=\"line\">        tok_emb = <span class=\"variable language_\">self</span>.transformer.embedding(x)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;tok_emb&quot;</span>, tok_emb.shape)</span><br><span class=\"line\">        pos_emb = <span class=\"variable language_\">self</span>.transformer.positional_encoding(tok_emb)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;pos_emb&quot;</span>, pos_emb.shape)</span><br><span class=\"line\">        x = <span class=\"variable language_\">self</span>.transformer.dropout(pos_emb)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;x after dropout&quot;</span>, x.shape)</span><br><span class=\"line\">        enc_output = <span class=\"variable language_\">self</span>.transformer.encoder(x)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;enc_output&quot;</span>, enc_output.shape)</span><br><span class=\"line\">        x = <span class=\"variable language_\">self</span>.transformer.decoder(x, enc_output)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;x after decoder&quot;</span>, x.shape)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">if</span> targets <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">            <span class=\"comment\"># è®¡ç®—æŸå¤±</span></span><br><span class=\"line\">            logits = <span class=\"variable language_\">self</span>.lm_head(x)</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&quot;logits&quot;</span>, logits.shape)</span><br><span class=\"line\">            <span class=\"comment\"># è®¡ç®—äº¤å‰ç†µæŸå¤±</span></span><br><span class=\"line\">            loss = F.cross_entropy(logits.view(-<span class=\"number\">1</span>, logits.size(-<span class=\"number\">1</span>)), targets.view(-<span class=\"number\">1</span>), ignore_index=-<span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> logits, loss</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            logits = <span class=\"variable language_\">self</span>.lm_head(x[:, [-<span class=\"number\">1</span>], :])  <span class=\"comment\"># åªå–åºåˆ—ä¸­çš„æœ€åä¸€ä¸ªä½œä¸ºè¾“å‡º</span></span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&quot;logits&quot;</span>, logits.shape)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> logits</span><br></pre></td></tr></table></figure>\n<h1 id=\"æ¨¡å‹åˆå§‹åŒ–ä¸è®­ç»ƒç»†èŠ‚\"><a class=\"anchor\" href=\"#æ¨¡å‹åˆå§‹åŒ–ä¸è®­ç»ƒç»†èŠ‚\">#</a> æ¨¡å‹åˆå§‹åŒ–ä¸è®­ç»ƒç»†èŠ‚</h1>\n<h2 id=\"æƒé‡åˆå§‹åŒ–ç­–ç•¥\"><a class=\"anchor\" href=\"#æƒé‡åˆå§‹åŒ–ç­–ç•¥\">#</a> æƒé‡åˆå§‹åŒ–ç­–ç•¥</h2>\n<p>æ¨¡å‹é‡‡ç”¨<strong> Xavier åˆå§‹åŒ–</strong>çš„å˜ç§ï¼Œå¯¹ä¸åŒç±»å‹çš„å±‚ä½¿ç”¨ä¸åŒçš„åˆå§‹åŒ–æ–¹æ³•ï¼š</p>\n<ul>\n<li><strong>çº¿æ€§å±‚</strong>ï¼šä½¿ç”¨å‡å€¼ä¸º 0ï¼Œæ ‡å‡†å·®ä¸º 0.02 çš„æ­£æ€åˆ†å¸ƒ</li>\n<li><strong>åµŒå…¥å±‚</strong>ï¼šåŒæ ·ä½¿ç”¨æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–ï¼Œç¡®ä¿è¯å‘é‡çš„åˆç†åˆ†å¸ƒ</li>\n</ul>\n<h2 id=\"å‚æ•°ç»Ÿè®¡\"><a class=\"anchor\" href=\"#å‚æ•°ç»Ÿè®¡\">#</a> å‚æ•°ç»Ÿè®¡</h2>\n<p>æ¨¡å‹æä¾›å‚æ•°ç»Ÿè®¡åŠŸèƒ½ï¼Œå¯ä»¥é€‰æ‹©æ˜¯å¦åŒ…å«åµŒå…¥å±‚å‚æ•°ã€‚è¿™å¯¹äºæ¨¡å‹åˆ†æå’Œèµ„æºä¼°ç®—å¾ˆæœ‰ç”¨ã€‚</p>\n<div class=\"note info no-icon\">\n<p>Pre-LayerNorm ç»“æ„ç›¸æ¯”åŸå§‹çš„ Post-LayerNorm ç»“æ„å…·æœ‰æ›´å¥½çš„<strong>æ¢¯åº¦æµ</strong>å’Œ<strong>è®­ç»ƒç¨³å®šæ€§</strong>ï¼Œå› æ­¤è¢«å¹¿æ³›é‡‡ç”¨ã€‚</p>\n</div>\n<h1 id=\"æ•°æ®æµè½¬æ¢è¿‡ç¨‹\"><a class=\"anchor\" href=\"#æ•°æ®æµè½¬æ¢è¿‡ç¨‹\">#</a> æ•°æ®æµè½¬æ¢è¿‡ç¨‹</h1>\n<p>Transformer çš„å‰å‘ä¼ æ’­è¿‡ç¨‹æ¶‰åŠå¤šæ¬¡ç»´åº¦å˜æ¢ï¼š</p>\n<ol>\n<li><strong>è¾“å…¥åµŒå…¥</strong>ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator=\"true\">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy=\"false\">)</mo><mo>â†’</mo><mo stretchy=\"false\">(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator=\"true\">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator=\"true\">,</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(batch\\_size, seq\\_len) \\rightarrow (batch\\_size, seq\\_len, d_{model})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n<li><strong>ä½ç½®ç¼–ç </strong>ï¼šä¸åµŒå…¥å‘é‡ç›¸åŠ ï¼Œç»´åº¦ä¿æŒä¸å˜</li>\n<li><strong>ç¼–ç å™¨å¤„ç†</strong>ï¼šç»´åº¦ä¿æŒ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator=\"true\">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator=\"true\">,</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(batch\\_size, seq\\_len, d_{model})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n<li><strong>è§£ç å™¨å¤„ç†</strong>ï¼šåŒæ—¶æ¥æ”¶ç¼–ç å™¨è¾“å‡ºå’Œç›®æ ‡åºåˆ—</li>\n<li><strong>è¾“å‡ºæŠ•å½±</strong>ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator=\"true\">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator=\"true\">,</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>â†’</mo><mo stretchy=\"false\">(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator=\"true\">,</mo><mi>s</mi><mi>e</mi><mi>q</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo separator=\"true\">,</mo><mi>v</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>b</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(batch\\_size, seq\\_len, d_{model}) \\rightarrow (batch\\_size, seq\\_len, vocab\\_size)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">b</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">e</span><span class=\"mclose\">)</span></span></span></span></li>\n</ol>\n<p>è¿™ç§å®Œæ•´çš„å®ç°å±•ç¤ºäº† Transformer æ¶æ„çš„æ ¸å¿ƒæ€æƒ³ï¼šé€šè¿‡<strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶</strong>å®ç°åºåˆ—å»ºæ¨¡ï¼Œé€šè¿‡<strong>æ®‹å·®è¿æ¥</strong>å’Œ<strong>å±‚å½’ä¸€åŒ–</strong>ä¿è¯è®­ç»ƒç¨³å®šæ€§ï¼Œé€šè¿‡<strong>ä½ç½®ç¼–ç </strong>å¼•å…¥ä½ç½®ä¿¡æ¯ã€‚è¯¥å®ç°ä¸ºç†è§£å’Œæ‰©å±• Transformer ç³»åˆ—æ¨¡å‹å¥ å®šäº†åšå®åŸºç¡€ã€‚</p>\n",
            "tags": [
                "å­¦ä¹ ç¬”è®°",
                "æœºå™¨å­¦ä¹ ",
                "ä»£ç å®ç°",
                "Happy-LLM",
                "PyTorch",
                "ç¥ç»ç½‘ç»œ",
                "æ·±åº¦å­¦ä¹ ",
                "Transformer",
                "æ³¨æ„åŠ›æœºåˆ¶",
                "ä½ç½®ç¼–ç ",
                "å¤šå¤´æ³¨æ„åŠ›",
                "åºåˆ—å»ºæ¨¡",
                "æœºå™¨å­¦ä¹ "
            ]
        },
        {
            "id": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A1233-%E5%88%A0%E9%99%A4%E5%AD%90%E6%96%87%E4%BB%B6%E5%A4%B9/",
            "url": "https://stinncsky.github.io/algorithm-solutions/leetcode/daily-question/%E5%8A%9B%E6%89%A3%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%EF%BC%9A1233-%E5%88%A0%E9%99%A4%E5%AD%90%E6%96%87%E4%BB%B6%E5%A4%B9/",
            "title": "åŠ›æ‰£æ¯æ—¥ä¸€é¢˜ï¼š1233. åˆ é™¤å­æ–‡ä»¶å¤¹",
            "date_published": "2025-07-19T04:56:22.000Z",
            "content_html": "<div class=\"note info\">\n<p>æœ¬ç¯‡ä¸º <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9yZW1vdmUtc3ViLWZvbGRlcnMtZnJvbS10aGUtZmlsZXN5c3RlbT9lbnZUeXBlPWRhaWx5LXF1ZXN0aW9uJmFtcDtlbnZJZD0yMDI1LTA3LTE5\">LeetCode 1233</span> çš„é¢˜è§£ï¼Œè®°å½•äº†è§£é¢˜æ€è·¯ã€ä»£ç å®ç°ã€‚</p>\n</div>\n<hr />\n<h2 id=\"é¢˜ç›®æè¿°\"><a class=\"anchor\" href=\"#é¢˜ç›®æè¿°\">#</a> ğŸ“˜ é¢˜ç›®æè¿°</h2>\n<p>ä½ æ˜¯ä¸€ä½ç³»ç»Ÿç®¡ç†å‘˜ï¼Œæ‰‹é‡Œæœ‰ä¸€ä»½æ–‡ä»¶å¤¹åˆ—è¡¨  <code>folder</code> ï¼Œä½ çš„ä»»åŠ¡æ˜¯è¦åˆ é™¤è¯¥åˆ—è¡¨ä¸­çš„æ‰€æœ‰ å­æ–‡ä»¶å¤¹ï¼Œå¹¶ä»¥ ä»»æ„é¡ºåº è¿”å›å‰©ä¸‹çš„æ–‡ä»¶å¤¹ã€‚</p>\n<p>å¦‚æœæ–‡ä»¶å¤¹  <code>folder[i]</code>  ä½äºå¦ä¸€ä¸ªæ–‡ä»¶å¤¹  <code>folder[j]</code>  ä¸‹ï¼Œé‚£ä¹ˆ  <code>folder[i]</code>  å°±æ˜¯  <code>folder[j]</code>  çš„ å­æ–‡ä»¶å¤¹ ã€‚ <code>folder[j]</code>  çš„å­æ–‡ä»¶å¤¹å¿…é¡»ä»¥  <code>folder[j]</code>  å¼€å¤´ï¼Œåè·Ÿä¸€ä¸ª  <code>&quot;/&quot;</code> ã€‚ä¾‹å¦‚ï¼Œ <code>&quot;/a/b&quot;</code>  æ˜¯  <code>&quot;/a&quot;</code>  çš„ä¸€ä¸ªå­æ–‡ä»¶å¤¹ï¼Œä½†  <code>&quot;/b&quot;</code>  ä¸æ˜¯  <code>&quot;/a/b/c&quot;</code>  çš„ä¸€ä¸ªå­æ–‡ä»¶å¤¹ã€‚</p>\n<p>æ–‡ä»¶å¤¹çš„ã€Œè·¯å¾„ã€æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‰ä»¥ä¸‹æ ¼å¼ä¸²è”å½¢æˆçš„å­—ç¬¦ä¸²ï¼š <code>'/'</code>  åè·Ÿä¸€ä¸ªæˆ–è€…å¤šä¸ªå°å†™è‹±æ–‡å­—æ¯ã€‚</p>\n<pre><code>ä¾‹å¦‚ï¼Œ`&quot;/leetcode&quot;` å’Œ `&quot;/leetcode/problems&quot;` éƒ½æ˜¯æœ‰æ•ˆçš„è·¯å¾„ï¼Œè€Œç©ºå­—ç¬¦ä¸²å’Œ `&quot;/&quot;` ä¸æ˜¯ã€‚\n</code></pre>\n<div class=\"note info no-icon\">\n<ul>\n<li>1 &lt;=  <code>folder.length</code>  &lt;= 4 * 104</li>\n<li>2 &lt;=  <code>folder[i].length</code>  &lt;= 100</li>\n<li><code>folder[i]</code>  åªåŒ…å«å°å†™å­—æ¯å’Œ '/'</li>\n<li><code>folder[i]</code>  æ€»æ˜¯ä»¥å­—ç¬¦ '/' èµ·å§‹</li>\n<li><code>folder</code>  æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ å”¯ä¸€ çš„</li>\n</ul>\n</div>\n<hr />\n<h2 id=\"è§£é¢˜æ€è·¯\"><a class=\"anchor\" href=\"#è§£é¢˜æ€è·¯\">#</a> ğŸ§  è§£é¢˜æ€è·¯</h2>\n<p>æ€è·¯ä¸€ï¼šæ’åº + å“ˆå¸Œè¡¨</p>\n<ol>\n<li>é¦–å…ˆå¯¹æ–‡ä»¶å¤¹è·¯å¾„è¿›è¡Œæ’åºï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿å­æ–‡ä»¶å¤¹åœ¨çˆ¶æ–‡ä»¶å¤¹ä¹‹å‰ã€‚</li>\n<li>ä½¿ç”¨å“ˆå¸Œè¡¨è®°å½•æ‰€æœ‰æ–‡ä»¶å¤¹è·¯å¾„ã€‚</li>\n<li>éå†æ–‡ä»¶å¤¹è·¯å¾„ï¼Œå¦‚æœå½“å‰è·¯å¾„æ˜¯æŸä¸ªå·²å­˜åœ¨è·¯å¾„çš„å‰ç¼€ï¼Œåˆ™è¯´æ˜æ˜¯å­æ–‡ä»¶å¤¹ï¼Œè·³è¿‡ã€‚</li>\n<li>å¦åˆ™ï¼Œå°†å½“å‰è·¯å¾„åŠ å…¥ç»“æœé›†ã€‚</li>\n</ol>\n<p>æ€è·¯äºŒï¼šæ’åº</p>\n<ol>\n<li>å¯¹æ–‡ä»¶å¤¹è·¯å¾„è¿›è¡Œæ’åºã€‚</li>\n<li>éå†æ’åºåçš„æ–‡ä»¶å¤¹è·¯å¾„ï¼Œæ£€æŸ¥å½“å‰è·¯å¾„æ˜¯å¦æ˜¯ä¸Šä¸€ä¸ªè·¯å¾„çš„å­æ–‡ä»¶å¤¹ã€‚</li>\n<li>å¦‚æœæ˜¯ï¼Œåˆ™è·³è¿‡ï¼›å¦‚æœä¸æ˜¯ï¼Œåˆ™å°†å…¶åŠ å…¥ç»“æœé›†ã€‚</li>\n</ol>\n<div class=\"note warning\">\n<p>è¯¥æ€è·¯é€šè¿‡æŸ¥çœ‹ç”¨æ—¶æ›´å°‘çš„ä»£ç å¾—åˆ°çš„ã€‚<br />\nç”±äºç›´æ¥æ’åºå°±æ˜¯å­—å…¸åºï¼Œæ‰€ä»¥å¦‚æœå½“å‰è·¯å¾„æ˜¯ä¸Šä¸€ä¸ªè·¯å¾„çš„å­æ–‡ä»¶å¤¹ï¼Œåˆ™ä¸€å®šæ˜¯ç›¸é‚»çš„ã€‚å¦‚æœä¸Šä»¥ä¸€ä¸ªæ–‡ä»¶å¤¹æ˜¯å­æ–‡ä»¶å¤¹ï¼Œä¸”å½“å‰æ–‡ä»¶å¤¹æ˜¯ä¸Šä¸€ä¸ªæ–‡ä»¶å¤¹çš„å­æ–‡ä»¶å¤¹ï¼Œåˆ™å½“å‰æ–‡ä»¶å¤¹ä¸€å®šæ˜¯ä¸Šä¸€ä¸ªæ–‡ä»¶å¤¹çš„çˆ¶æ–‡ä»¶å¤¹çš„å­æ–‡ä»¶å¤¹ã€‚æ‰€ä»¥ä¸ç”¨æ‹…å¿ƒä¼šæ¼æ‰å…¶ä»–çš„å­æ–‡ä»¶å¤¹ï¼Œåªè¦æœ€å¼€å§‹çš„çˆ¶æ–‡ä»¶å¤¹ä¸è¢«åˆ é™¤å³å¯ã€‚</p>\n</div>\n<hr />\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ğŸ’¡ ä»£ç å®ç°</h2>\n<figure class=\"highlight cpp\"><figcaption><span>C++ è§£æ³•1</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\">vector&lt;string&gt; <span class=\"title\">removeSubfolders</span><span class=\"params\">(vector&lt;string&gt;&amp; folder)</span> </span>&#123;</span><br><span class=\"line\">        ranges::<span class=\"built_in\">sort</span>(folder);</span><br><span class=\"line\">        unordered_map&lt;string,<span class=\"type\">bool</span>&gt; mp;</span><br><span class=\"line\">        vector&lt;string&gt; ans;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> f:folder)&#123;</span><br><span class=\"line\">            mp[f] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> s = f;</span><br><span class=\"line\">            <span class=\"type\">bool</span> is = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (f.<span class=\"built_in\">rfind</span>(<span class=\"string\">&#x27;/&#x27;</span>) != <span class=\"number\">0</span> &amp;&amp; !is)&#123;</span><br><span class=\"line\">                f = f.<span class=\"built_in\">substr</span>(<span class=\"number\">0</span>,f.<span class=\"built_in\">rfind</span>(<span class=\"string\">&#x27;/&#x27;</span>));</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (mp[f]) is = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!is) ans.<span class=\"built_in\">push_back</span>(s);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight c++\"><figcaption><span>C++ è§£æ³•2</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\">vector&lt;string&gt; <span class=\"title\">removeSubfolders</span><span class=\"params\">(vector&lt;string&gt;&amp; folder)</span> </span>&#123;</span><br><span class=\"line\">        ranges::<span class=\"built_in\">sort</span>(folder);</span><br><span class=\"line\">        vector&lt;string&gt; ans;</span><br><span class=\"line\">        ans.<span class=\"built_in\">push_back</span>(folder[<span class=\"number\">0</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; folder.<span class=\"built_in\">size</span>(); i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!folder[i].<span class=\"built_in\">starts_with</span>(ans.<span class=\"built_in\">back</span>()) || folder[i][ans.<span class=\"built_in\">back</span>().<span class=\"built_in\">size</span>()] != <span class=\"string\">&#x27;/&#x27;</span>) ans.<span class=\"built_in\">push_back</span>(folder[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "ç®—æ³•é¢˜è§£",
                "åŠ›æ‰£",
                "æ¯æ—¥ä¸€é¢˜",
                "ç®—æ³•",
                "LeetCode",
                "C++",
                "å­—ç¬¦ä¸²",
                "æ’åº"
            ]
        },
        {
            "id": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/PyTorch%E7%9A%84%E5%88%9D%E6%AD%A5%E4%BD%BF%E7%94%A8%EF%BC%9A%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B%E7%AE%80%E5%8D%95%E6%9E%84%E5%BB%BA/",
            "url": "https://stinncsky.github.io/study-notes/machine-learning/code-implementation/PyTorch%E7%9A%84%E5%88%9D%E6%AD%A5%E4%BD%BF%E7%94%A8%EF%BC%9A%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B%E7%AE%80%E5%8D%95%E6%9E%84%E5%BB%BA/",
            "title": "PyTorchçš„åˆæ­¥ä½¿ç”¨ï¼šçº¿æ€§æ¨¡å‹ç®€å•æ„å»º",
            "date_published": "2025-07-18T08:18:11.000Z",
            "content_html": "<div class=\"note info no-icon\">\n<p>æœ¬æ–‡<strong>ä»£ç æ¥æºï¼š</strong> <span class=\"exturl\" data-url=\"aHR0cHM6Ly90YW5nc2h1c2VuLm1lL0RpdmUtaW50by1ETC1QeVRvcmNoLw==\">ã€ŠåŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ã€‹(PyTorch ç‰ˆ)</span></p>\n</div>\n<h1 id=\"æ•°æ®æ‰¹å¤„ç†ä¸å°æ‰¹é‡æ¢¯åº¦ä¸‹é™\"><a class=\"anchor\" href=\"#æ•°æ®æ‰¹å¤„ç†ä¸å°æ‰¹é‡æ¢¯åº¦ä¸‹é™\">#</a> æ•°æ®æ‰¹å¤„ç†ä¸å°æ‰¹é‡æ¢¯åº¦ä¸‹é™</h1>\n<p>åœ¨æ·±åº¦å­¦ä¹ è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™æ˜¯ä¸»æµçš„ä¼˜åŒ–æ–¹æ³•ã€‚PyTorch æä¾›äº†ä¾¿æ·çš„æ•°æ®åŠ è½½å·¥å…·æ¥å®ç°æ‰¹å¤„ç†ã€‚</p>\n<details class=\"info\"><summary>å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™åŸç†</summary><div>\n<p>å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆmini-batch stochastic gradient descentï¼‰æ˜¯æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å˜ç§ï¼Œå®ƒåœ¨æ¯æ¬¡è¿­ä»£ä¸­ä½¿ç”¨ä¸€ä¸ªå°æ‰¹é‡ï¼ˆmini-batchï¼‰çš„æ ·æœ¬æ¥è®¡ç®—æ¢¯åº¦ã€‚</p>\n<p><strong>ç®—æ³•æµç¨‹ï¼š</strong></p>\n<ol>\n<li>å°†è®­ç»ƒæ•°æ®é›†åˆ†æˆè‹¥å¹²ä¸ªå¤§å°ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> çš„å°æ‰¹é‡</li>\n<li>å¯¹äºæ¯ä¸ªå°æ‰¹é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msup><mi>x</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo separator=\"true\">,</mo><msup><mi>y</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup><msubsup><mo stretchy=\"false\">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\{x^{(i)}, y^{(i)}\\}_{i=1}^m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.146664em;vertical-align:-0.258664em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">}</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-2.441336em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.258664em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œè®¡ç®—æ¢¯åº¦ï¼š<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"normal\">âˆ‡</mi><mi>Î¸</mi></msub><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Î¸</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi mathvariant=\"normal\">âˆ‡</mi><mi>Î¸</mi></msub><mi>L</mi><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>Î¸</mi></msub><mo stretchy=\"false\">(</mo><msup><mi>x</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msup><mi>y</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\nabla_\\theta J(\\theta) = \\frac{1}{m} \\sum_{i=1}^m \\nabla_\\theta L(f_\\theta(x^{(i)}), y^{(i)})\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\">âˆ‡</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">Î¸</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Î¸</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.929066em;vertical-align:-1.277669em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\">âˆ‡</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">Î¸</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">Î¸</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n</li>\n<li>æ›´æ–°å‚æ•°ï¼š<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>Î¸</mi><mo>â†</mo><mi>Î¸</mi><mo>âˆ’</mo><mi>Î·</mi><msub><mi mathvariant=\"normal\">âˆ‡</mi><mi>Î¸</mi></msub><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Î¸</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\theta \\leftarrow \\theta - \\eta \\nabla_\\theta J(\\theta)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Î¸</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">â†</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Î¸</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Î·</span><span class=\"mord\"><span class=\"mord\">âˆ‡</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">Î¸</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Î¸</span><span class=\"mclose\">)</span></span></span></span></span></p>\n</li>\n</ol>\n<p>å…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î·</mi></mrow><annotation encoding=\"application/x-tex\">\\eta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Î·</span></span></span></span> æ˜¯å­¦ä¹ ç‡ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> æ˜¯æŸå¤±å‡½æ•°ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>Î¸</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">Î¸</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> æ˜¯æ¨¡å‹ã€‚</p>\n<p><strong>ä¼˜åŠ¿ï¼š</strong></p>\n<ul>\n<li>ç›¸æ¯”å…¨æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼Œè®¡ç®—æ•ˆç‡æ›´é«˜</li>\n<li>ç›¸æ¯”å•æ ·æœ¬éšæœºæ¢¯åº¦ä¸‹é™ï¼Œæ¢¯åº¦ä¼°è®¡æ›´ç¨³å®š</li>\n<li>èƒ½å¤Ÿåˆ©ç”¨ç°ä»£ GPU çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›</li>\n</ul>\n</div></details>\n<figure class=\"highlight python\"><figcaption><span>æ•°æ®åŠ è½½å™¨å®ç°</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly90YW5nc2h1c2VuLm1lL0RpdmUtaW50by1ETC1QeVRvcmNoLw==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> torch.utils.data <span class=\"keyword\">as</span> Data</span><br><span class=\"line\"></span><br><span class=\"line\">batch_size = <span class=\"number\">10</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å°†è®­ç»ƒæ•°æ®çš„ç‰¹å¾å’Œæ ‡ç­¾ç»„åˆ</span></span><br><span class=\"line\">dataset = Data.TensorDataset(features, labels)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># éšæœºè¯»å–å°æ‰¹é‡</span></span><br><span class=\"line\">data_iter = Data.DataLoader(dataset, batch_size, shuffle=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n<div class=\"note info no-icon\">\n<p>ä½¿ç”¨ <code>DataLoader</code>  å¯ä»¥è‡ªåŠ¨å¤„ç†æ•°æ®çš„éšæœºæ‰“ä¹±å’Œæ‰¹å¤„ç†ï¼Œå¤§å¤§ç®€åŒ–äº†è®­ç»ƒæµç¨‹ã€‚</p>\n</div>\n<h1 id=\"ç¥ç»ç½‘ç»œæ¨¡å‹å®šä¹‰\"><a class=\"anchor\" href=\"#ç¥ç»ç½‘ç»œæ¨¡å‹å®šä¹‰\">#</a> ç¥ç»ç½‘ç»œæ¨¡å‹å®šä¹‰</h1>\n<p>PyTorch æä¾›äº†ä¸¤ç§ä¸»è¦æ–¹å¼æ¥æ„å»ºç¥ç»ç½‘ç»œï¼šç»§æ‰¿ <code>nn.Module</code>  ç±»å’Œä½¿ç”¨ <code>nn.Sequential</code>  å®¹å™¨ã€‚</p>\n<h2 id=\"æ–¹å¼ä¸€ç»§æ‰¿nnmoduleç±»\"><a class=\"anchor\" href=\"#æ–¹å¼ä¸€ç»§æ‰¿nnmoduleç±»\">#</a> æ–¹å¼ä¸€ï¼šç»§æ‰¿ nn.Module ç±»</h2>\n<p>é€šè¿‡ç»§æ‰¿ <code>nn.Module</code>  ç±»ï¼Œå¯ä»¥çµæ´»å®šä¹‰ç½‘ç»œç»“æ„å’Œå‰å‘ä¼ æ’­è¿‡ç¨‹ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>çº¿æ€§ç½‘ç»œç±»å®šä¹‰</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly90YW5nc2h1c2VuLm1lL0RpdmUtaW50by1ETC1QeVRvcmNoLw==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> torch.nn <span class=\"keyword\">as</span> nn</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">LinearNet</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, n_feature</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(LinearNet, <span class=\"variable language_\">self</span>).__init__()</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.linear = nn.Linear(n_feature, <span class=\"number\">1</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># forward å®šä¹‰å‰å‘ä¼ æ’­</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">        y = <span class=\"variable language_\">self</span>.linear(x)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> y</span><br><span class=\"line\"></span><br><span class=\"line\">net = LinearNet(num_inputs)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(net) <span class=\"comment\"># ä½¿ç”¨printå¯ä»¥æ‰“å°å‡ºç½‘ç»œçš„ç»“æ„</span></span><br></pre></td></tr></table></figure>\n<div class=\"note warning no-icon\">\n<p><code>torch.nn</code>  ä»…æ”¯æŒè¾“å…¥ä¸€ä¸ª batch çš„æ ·æœ¬ï¼Œä¸æ”¯æŒå•ä¸ªæ ·æœ¬è¾“å…¥ã€‚å¦‚æœåªæœ‰å•ä¸ªæ ·æœ¬ï¼Œå¯ä½¿ç”¨ <code>input.unsqueeze(0)</code>  æ¥æ·»åŠ ä¸€ç»´ã€‚</p>\n</div>\n<h2 id=\"æ–¹å¼äºŒä½¿ç”¨nnsequential\"><a class=\"anchor\" href=\"#æ–¹å¼äºŒä½¿ç”¨nnsequential\">#</a> æ–¹å¼äºŒï¼šä½¿ç”¨ nn.Sequential</h2>\n<p><code>nn.Sequential</code>  æä¾›äº†ä¸€ç§æ›´ç®€æ´çš„æ–¹å¼æ¥æ„å»ºé¡ºåºç½‘ç»œã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>Sequentialç½‘ç»œæ„å»ºçš„ä¸‰ç§å†™æ³•</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly90YW5nc2h1c2VuLm1lL0RpdmUtaW50by1ETC1QeVRvcmNoLw==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å†™æ³•ä¸€</span></span><br><span class=\"line\">net = nn.Sequential(</span><br><span class=\"line\">    nn.Linear(num_inputs, <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"comment\"># æ­¤å¤„è¿˜å¯ä»¥ä¼ å…¥å…¶ä»–å±‚</span></span><br><span class=\"line\">    )</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å†™æ³•äºŒ</span></span><br><span class=\"line\">net = nn.Sequential()</span><br><span class=\"line\">net.add_module(<span class=\"string\">&#x27;linear&#x27;</span>, nn.Linear(num_inputs, <span class=\"number\">1</span>))</span><br><span class=\"line\"><span class=\"comment\"># net.add_module ......</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å†™æ³•ä¸‰</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> collections <span class=\"keyword\">import</span> OrderedDict</span><br><span class=\"line\">net = nn.Sequential(OrderedDict([</span><br><span class=\"line\">          (<span class=\"string\">&#x27;linear&#x27;</span>, nn.Linear(num_inputs, <span class=\"number\">1</span>))</span><br><span class=\"line\">          <span class=\"comment\"># ......</span></span><br><span class=\"line\">        ]))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(net)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(net[<span class=\"number\">0</span>])</span><br></pre></td></tr></table></figure>\n<h1 id=\"å‚æ•°åˆå§‹åŒ–\"><a class=\"anchor\" href=\"#å‚æ•°åˆå§‹åŒ–\">#</a> å‚æ•°åˆå§‹åŒ–</h1>\n<p>ç¥ç»ç½‘ç»œçš„å‚æ•°åˆå§‹åŒ–å¯¹è®­ç»ƒæ•ˆæœæœ‰é‡è¦å½±å“ã€‚PyTorch æä¾›äº†å¤šç§åˆå§‹åŒ–æ–¹æ³•ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>å‚æ•°åˆå§‹åŒ–æ–¹æ³•</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly90YW5nc2h1c2VuLm1lL0RpdmUtaW50by1ETC1QeVRvcmNoLw==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> torch.nn <span class=\"keyword\">import</span> init</span><br><span class=\"line\"></span><br><span class=\"line\">init.normal_(net[<span class=\"number\">0</span>].weight, mean=<span class=\"number\">0</span>, std=<span class=\"number\">0.01</span>)</span><br><span class=\"line\">init.constant_(net[<span class=\"number\">0</span>].bias, val=<span class=\"number\">0</span>)  <span class=\"comment\"># ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹biasçš„data: net[0].bias.data.fill_(0)</span></span><br></pre></td></tr></table></figure>\n<details class=\"info\"><summary>å¸¸ç”¨åˆå§‹åŒ–æ–¹æ³•</summary><div>\n<p>PyTorch çš„ <code>torch.nn.init</code>  æ¨¡å—æä¾›äº†å¤šç§å‚æ•°åˆå§‹åŒ–æ–¹æ³•ï¼š</p>\n<ul>\n<li><code>normal_()</code> : æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–</li>\n<li><code>uniform_()</code> : å‡åŒ€åˆ†å¸ƒåˆå§‹åŒ–</li>\n<li><code>constant_()</code> : å¸¸æ•°åˆå§‹åŒ–</li>\n<li><code>xavier_uniform_()</code> : Xavier å‡åŒ€åˆ†å¸ƒåˆå§‹åŒ–</li>\n<li><code>kaiming_normal_()</code> : Kaiming æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–</li>\n</ul>\n<p>é€‰æ‹©åˆé€‚çš„åˆå§‹åŒ–æ–¹æ³•å¯ä»¥é¿å…æ¢¯åº¦æ¶ˆå¤±æˆ–æ¢¯åº¦çˆ†ç‚¸é—®é¢˜ï¼ŒåŠ é€Ÿç½‘ç»œæ”¶æ•›ã€‚</p>\n</div></details>\n<h1 id=\"æŸå¤±å‡½æ•°å®šä¹‰\"><a class=\"anchor\" href=\"#æŸå¤±å‡½æ•°å®šä¹‰\">#</a> æŸå¤±å‡½æ•°å®šä¹‰</h1>\n<p>æŸå¤±å‡½æ•°ç”¨äºè¡¡é‡æ¨¡å‹é¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„å·®å¼‚ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly90YW5nc2h1c2VuLm1lL0RpdmUtaW50by1ETC1QeVRvcmNoLw==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">loss = nn.MSELoss()</span><br></pre></td></tr></table></figure>\n<h1 id=\"ä¼˜åŒ–å™¨é…ç½®\"><a class=\"anchor\" href=\"#ä¼˜åŒ–å™¨é…ç½®\">#</a> ä¼˜åŒ–å™¨é…ç½®</h1>\n<p>ä¼˜åŒ–å™¨è´Ÿè´£æ ¹æ®æ¢¯åº¦æ›´æ–°æ¨¡å‹å‚æ•°ã€‚PyTorch æä¾›äº†å¤šç§ä¼˜åŒ–ç®—æ³•ã€‚</p>\n<h2 id=\"åŸºæœ¬ä¼˜åŒ–å™¨è®¾ç½®\"><a class=\"anchor\" href=\"#åŸºæœ¬ä¼˜åŒ–å™¨è®¾ç½®\">#</a> åŸºæœ¬ä¼˜åŒ–å™¨è®¾ç½®</h2>\n<figure class=\"highlight python\"><figcaption><span>SGDä¼˜åŒ–å™¨é…ç½®</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly90YW5nc2h1c2VuLm1lL0RpdmUtaW50by1ETC1QeVRvcmNoLw==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> torch.optim <span class=\"keyword\">as</span> optim</span><br><span class=\"line\"></span><br><span class=\"line\">optimizer = optim.SGD(net.parameters(), lr=<span class=\"number\">0.03</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(optimizer)</span><br></pre></td></tr></table></figure>\n<h2 id=\"ä¸åŒå‚æ•°ç»„çš„å­¦ä¹ ç‡è®¾ç½®\"><a class=\"anchor\" href=\"#ä¸åŒå‚æ•°ç»„çš„å­¦ä¹ ç‡è®¾ç½®\">#</a> ä¸åŒå‚æ•°ç»„çš„å­¦ä¹ ç‡è®¾ç½®</h2>\n<figure class=\"highlight python\"><figcaption><span>åˆ†ç»„å­¦ä¹ ç‡è®¾ç½®</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly90YW5nc2h1c2VuLm1lL0RpdmUtaW50by1ETC1QeVRvcmNoLw==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">optimizer = optim.SGD([</span><br><span class=\"line\">        <span class=\"comment\"># å¦‚æœå¯¹æŸä¸ªå‚æ•°ä¸æŒ‡å®šå­¦ä¹ ç‡ï¼Œå°±ä½¿ç”¨æœ€å¤–å±‚çš„é»˜è®¤å­¦ä¹ ç‡</span></span><br><span class=\"line\">        &#123;<span class=\"string\">&#x27;params&#x27;</span>: net.subnet1.parameters()&#125;, <span class=\"comment\"># lr=0.03</span></span><br><span class=\"line\">        &#123;<span class=\"string\">&#x27;params&#x27;</span>: net.subnet2.parameters(), <span class=\"string\">&#x27;lr&#x27;</span>: <span class=\"number\">0.01</span>&#125;</span><br><span class=\"line\">      ], lr=<span class=\"number\">0.03</span>)</span><br></pre></td></tr></table></figure>\n<h2 id=\"åŠ¨æ€è°ƒæ•´å­¦ä¹ ç‡\"><a class=\"anchor\" href=\"#åŠ¨æ€è°ƒæ•´å­¦ä¹ ç‡\">#</a> åŠ¨æ€è°ƒæ•´å­¦ä¹ ç‡</h2>\n<figure class=\"highlight python\"><figcaption><span>å­¦ä¹ ç‡è°ƒæ•´</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly90YW5nc2h1c2VuLm1lL0RpdmUtaW50by1ETC1QeVRvcmNoLw==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># è°ƒæ•´å­¦ä¹ ç‡</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> param_group <span class=\"keyword\">in</span> optimizer.param_groups:</span><br><span class=\"line\">    param_group[<span class=\"string\">&#x27;lr&#x27;</span>] *= <span class=\"number\">0.1</span> <span class=\"comment\"># å­¦ä¹ ç‡ä¸ºä¹‹å‰çš„0.1å€</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"æ¨¡å‹è®­ç»ƒæµç¨‹\"><a class=\"anchor\" href=\"#æ¨¡å‹è®­ç»ƒæµç¨‹\">#</a> æ¨¡å‹è®­ç»ƒæµç¨‹</h1>\n<p>å®Œæ•´çš„è®­ç»ƒæµç¨‹åŒ…æ‹¬å‰å‘ä¼ æ’­ã€æŸå¤±è®¡ç®—ã€åå‘ä¼ æ’­å’Œå‚æ•°æ›´æ–°å››ä¸ªæ­¥éª¤ã€‚</p>\n<figure class=\"highlight python\"><figcaption><span>å®Œæ•´è®­ç»ƒå¾ªç¯</span><span class=\"exturl\" data-url=\"aHR0cHM6Ly90YW5nc2h1c2VuLm1lL0RpdmUtaW50by1ETC1QeVRvcmNoLw==\">å‚è€ƒé“¾æ¥</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">num_epochs = <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> epoch <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, num_epochs + <span class=\"number\">1</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> X, y <span class=\"keyword\">in</span> data_iter:</span><br><span class=\"line\">        output = net(X)</span><br><span class=\"line\">        l = loss(output, y.view(-<span class=\"number\">1</span>, <span class=\"number\">1</span>))</span><br><span class=\"line\">        optimizer.zero_grad() <span class=\"comment\"># æ¢¯åº¦æ¸…é›¶ï¼Œç­‰ä»·äºnet.zero_grad()</span></span><br><span class=\"line\">        l.backward()</span><br><span class=\"line\">        optimizer.step()</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;epoch %d, loss: %f&#x27;</span> % (epoch, l.item()))</span><br></pre></td></tr></table></figure>\n<h1 id=\"å…³é”®æ³¨æ„äº‹é¡¹\"><a class=\"anchor\" href=\"#å…³é”®æ³¨æ„äº‹é¡¹\">#</a> å…³é”®æ³¨æ„äº‹é¡¹</h1>\n<h2 id=\"è®¡ç®—å›¾ç®¡ç†\"><a class=\"anchor\" href=\"#è®¡ç®—å›¾ç®¡ç†\">#</a> è®¡ç®—å›¾ç®¡ç†</h2>\n<div class=\"note danger no-icon\">\n<p>å¯¹èµ‹å€¼æ“ä½œï¼Œè¦ä¹ˆä½¿ç”¨ <code>.data</code>  è¦ä¹ˆç”¨ <code>with torch.no_grad():</code> ï¼Œå¦åˆ™ä¼šè¢«åŠ å…¥è®¡ç®—å›¾ä¸­ï¼Œå½±å“å†…å­˜ä½¿ç”¨å’Œè®¡ç®—æ•ˆç‡ã€‚</p>\n</div>\n<details class=\"info\"><summary>è®¡ç®—å›¾çš„å½±å“</summary><div>\n<p>PyTorch é‡‡ç”¨åŠ¨æ€è®¡ç®—å›¾æœºåˆ¶ï¼Œæ‰€æœ‰å‚ä¸æ¢¯åº¦è®¡ç®—çš„å¼ é‡æ“ä½œéƒ½ä¼šè¢«è®°å½•åœ¨è®¡ç®—å›¾ä¸­ã€‚å¦‚æœç›´æ¥å¯¹å‚æ•°è¿›è¡Œèµ‹å€¼æ“ä½œè€Œä¸ä½¿ç”¨ <code>.data</code>  æˆ– <code>torch.no_grad()</code> ï¼Œè¿™äº›æ“ä½œä¹Ÿä¼šè¢«è®°å½•ï¼Œå¯¼è‡´ï¼š</p>\n<ol>\n<li>ä¸å¿…è¦çš„å†…å­˜æ¶ˆè€—</li>\n<li>è®¡ç®—å›¾å˜å¾—å¤æ‚</li>\n<li>å¯èƒ½å½±å“æ¢¯åº¦è®¡ç®—çš„æ­£ç¡®æ€§</li>\n</ol>\n<p><strong>æ­£ç¡®åšæ³•ï¼š</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ–¹æ³•ä¸€ï¼šä½¿ç”¨.data</span></span><br><span class=\"line\">param.data = new_value</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ–¹æ³•äºŒï¼šä½¿ç”¨torch.no_grad()</span></span><br><span class=\"line\"><span class=\"keyword\">with</span> torch.no_grad():</span><br><span class=\"line\">    param.copy_(new_value)</span><br></pre></td></tr></table></figure>\n</div></details>\n<h2 id=\"æ¢¯åº¦ç´¯ç§¯é—®é¢˜\"><a class=\"anchor\" href=\"#æ¢¯åº¦ç´¯ç§¯é—®é¢˜\">#</a> æ¢¯åº¦ç´¯ç§¯é—®é¢˜</h2>\n<div class=\"note warning no-icon\">\n<p>æ¯æ¬¡å®Œæ•´ä¿®æ”¹ä¸€æ¬¡å‚æ•°ï¼Œè®°å¾—è¦æ¢¯åº¦æ¸…é›¶ <code>w.grad.data.zero_()</code> ï¼Œå¦åˆ™æ¢¯åº¦ä¼šç´¯ç§¯ã€‚</p>\n</div>\n<details class=\"info\"><summary>æ¢¯åº¦ç´¯ç§¯çš„åŸå› ä¸è§£å†³</summary><div>\n<p>åœ¨ PyTorch ä¸­ï¼Œè°ƒç”¨ <code>loss.backward()</code>  æ—¶ï¼Œæ¢¯åº¦ä¼šç´¯åŠ åˆ°å‚æ•°çš„ <code>.grad</code>  å±æ€§ä¸­ï¼Œè€Œä¸æ˜¯æ›¿æ¢ã€‚è¿™ç§è®¾è®¡æ˜¯ä¸ºäº†æ”¯æŒæ¢¯åº¦ç´¯ç§¯ç­‰é«˜çº§ç”¨æ³•ã€‚</p>\n<p><strong>é—®é¢˜ï¼š</strong> å¦‚æœä¸æ¸…é›¶æ¢¯åº¦ï¼Œå¤šæ¬¡è¿­ä»£çš„æ¢¯åº¦ä¼šç´¯ç§¯ï¼Œå¯¼è‡´å‚æ•°æ›´æ–°æ–¹å‘é”™è¯¯ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ–¹æ³•ä¸€ï¼šä½¿ç”¨ä¼˜åŒ–å™¨æ¸…é›¶ï¼ˆæ¨èï¼‰</span></span><br><span class=\"line\">optimizer.zero_grad()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ¸…é›¶</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> param <span class=\"keyword\">in</span> net.parameters():</span><br><span class=\"line\">    <span class=\"keyword\">if</span> param.grad <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">        param.grad.data.zero_()</span><br></pre></td></tr></table></figure>\n</div></details>\n<hr />\n",
            "tags": [
                "å­¦ä¹ ç¬”è®°",
                "æœºå™¨å­¦ä¹ ",
                "ä»£ç å®ç°",
                "åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ",
                "PyTorch",
                "ç¥ç»ç½‘ç»œ",
                "æ¢¯åº¦ä¸‹é™",
                "æŸå¤±å‡½æ•°",
                "ä¼˜åŒ–å™¨",
                "æ•°æ®åŠ è½½å™¨",
                "å‚æ•°åˆå§‹åŒ–",
                "SGD",
                "æ·±åº¦å­¦ä¹ "
            ]
        }
    ]
}